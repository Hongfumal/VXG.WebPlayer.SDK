// CloudSDK.min.js
// version: 3.0.18
// date-of-build: 200702
// copyright (c) VXG Inc

window.Log=function(e){var t=this;t.mElementID=e,t.el=document.getElementById(e),t.el&&(t.el.innerHTML='<div class="logger-line">Start</div>'),t.escape=function(e){if(void 0===e)return"undefined";"object"==typeof e&&(e=JSON.stringify(e));var t=e,o=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/"/g,"&quot;"]];for(var r in o)t=t.replace(o[r][0],o[r][1]);return t},t.info=function(e){console.log(e),t.el&&(t.el.innerHTML+='<div class="logger-line info">'+t.escape(e)+"</div>")},t.error=function(e){console.error(e),t.el&&(t.el.innerHTML+='<div class="logger-line error">'+t.escape(e)+"</div>")},t.warn=function(e){console.warn(e),t.el&&(t.el.innerHTML+='<div class="logger-line warn">'+t.escape(e)+"</div>")}},window.CloudHelpers=window.CloudHelpers||{},window.CloudHelpers.RequestWrap=function(){this.request=function(e){var o=CloudHelpers.promise(),r="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return r.open(e.type,e.url,!0),r.withCredentials=!0,e.contentType&&r.setRequestHeader("Content-Type",e.contentType),e.token&&r.setRequestHeader("Authorization","SkyVR "+e.token),r.onload=function(){var e="";if(""!=this.responseText)try{e=JSON.parse(this.responseText)}catch(e){return console.error(e),void o.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var t=this.status;200<=t&&t<300?o.resolve(e):o.reject(e),delete r},r.onerror=function(){o.reject(r),delete r},e.data?r.send(e.data):r.send(),o},this.destroy=function(){this.isRequestAnswerAlowed=0}},CloudHelpers.parseUri=function(e){var t={},o=(t.source=e).split("/");t.protocol=o[0],t.protocol=t.protocol.slice(0,t.protocol.length-1),t.protocol=t.protocol.toLowerCase(),e=e.slice(t.protocol.length+3),"http"==t.protocol&&(t.port=80),"https"==t.protocol&&(t.port=443);var r=e.indexOf("/");r=-1!=r?r:e.length;var n=e.indexOf("?");n=-1!=n?n:e.length;var a=Math.min(r,n),i=e.substring(0,a);e=e.slice(a);for(var s="";-1!=i.indexOf("@");)s+=i.substring(0,i.indexOf("@")+1),i=i.slice(i.indexOf("@")+1);if(""!=s)if(-1!=s.indexOf(":")){var l=s.split(":");t.user=l[0],t.password=l[1],t.password=t.password.substring(0,t.password.length-1)}else t.user=s;if(-1!=i.indexOf(":")){var c=new RegExp(".*:(\\d+)$","g").exec(i);c&&1<c.length&&(t.port=parseInt(c[1],10),i=i.slice(0,i.length-c[1].length-1))}return t.host=i,-1!=e.indexOf("?")?(t.query=e.substring(e.indexOf("?"),e.length),t.path=e.substring(0,e.indexOf("?"))):(t.query="",t.path=e),t.path&&""!=t.path||(t.path="/"),t},CloudHelpers.promise=function(){var t={completed:!1,failed:!1,successed:!1,done:function(e){return t.done_callback=e,t.completed&&"function"==typeof t.done_callback&&t.successed&&t.done_callback.apply(this,t.result_arguments),t},fail:function(e){return t.fail_callback=e,t.completed&&"function"==typeof t.fail_callback&&t.failed&&t.fail_callback.apply(this,t.error_arguments),t},resolve:function(){t.completed||(t.result_arguments=arguments,"function"==typeof t.done_callback&&t.done_callback.apply(this,t.result_arguments)),t.successed=!0,t.completed=!0},reject:function(){t.completed||(t.error_arguments=arguments,"function"==typeof t.fail_callback&&t.fail_callback.apply(this,t.error_arguments)),t.failed=!0,t.completed=!0}};return t},CloudHelpers.waitPromises=function(e){var t=CloudHelpers.promise(),o=e.length,r=[];function n(e){r.push(e),r.length==o&&t.resolve(r)}for(var a in e)e[a].done(n).fail(n);return t},CloudHelpers.request=function(e){var o=CloudHelpers.promise(),r="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return r.open(e.type,e.url,!0),r.withCredentials=!0,e.contentType&&r.setRequestHeader("Content-Type",e.contentType),e.token&&r.setRequestHeader("Authorization","SkyVR "+e.token),r.onload=function(){var e="";if(""!=this.responseText)try{e=JSON.parse(this.responseText)}catch(e){return console.error(e),void o.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var t=this.status;200<=t&&t<300?o.resolve(e):o.reject(e),delete r},r.onerror=function(){o.reject(r),delete r},e.data?r.send(e.data):r.send(),o},CloudHelpers.request2=function(e){var o=CloudHelpers.promise(),r="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return r.open(e.type,e.url,!0),r.withCredentials=!0,e.contentType&&r.setRequestHeader("Content-Type",e.contentType),e.token&&r.setRequestHeader("Authorization","SkyVR "+e.token),e.access_token&&r.setRequestHeader("Authorization","Acc "+e.access_token),e.license_key&&r.setRequestHeader("Authorization","Lic "+e.license_key),r.onload=function(){var e="";if(""!=this.responseText)try{e=JSON.parse(this.responseText)}catch(e){return console.error(e),void o.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var t=this.status;200<=t&&t<300?o.resolve(e):o.reject(e),delete r},r.onerror=function(){o.reject(r),delete r},e.data?r.send(e.data):r.send(),o},CloudHelpers.requestJS=function(url,beforeEval){var p=CloudHelpers.promise(),xhr="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return xhr.open("GET",url,!0),xhr.onload=function(){var r="";if(""!=this.responseText)try{r=this.responseText}catch(e){return console.error(e),void p.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var st=this.status;200<=st&&st<300?(beforeEval&&(r=beforeEval(r)),eval(r),p.resolve(r)):p.reject(r),delete xhr},xhr.onerror=function(){p.reject(xhr),delete xhr},xhr.send(),p},CloudHelpers.handleError=function(e,t,o){e.errorDetail&&404==e.status?t.reject(CloudReturnCode.ERROR_NOT_FOUND):e.errorDetail&&401==e.status?t.reject(CloudReturnCode.ERROR_NOT_AUTHORIZED):o?o(e,t):t.reject(e)},CloudHelpers.requestAsyncList=function(r,n,a){var i={meta:{limit:1e3,offset:0,total_count:-1},objects:[]};n.limit=i.meta.limit,n.offset=i.meta.offset,r(n).fail(function(e){a.reject(e)}).done(function(e){if(i.meta.total_count=e.meta.total_count,i.objects=i.objects.concat(e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)a.resolve(i);else{for(var t=[],o=i.meta.limit;o<i.meta.total_count;o+=i.meta.limit)n.offset=o,t.push(r(n));CloudHelpers.waitPromises(t).done(function(e){for(var t=0;t<e.length;t++)i.objects=i.objects.concat(e[t].objects);a.resolve(i)}).fail(function(e){a.reject(e)})}})},CloudHelpers.flashVersion=void 0,CloudHelpers.getFlashVersion=function(){try{try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{e.AllowScriptAccess="always"}catch(e){return"6,0,0"}}catch(e){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){}}return"0,0,0"},CloudHelpers.supportFlash=function(){return CloudHelpers.flashVersion||(CloudHelpers.flashVersion=CloudHelpers.getFlashVersion()),"0,0,0"!=CloudHelpers.flashVersion},CloudHelpers.useHls=function(){return CloudHelpers.isMobile()||!CloudHelpers.supportFlash()||CloudHelpers.containsPageParam("hls")},CloudHelpers.supportWebRTC=function(){return!!(window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection)},CloudHelpers.mapToUrlQuery=function(e){if(!e)return"";var t=[];for(var o in e)t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")},CloudHelpers.lang=function(){return CloudHelpers.sLang||CloudHelpers.locale()},CloudHelpers.locale=function(){if(langs=["en","ko","ru"],CloudHelpers.sLang="en",CloudHelpers.containsPageParam("lang")&&-1<=langs.indexOf(CloudHelpers.pageParams.lang))CloudHelpers.sLang=CloudHelpers.pageParams.lang;else if(navigator){var e="en";e=navigator.language?navigator.language.substring(0,2):e,e=navigator.browserLanguage?navigator.browserLanguage.substring(0,2):e,e=navigator.systemLanguage?navigator.systemLanguage.substring(0,2):e,e=navigator.userLanguage?navigator.userLanguage.substring(0,2):e,-1<=langs.indexOf(e)?CloudHelpers.sLang=e:console.warn("Unsupported lang "+e+", will be used default lang: "+CloudHelpers.sLang),CloudHelpers.sLang=-1<=langs.indexOf(e)?e:CloudHelpers.sLang}else CloudHelpers.sLang="en";return CloudHelpers.sLang},CloudHelpers.parsePageParams=function(){for(var e=window.location.search.slice(1).split("&"),t={},o=new RegExp("(.*)=([^&#]*)"),r=0;r<e.length;r++)""!=e[r].trim()&&(p=o.exec(e[r].trim()),null==p?t[decodeURIComponent(e[r].trim().replace(/\+/g," "))]="":t[decodeURIComponent(p[1].replace(/\+/g," "))]=decodeURIComponent(p[2].replace(/\+/g," ")));return t},CloudHelpers.pageParams=CloudHelpers.parsePageParams(),CloudHelpers.containsPageParam=function(e){return void 0!==CloudHelpers.pageParams[e]},CloudHelpers.keepParams=["lang","url","fcno","vendor","demo","messaging","hls","svcp_host","backwardDeactivateAfter","mobile","experimental_hls","page_id","preview","customswf"],CloudHelpers.changeLocationState=function(e){var t=[];for(var o in CloudHelpers.keepParams){var r=CloudHelpers.keepParams[o];CloudHelpers.containsPageParam(r)&&t.push(r+"="+encodeURIComponent(CloudHelpers.pageParams[r]))}for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));var a=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+window.location.host+window.location.pathname+"?"+t.join("&");try{window.history.pushState?window.history.pushState(e,document.title,a):console.error("window.history.pushState - function not found")}catch(e){console.error("changeLocationState: Could not change location to "+a)}CloudHelpers.pagePwindow.btoa("Hello, world"),arams=CloudHelpers.parsePageParams()},CloudHelpers.osname=function(){var e="unknown";return-1!=navigator.appVersion.indexOf("Win")&&(e="win"),-1!=navigator.appVersion.indexOf("Mac")&&(e="mac"),-1!=navigator.appVersion.indexOf("X11")&&(e="unix"),-1!=navigator.appVersion.indexOf("Linux")&&(e="linux"),e},CloudHelpers.isSafari=function(){var e=-1<window.navigator.userAgent.toLowerCase().indexOf("chrome"),t=-1<window.navigator.userAgent.toLowerCase().indexOf("safari");return!e&&t},CloudHelpers.isEdge=function(){return-1<window.navigator.userAgent.indexOf("Edge")},CloudHelpers.isChrome=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},CloudHelpers.isMobile=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},CloudHelpers.isIpV4=function(e){return null!=e.match(/^([0-9]{1,3}\.){3}[0-9]{1,3}/)},CloudHelpers.parseUTCTime=function(e){var t=(e=(e=(e=e.replace(new RegExp("-","g")," ")).replace(new RegExp("T","g")," ")).replace(new RegExp(":","g")," ")).split(" "),o=new Date;o.setUTCFullYear(parseInt(t[0],10)),o.setUTCMonth(parseInt(t[1],10)-1),o.setUTCDate(parseInt(t[2],10)),o.setUTCHours(parseInt(t[3],10)),o.setUTCMinutes(parseInt(t[4],10)),o.setUTCSeconds(parseInt(t[5],10));var r=o.getTime();return r-=r%1e3},CloudHelpers.formatUTCTime=function(e){var t=new Date;return t.setTime(e),t.getUTCFullYear()+"-"+("00"+(t.getUTCMonth()+1)).slice(-2)+"-"+("00"+t.getUTCDate()).slice(-2)+"T"+("00"+t.getUTCHours()).slice(-2)+":"+("00"+t.getUTCMinutes()).slice(-2)+":"+("00"+t.getUTCSeconds()).slice(-2)},CloudHelpers.ONE_SECOND=1e3,CloudHelpers.ONE_MINUTE=6e4,CloudHelpers.ONE_HOUR=36e5,CloudHelpers.getCurrentTimeUTC=function(){return Date.now()},CloudHelpers.isLocalFile=function(){return"https:"!=window.location.protocol&&"http:"!=window.location.protocol},CloudHelpers.combineURL=function(e,t,o){""==t&&(t=void 0),""==o&&(o=void 0);var r=CloudHelpers.parseUri(e),n=r.protocol+"://";return(t||o)&&(n+=t,o&&(n+=":"+o),n+="@"),n+=r.host+(""!=r.port?":"+r.port:"")+r.path},CloudHelpers.validIpV4=function(e){for(var t=e.split("."),o=0;o<4;o++){var r=parseInt(t[o],10);if(r<0||255<r)return!1}return!0},CloudHelpers.convertIpV4ToInt=function(e){for(var t=e.split("."),o=0,r=1,n=3;0<=n;n--)o+=parseInt(t[n],10)*r,r*=256;return o},CloudHelpers.isValidHostID=function(e){var t=CloudHelpers.parseUri(e);return"localhost"==t.host||(!(CloudHelpers.isIpV4(t.host)&&!CloudHelpers.validIpV4(t.host))||(console.error("Address "+t.host+" - invalid address"),!1))},CloudHelpers.isLocalUrlOrIP=function(e){var t=CloudHelpers.parseUri(e);if("localhost"==t.host)return!0;if(CloudHelpers.isIpV4(t.host)){if(!CloudHelpers.validIpV4(t.host))return console.error("Address "+t.host+" - invalid address"),!0;var o=CloudHelpers.convertIpV4ToInt(t.host),r=[];for(var n in r.push({from:"127.0.0.0",to:"127.255.255.255",comment:"localhost addresses"}),r){var a=CloudHelpers.convertIpV4ToInt(r[n].from),i=CloudHelpers.convertIpV4ToInt(r[n].to),s=r[n].comment;if(a<=o&&o<=i)return console.error(s),!0}}return!1},CloudHelpers.isPublicUrl=function(e){var t=CloudHelpers.parseUri(e);if("localhost"==t.host)return!1;if(CloudHelpers.isIpV4(t.host)){if(!CloudHelpers.validIpV4(t.host))return console.error("Address "+t.host+" - invalid address"),!1;var o=CloudHelpers.convertIpV4ToInt(t.host),r=[];for(var n in r.push({from:"10.0.0.0",to:"10.255.255.255",comment:"single class A network"}),r.push({from:"172.16.0.0",to:"172.31.255.255",comment:"16 contiguous class B network"}),r.push({from:"192.168.0.0",to:"192.168.255.255",comment:"256 contiguous class C network"}),r.push({from:"169.254.0.0",to:"169.254.255.255",comment:"Link-local address also refered to as Automatic Private IP Addressing"}),r.push({from:"127.0.0.0",to:"127.255.255.255",comment:"localhost addresses"}),r){var a=CloudHelpers.convertIpV4ToInt(r[n].from),i=CloudHelpers.convertIpV4ToInt(r[n].to),s=r[n].comment;if(a<=o&&o<=i)return console.error(s),!1}}return!0},CloudHelpers.isFrame=function(){try{return window.self!==window.top}catch(e){return!0}},CloudHelpers.isFireFox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},CloudHelpers.isAndroid=function(){return!!navigator.userAgent.match(/Android/i)},CloudHelpers.isIOS=function(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))},CloudHelpers.isWindowsPhone=function(){return!!navigator.userAgent.match(/Windows Phone/i)},CloudHelpers.isBlackBerry=function(){return!!navigator.userAgent.match(/BlackBerry/i)},CloudHelpers.splitUserInfoFromURL=function(e){var t=CloudHelpers.parseUri(e);return{url:t.protocol+"://"+t.host+(t.port?":"+t.port:"")+t.path,login:t.user,password:t.password}},CloudHelpers.getAbsolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop};if(e.offsetParent){var o=CloudHelpers.getAbsolutePosition(e.offsetParent);t.x+=o.x,t.y+=o.y}return t},CloudHelpers.cache=CloudHelpers.cache||{},CloudHelpers.cache.timezones=CloudHelpers.cache.timezones||{},CloudHelpers.getOffsetTimezone=function(e){if(!moment)return console.warn("Requrired moment.js library"),0;if(null==CloudHelpers.cache.timezones[e]){var t=new Date;if(e&&""!=e){var o=moment(t).tz(e).format("Z"),r=o[0];(r<"0"||"9"<r)&&(o=o.substring(1));var n="-"==r?-1:1,a=o.split(":");o=n*(60*parseInt(a[0],10)+parseInt(a[1],10)),CloudHelpers.cache.timezones[e]=6e4*o}else CloudHelpers.cache.timezones[e]=0}return CloudHelpers.cache.timezones[e]},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},CloudHelpers.autoPlayAllowed=!0,CloudHelpers.checkAutoplay=function(e){e=e||function(){};var t=new CloudHelpers.promise;t.done(function(){console.log("checkAutoplay: done"),e(CloudHelpers.autoPlayAllowed)}),t.fail(function(){console.log("checkAutoplay: waiting"),e(CloudHelpers.autoPlayAllowed)});var o=null,r=document.createElement("div");r.innerHTML="<video muted></video>",(r=r.children[0]).addEventListener("waiting",function(){console.log("checkAutoplay: waiting, ",o),null==o&&(CloudHelpers.autoPlayAllowed=!0,t.resolve(),r.remove())},!1);var n=r.play(),a="";window.Promise&&(a=window.Promise.toString()),-1!==a.indexOf("function Promise()")||-1!==a.indexOf("function ZoneAwarePromise()")?n.catch(function(e){if("NotAllowedError"==e.name)console.error("error.name:","NotAllowedError"),o=!1,CloudHelpers.autoPlayAllowed=o,t.reject();else if(t.reject(),"AbortError"!=e.name)throw console.error("checkAutoplay: happened something else"),e;r.remove()}):(console.error("checkAutoplay could not work in your browser"),t.reject(),e(CloudHelpers.autoPlayAllowed))},"undefined"!=typeof document&&CloudHelpers.checkAutoplay(function(e){console.log("checkautoplay: autoplay2 ",e)}),CloudHelpers.humanFileSize=function(e){if(e<1024)return e+" B";for(var t=-1;++t,1024<=(e/=1024););return e.toFixed(1)+" "+["kB","MB","GB","TB","PB","EB","ZB","YB"][t]},CloudHelpers.base64_encode=function(e){return window.btoa(e)},CloudHelpers.base64_decode=function(e){return window.atob(e)},CloudHelpers.copy=function(e){if(null==e||"object"!=typeof e)return console.error("Expected object"),e;var t=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t},CloudHelpers.unpackAccessToken=function(e){var t={host:"web.skyvr.videoexpertsgroup.com"};try{var o=atob(e);if(o=JSON.parse(o),console.log("Token: ",o),!o.token)return console.error('Invalid access token format (missing "token")'),null;if(!o.access)return console.error('Invalid access token format (missing "access")'),null;o.token&&o.camid&&o.access&&""!==o.token&&""!==o.camid&&""!==o.access&&(t.share_token=o.token,t.camid=o.camid,t.access=o.access),o.api&&(t.host=o.api),o.api_p&&(t.api_port=o.api_p),o.api_security_port&&(t.api_security_port=o.api_security_port)}catch(e){return console.error("Invalid access token format"),null}if(t.base_url=t.host,"web.skyvr.videoexpertsgroup.com"==t.host)t.base_url="https://"+t.host;else if("https:"===location.protocol)t.base_url="https://"+t.host,null!=t.api_secutiry_port?(t.base_url+=":"+t.api_secutiry_port,t.port=t.api_secutiry_port):t.port=443;else{if("http:"!==location.protocol&&"file:"!==location.protocol)return console.error("Invalid protocol"),null;t.base_url="http://"+t.host,null!=self.api_port?(t.base_url+=":"+t.api_port,t.port=t.api_port):t.port=80}return t},CloudHelpers.createCallbacks=function(){return new function(){var n={};console.log(this);var o=this;o.executeCallbacks=function(e,t){function o(e,t,o){setTimeout(function(){n[e](t,o)},1)}for(var r in n)o(r,e,t)},o.removeCallback=function(e){delete n[e]},o.addCallback=function(e,t){"function"==typeof t?(n[e]&&(console.warn(e+" - already registered callback, will be removed before add"),o.removeCallback(e)),n[e]=t):console.error("Second parameter expected function")}}},CloudHelpers.compareVersions=function(e,t){t=t||"0.0.0";var o=(e=e||"0.0.0").split("."),r=t.split(".");if(3==o.length&&3==r.length){for(var n=0;n<3;n++)if(o[n]=parseInt(o[n],10),r[n]=parseInt(r[n],10),o[n]!=r[n])return r[n]-o[n];return 0}console.error("[CloudHelpers.compareVersions] could not compare versions ",e,t)},window.CloudAPI=function(e,t){var i=this;i.token=e.token,i.token_expire=e.expire,i.token_expireUTC=Date.parse(e.expire+"Z"),i.host=t,i.token_type=e.type,i.requestWrap=new CloudHelpers.RequestWrap,i.isShareToken=function(){return"share"==i.token_type},i.endpoints={api:i.host+"api/v2/",cameras:i.host+"api/v2/cameras/",admin_cameras:i.host+"api/v2/admin/cameras/",camsess:i.host+"api/v2/camsess/",server:i.host+"api/v2/server/",account:i.host+"api/v2/account/",cmngrs:i.host+"api/v2/cmngrs/",storage:i.host+"api/v2/storage/",clips:i.host+"api/v2/storage/clips/",channels:i.host+"api/v3/channels/"},i.endpoints_v4={api:i.host+"api/v4/",live_watch:i.host+"api/v4/live/watch/"},i._getCloudToken=function(){return i.token},i.updateApiToken=function(){return i.requestWrap.request({url:i.endpoints.account+"token/api/",type:"GET",token:i._getCloudToken()})},i.isShareToken()||i.updateApiToken().done(function(e){console.warn("[CloudConnection] Cloud Token Api refreshed"),i.token=e.token,i.token_expire=e.expire,i.token_expireUTC=Date.parse(e.expire+"Z"),clearInterval(i.updateTokenInterval),i.updateTokenInterval=setInterval(function(){i.token_expireUTC-(new Date).getTime()<12e5?i.updateApiToken().done(function(e){console.warn("[CloudConnection] Cloud Token api refreshed"),i.token=e.token,i.token_expire=e.expire,i.token_expireUTC=Date.parse(e.expire+"Z")}):console.log("[CloudConnection] Cloud Token is live")},3e5)}),i.dispose=function(){delete i.requestWrap,i.token=null,clearInterval(i.updateTokenInterval)},i.createCamera=function(e){return i.requestWrap.request({url:i.endpoints.cameras+"?detail=detail",type:"POST",token:i._getCloudToken(),data:JSON.stringify(e),contentType:"application/json"})},i.camerasList=function(e){e=e||{},i.isShareToken()&&(e.token=i._getCloudToken());var t=CloudHelpers.mapToUrlQuery(e);return i.requestWrap.request({url:i.endpoints.cameras+"?"+t,type:"GET",token:i._getCloudToken(),contentType:"application/json"})},i.getCameraList=i.camerasList,i.deleteCamera=function(e){return i.requestWrap.request({url:i.endpoints.cameras+e+"/",type:"DELETE",token:i._getCloudToken()})},i.getCamera=function(e,t){(t=t||{}).detail="detail",i.isShareToken()&&(t.token=i._getCloudToken());var o=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:i.endpoints.cameras+e+"/?"+o,type:"GET",token:i._getCloudToken()})},i.getCamera2=function(e,t){t=t||{},i.isShareToken()&&(t.token=i._getCloudToken());var o=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:i.endpoints.cameras+e+"/?"+o,type:"GET",token:i._getCloudToken()})},i.cameraUsage=function(e){return i.requestWrap.request({url:i.endpoints.cameras+e+"/usage/",type:"GET",token:i._getCloudToken()})},i.updateCamera=function(e,t){t=t||{},i.isShareToken()&&(t.token=i._getCloudToken());var o=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:i.endpoints.cameras+e+"/?"+o,type:"PUT",token:i._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},i.cameraLiveUrls=function(e){var t={},o=i.endpoints.cameras+e+"/live_urls/?media_urls=webrtc&";i.isShareToken()&&(t.token=i._getCloudToken(),t.media_urls="webrtc",o=i.endpoints_v4.live_watch+"?");var r=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:o+r,type:"GET",token:i._getCloudToken(),data:JSON.stringify(t)})},i.cameraStreamUrls_webrtc=function(e){var t={},o=i.endpoints.cameras+e+"/stream_urls/?";t.proto="webrtc",i.isShareToken()&&(t.token=i._getCloudToken());var r=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:o+r,type:"GET",token:i._getCloudToken(),data:JSON.stringify(t)})},i.getServerTime=function(){var o=CloudHelpers.promise();return i.requestWrap.request({url:i.endpoints.api+"server/time/",type:"GET"}).done(function(e){var t=CloudHelpers.getCurrentTimeUTC();i.diffServerTime=Date.parse(e.utc+"Z")-t,o.resolve(e)}).fail(function(e){o.reject(e)}),o},i.getAccountInfo=function(){return i.requestWrap.request({url:i.endpoints.account,type:"GET",token:i._getCloudToken()})},i.getAccountCapabilities=function(){return i.requestWrap.request({url:i.endpoints.account+"capabilities/",type:"GET",token:i._getCloudToken()})},i.cameraMediaStreams=function(e){return i.requestWrap.request({url:i.endpoints.cameras+e+"/media_streams/",type:"GET",token:i._getCloudToken()})},i.updateCameraMediaStreams=function(e,t){return i.requestWrap.request({url:i.endpoints.cameras+e+"/media_streams/",type:"PUT",data:JSON.stringify(t),contentType:"application/json",token:i._getCloudToken()})},i.cameraPreview=function(e){var t={};i.isShareToken()&&(t.token=i._getCloudToken());var o=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:i.endpoints.cameras+e+"/preview/?"+o,type:"GET",token:i._getCloudToken()})},i.cameraUpdatePreview=function(e){return i.requestWrap.request({url:i.endpoints.cameras+e+"/preview/update/",type:"POST",token:i._getCloudToken()})},i.cameraSendPtz=function(e,t){t=t||{};var o={};i.isShareToken()&&(o.token=i._getCloudToken());var r=CloudHelpers.mapToUrlQuery(o);return i.requestWrap.request({url:i.endpoints.cameras+e+"/send_ptz/?"+r,type:"POST",token:i._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},i.cameraPtzExecute=function(e,t){t=t||{};var o={};i.isShareToken()&&(o.token=i._getCloudToken());var r=CloudHelpers.mapToUrlQuery(o);return i.requestWrap.request({url:i.endpoints.cameras+e+"/ptz/execute/?"+r,type:"POST",token:i._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},i.cameraPtz=function(e){var t={};i.isShareToken()&&(t.token=i._getCloudToken());var o=CloudHelpers.mapToUrlQuery(t);return i.requestWrap.request({url:i.endpoints.cameras+e+"/ptz/?"+o,type:"GET",token:i._getCloudToken()})},i.storageRecords=function(e,t,o){var r=CloudHelpers.promise(),n={camid:e,limit:1e3,offset:0,start:t};return o&&(n.end=o),i.isShareToken()&&(n.token=i._getCloudToken()),CloudHelpers.requestAsyncList(function(e){var t=CloudHelpers.mapToUrlQuery(e);return i.requestWrap.request({url:i.endpoints.storage+"data/?"+t,type:"GET",token:i._getCloudToken()})},n,r),r},i.storageRecordsFirst=function(e,t,o){CloudHelpers.promise();var r={camid:e,limit:o,offset:0,start:t};r.limit=o,i.isShareToken()&&(r.token=i._getCloudToken());var n=CloudHelpers.mapToUrlQuery(r);return i.requestWrap.request({url:i.endpoints.storage+"data/?"+n,type:"GET",token:i._getCloudToken()})},i.storageTimeline=function(e,t,o,r){var n={start:t,end:o,slices:r};i.isShareToken()&&(n.token=i._getCloudToken());var a=CloudHelpers.mapToUrlQuery(n);return i.requestWrap.request({url:i.endpoints.storage+"timeline/"+e+"/?"+a,type:"GET",token:i._getCloudToken()})},i.storageActivity=function(e,t){var o={camid:e};t&&(o.daysincamtz=""),i.isShareToken()&&(o.token=i._getCloudToken());var r=CloudHelpers.mapToUrlQuery(o);return i.requestWrap.request({url:i.endpoints.storage+"activity/?"+r,type:"GET",token:i._getCloudToken()})},i.resetCameraManager=function(e,t){return i.isShareToken()?(t=t||{},i.requestWrap.request({url:i.endpoints.cmngrs+e+"/reset/?token="+i._getCloudToken(),type:"POST",data:JSON.stringify(t),contentType:"application/json"})):(t=t||{},i.requestWrap.request({url:i.endpoints.cmngrs+e+"/reset/",type:"POST",token:i._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"}))},i.updateCameraManager=function(e,t){return t=t||{},i.requestWrap.request({url:i.endpoints.cmngrs+e+"/",type:"PUT",token:i._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},i.getCamsessList=function(e){var t=CloudHelpers.mapToUrlQuery(e);return i.requestWrap.request({url:i.endpoints.camsess+"?"+t,type:"GET",token:i._getCloudToken(),contentType:"application/json"})},i.getCamsess=function(e){return i.requestWrap.request({url:i.endpoints.camsess+e+"/?detail=detail",type:"GET",token:i._getCloudToken(),contentType:"application/json"})},i.getCamsessRecords=function(e){return i.requestWrap.request({url:i.endpoints.camsess+e+"/records/",type:"GET",token:i._getCloudToken(),contentType:"application/json"})},i.deleteCamsess=function(e){return i.requestWrap.request({url:i.endpoints.camsess+e+"/",type:"DELETE",token:i._getCloudToken()})},i.creareCameraSharingToken=function(e,t,o){return t=t||"",i.requestWrap.request({url:i.endpoints.cameras+e+"/sharings/",type:"POST",data:JSON.stringify({camid:e,name:t,access:o}),contentType:"application/json",token:i._getCloudToken()})},i.updateCameraSharingToken=function(e,t,o){return(o=o||{}).camid=e,o.shid=t,i.requestWrap.request({url:i.endpoints.cameras+e+"/sharings/"+t+"/",type:"PUT",data:JSON.stringify(o),contentType:"application/json",token:i._getCloudToken()})},i.getCameraSharingTokensList=function(e){return i.requestWrap.request({url:i.endpoints.cameras+e+"/sharings/?detail=detail",type:"GET",token:i._getCloudToken()})},i.deleteCameraSharingToken=function(e,t){return i.requestWrap.request({url:i.endpoints.cameras+e+"/sharings/"+t+"/",type:"DELETE",token:i._getCloudToken()})},i.getChannels=function(){return i.requestWrap.request({url:i.endpoints.channels,type:"GET",token:i._getCloudToken()})},i.getCameraStreamingURLs=function(e){return i.requestWrap.request({url:i.endpoints.cameras+e+"/stream_urls/",type:"GET",token:i._getCloudToken()})}},window.SkyVR=window.CloudAPI,CloudAPI.config={url:"",url_cameras:"",url_api:"",cameraID:"",user_name:"",vendor:""},CloudAPI.setToCookie=function(e,t){var o=new Date((new Date).getTime()+6048e5);document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/; expires="+o.toUTCString()},CloudAPI.getFromCookie=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):""},CloudAPI.removeFromCookie=function(e){document.cookie=encodeURIComponent(e)+"=; path=/;"},CloudAPI.cache={cameras:{},timezones:{}},CloudAPI.cache.cameraInfo=function(e){return e?CloudAPI.cache.cameras[e]:CloudAPI.isCameraID()?CloudAPI.cache.cameras[CloudAPI.cameraID()]:void 0},CloudAPI.cache.getCameraInfo=CloudAPI.cache.cameraInfo,CloudAPI.cache.mergeObjects=function(e,t){for(var o in t){var r=typeof t[o];"boolean"==r||"string"==r||"number"==r?e[o]!=t[o]&&(e[o]&&(console.log("Changed "+o),CloudAPI.events.trigger("CAMERA_INFO_CHANGED",{name:o,new_value:t[o]})),e[o]=t[o]):Array.isArray(t[o])?e[o]=t[o]:"object"==r&&(e[o]||(e[o]={}),e[o]=CloudAPI.cache.mergeObjects(e[o],t[o]))}return e},CloudAPI.cache.updateCameraInfo=function(e){var t=e.id;CloudAPI.cache.cameras[t]||(CloudAPI.cache.cameras[t]={}),CloudAPI.cache.cameras[t]=CloudAPI.cache.mergeObjects(CloudAPI.cache.cameras[t],e)},CloudAPI.cache.setCameraInfo=function(e){var t=e.id;null==CloudAPI.cache.cameras[t]&&(CloudAPI.cache.cameras[t]={});var o=!(!e.p2p_streaming||1!=e.p2p_streaming),r=CloudAPI.cache.cameras[t];return CloudAPI.cache.cameras[t]=CloudAPI.cache.mergeObjects(r,e),CloudAPI.cache.cameras[t].lastTimeUpdated=Date.now(),o},CloudAPI.cache.setP2PSettings=function(e,t){null==CloudAPI.cache.cameras[e]&&(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].p2p=t,CloudAPI.cache.cameras[e].p2p_settings=CloudAPI.cache.cameras[e].p2p},CloudAPI.cache.setMemoryCard=function(e,t){null==CloudAPI.cache.cameras[e]&&(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].memory_card=t},CloudAPI.cache.setPtzCaps=function(e,t){null==CloudAPI.cache.cameras[e]&&(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].ptz=t},CloudAPI.cache.updateCameraAudio=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].audio||(CloudAPI.cache.cameras[e].audio={}),CloudAPI.cache.cameras[e].audio=CloudAPI.cache.mergeObjects(CloudAPI.cache.cameras[e].audio,t)},CloudAPI.cache.cameraAudio=function(e){return e=e||CloudAPI.cameraID(),CloudAPI.cache.cameras[e]?CloudAPI.cache.cameras[e].audio:{}},CloudAPI.cache.updateCameraVideo=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].video||(CloudAPI.cache.cameras[e].video={});var o=CloudAPI.cache.cameras[e].video;CloudAPI.cache.cameras[e].video=CloudAPI.cache.mergeObjects(o,t)},CloudAPI.cache.cameraVideo=function(e){return e=e||CloudAPI.cameraID(),CloudAPI.cache.cameras[e]?CloudAPI.cache.cameras[e].video:{}},CloudAPI.cache.cameraVideoStreamName=function(e){if(e=e||CloudAPI.cameraID(),!CloudAPI.cache.cameras[e])return{};var t=CloudAPI.cache.cameras[e].video;if(t.streams)for(var o in t.streams)return o},CloudAPI.cache.cameraVideoStreams=function(e){if(e=e||CloudAPI.cameraID(),!CloudAPI.cache.cameras[e])return{};var t=CloudAPI.cache.cameras[e].video;return t.streams?t.streams:void 0},CloudAPI.cache.setLimits=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].limits=t},CloudAPI.cache.updateCameraVideoStream=function(e,t,o){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].video||(CloudAPI.cache.cameras[e].video={}),CloudAPI.cache.cameras[e].video.streams||(CloudAPI.cache.cameras[e].video.streams={}),CloudAPI.cache.cameras[e].video.streams[t]||(CloudAPI.cache.cameras[e].video.streams[t]={});var r=CloudAPI.cache.cameras[e].video.streams[t];CloudAPI.cache.cameras[e].video.streams[t]=CloudAPI.cache.mergeObjects(r,o)},CloudAPI.cache.setAudioStream=function(e,t,o){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].audio||(CloudAPI.cache.cameras[e].audio={}),CloudAPI.cache.cameras[e].audio.streams||(CloudAPI.cache.cameras[e].audio.streams={}),CloudAPI.cache.cameras[e].audio.streams[t]=o},CloudAPI.cache.setMediaStreams=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].media_streams=t},CloudAPI.cache.updateEventProcessingEventsMotion=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].event_processing||(CloudAPI.cache.cameras[e].event_processing={}),CloudAPI.cache.cameras[e].event_processing.events||(CloudAPI.cache.cameras[e].event_processing.events={}),CloudAPI.cache.cameras[e].event_processing.events.motion||(CloudAPI.cache.cameras[e].event_processing.events.motion={});var o=CloudAPI.cache.cameras[e].event_processing.events.motion;CloudAPI.cache.cameras[e].event_processing.events.motion=CloudAPI.cache.mergeObjects(o,t)},CloudAPI.cache.updateCameraEventProcessingEventsSound=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].event_processing||(CloudAPI.cache.cameras[e].event_processing={}),CloudAPI.cache.cameras[e].event_processing.events||(CloudAPI.cache.cameras[e].event_processing.events={}),CloudAPI.cache.cameras[e].event_processing.events.sound||(CloudAPI.cache.cameras[e].event_processing.events.sound={});var o=CloudAPI.cache.cameras[e].event_processing.events.sound;CloudAPI.cache.cameras[e].event_processing.events.sound=CloudAPI.cache.mergeObjects(o,t)},CloudAPI.generateNewLocation=function(e){var t=[];return CloudHelpers.containsPageParam("lang")&&t.push("lang="+encodeURIComponent(CloudAPI.pageParams.lang)),CloudHelpers.containsPageParam("vendor")&&t.push("vendor="+encodeURIComponent(CloudAPI.pageParams.vendor)),CloudHelpers.containsPageParam("mobile")&&t.push("mobile="+encodeURIComponent(CloudAPI.pageParams.mobile)),t.push("p="+encodeURIComponent(e)),"?"+t.join("&")},CloudAPI.setURL=function(e){if(CloudAPI.config.url!=e){CloudAPI.config.url=e,CloudAPI.config.url_api=e+"api/v2/",CloudAPI.config.url_cameras=e+"api/v2/cameras/",CloudAPI.config.url_admin_cameras=e+"api/v2/admin/cameras/",CloudAPI.config.url_camsess=e+"api/v2/camsess/",CloudAPI.config.url_server=e+"api/v2/server/",CloudAPI.config.url_account=e+"api/v2/account/",CloudAPI.config.url_cmngrs=e+"api/v2/cmngrs/",CloudAPI.config.url_storage=e+"api/v2/storage/",CloudAPI.config.url_clips=e+"api/v2/storage/clips/",CloudAPI.config.anonToken={token:"",type:"anon",expire:"",expireTimeUTC:0},localStorage.getItem("SkyVR_anonToken")&&(CloudAPI.config.anonToken=JSON.parse(localStorage.getItem("SkyVR_anonToken"))),CloudAPI.config.apiToken={token:"",type:"api",expire:"",expireTimeUTC:0},CloudAPI.config.shareToken={};var t=CloudAPI.getFromStorage("SkyVR_apiToken");if(t){var o=JSON.parse(t);o.expireTimeUTC>Date.now()&&(CloudAPI.config.apiToken=o)}CloudAPI.setToStorage("CloudAPI_svcp_host",e)}},CloudAPI.isExpiredApiToken=function(){return!CloudAPI.config.apiToken.expireTimeUTC||!(CloudAPI.config.apiToken.expireTimeUTC>Date.now())},CloudAPI.applyApiToken=function(){$.ajaxSetup({crossDomain:!0,cache:!1,beforeSend:function(e,t){CloudAPI.config.apiToken&&CloudAPI.config.apiToken.token&&e.setRequestHeader("Authorization","SkyVR "+CloudAPI.config.apiToken.token)}})},CloudAPI.enable401handler=function(){},CloudAPI.disable401handler=function(){$.ajaxSetup({error:function(e,t,o){}})},CloudAPI.printStack=function(){var e=new Error;console.error(e.stack)},CloudAPI.PAGE_SIGNIN="signin",CloudAPI.hasAccess=function(e,t){if(SkyUI.isDemo())return!0;if(!e)return!1;if(!e.access)return!0;var o=!1;for(var r in e.access)e.access[r]==t&&(o=!0);return o},CloudAPI.hasAccessSettings=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessMotionDetection=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"all")||CloudAPI.hasAccess(e,"ptz"))},CloudAPI.hasAccessClips=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"clipping")||CloudAPI.hasAccess(e,"clipplay")||CloudAPI.hasAccess(e,"watch")||CloudAPI.hasAccess(e,"cplay")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessLive=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"ptz")||CloudAPI.hasAccess(e,"live")||CloudAPI.hasAccess(e,"watch")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessPlayback=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"clipping")||CloudAPI.hasAccess(e,"play")||CloudAPI.hasAccess(e,"watch")||CloudAPI.hasAccess(e,"splay")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessMakeClip=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"clipping")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessBackAudio=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"all")||CloudAPI.hasAccess(e,"backaudio"))},CloudAPI.handleNothing=function(e){},CloudAPI.handleNothingError=function(e,t,o){},CloudAPI.handleError=function(e,t,o){console.error(o)},CloudAPI.parseUri=function(e){function a(e){for(var r=a.options,t=r.parser[r.strictMode?"strict":"loose"].exec(e),n={},o=14;o--;)n[r.key[o]]=t[o]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,function(e,t,o){t&&(n[r.q.name][t]=o)}),n}return a.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},a(e)},CloudAPI.logout=function(e){$.ajax({url:CloudAPI.config.url_account+"logout/",type:"POST",success:e,error:CloudAPI.handleError})},CloudAPI.cameraVideoStream=function(t){var o=$.Deferred();if(!CloudAPI.isCameraID())return o.reject(),o;var r=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+r+"/video/streams/"+t+"/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraVideoStream(r,t,e),o.resolve(e)}).fail(function(){o.reject()}),o},CloudAPI.cameraLimits=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var e=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+e+"/limits/",type:"GET"}).done(function(e){CloudAPI.cache.setLimits(CloudAPI.cameraID(),e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.cameraEventProcessingEventsMotion=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+o+"/event_processing/events/motion/",type:"GET"}).done(function(e){CloudAPI.cache.updateEventProcessingEventsMotion(o,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraEventProcessingEventsMotion=function(e){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+o+"/event_processing/events/motion/",type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(){CloudAPI.cache.updateEventProcessingEventsMotion(o,e),t.resolve()}).fail(function(){t.reject()}),t},CloudAPI.cameraEventProcessingEventsSound=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+o+"/event_processing/events/sound/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraEventProcessingEventsSound(o,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraEventProcessingEventsSound=function(e){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+o+"/event_processing/events/sound/",type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(){CloudAPI.cache.updateCameraEventProcessingEventsSound(o,e),t.resolve()}).fail(function(){t.reject()}),t},CloudAPI.updateCameraVideoStream=function(e,t){var o=$.Deferred();if(!CloudAPI.isCameraID())return o.reject(),o;var r=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+r+"/video/streams/"+e+"/",type:"PUT",data:JSON.stringify(t),contentType:"application/json"}).done(function(){console.log("[CLOUDAPI] [CLOUDAPI] Updated video/streams/"+e+" in cache for "+r),CloudAPI.cache.updateCameraVideoStream(r,e,t),o.resolve()}).fail(function(){o.reject()}),o},CloudAPI.setVBRQuality=function(e,t,o,r){if(CloudAPI.isCameraID()){o=null==o?CloudAPI.handleNothing:o,r=null==r?CloudAPI.handleError:r;var n={};n.vbr_quality=e,n.vbr=!0,$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/video/streams/"+t+"/",type:"PUT",success:o,error:o,data:JSON.stringify(n),contentType:"application/json"})}},CloudAPI.formatMemoryCard=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var e=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+e+"/format_memory_card/",type:"POST"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.cameraMemoryCard=function(t){var o=$.Deferred();return(t=t||CloudAPI.config.cameraID)?$.ajax({url:CloudAPI.config.url_cameras+t+"/memory_card/",type:"GET"}).done(function(e){CloudAPI.cache.setMemoryCard(t,e),o.resolve(e)}).fail(function(){CloudAPI.cache.setMemoryCard(t,{status:"none"}),o.reject()}):o.reject(),o},CloudAPI.cameraWifi=function(){var t=$.Deferred();return CloudAPI.isCameraID()?$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/wifi/",type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}):t.reject(),t},CloudAPI.cameraFirmwares=function(){var t=$.Deferred();return CloudAPI.isCameraID()?$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/firmwares/?limit=1000",type:"GET",contentType:"application/json"}).done(function(e){t.resolve(e.objects)}).fail(function(){t.reject()}):t.reject(),t},CloudAPI.cameraFirmwaresUpgrade=function(e){var o=$.Deferred();if(!CloudAPI.isCameraID())return o.reject(),o;console.log("[CLOUDAPI] upgrade firmware to version: "+e);var t={};return t.version=e,$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/firmwares/upgrade/",type:"POST",data:JSON.stringify(t),contentType:"application/json"}).done(function(){o.resolve()}).fail(function(e,t){console.error("[CLOUDAPI] cameraFirmwaresUpgrade, "+t,e),o.reject()}),o},CloudAPI.accountInfo=function(){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_account,type:"GET",cache:!1}).done(function(e){CloudAPI.cache.account=e,t.resolve(e)}).fail(function(e){console.log("Fail "+CloudAPI.config.url_account),console.error(e),t.reject(e)}),t},CloudAPI.anonToken=function(){var t=$.Deferred(),e=Date.now(),o=CloudAPI.config.anonToken.expireTimeUTC-6e5,r=CloudAPI.config.anonToken.expireTimeUTC-3e5;return o<e&&e<r?($.ajaxSetup({crossDomain:!0,cache:!1,headers:{Authorization:"SkyVR "+CloudAPI.config.anonToken.token}}),t.resolve(CloudAPI.config.anonToken)):$.ajax({url:CloudAPI.config.url_account+"token/anon/",type:"GET"}).done(function(e){CloudAPI.config.anonToken.token=e.token,CloudAPI.config.anonToken.type=e.type,CloudAPI.config.anonToken.expire=e.expire,CloudAPI.config.anonToken.expireTimeUTC=Date.parse(e.expire+"Z"),CloudAPI.setToStorage("SkyVR_anonToken",JSON.stringify(CloudAPI.config.anonToken)),$.ajaxSetup({crossDomain:!0,cache:!1,headers:{Authorization:"SkyVR "+e.token}}),t.resolve(CloudAPI.config.anonToken)}).fail(function(){t.reject()}),t},CloudAPI.accountShare=function(e){return CloudAPI.cameraID(),$.ajax({url:CloudAPI.config.url_account+"share/",type:"POST",data:JSON.stringify(e),contentType:"application/json",cache:!1})},CloudAPI.capabilities=function(e,t){e=null==e?CloudAPI.handleNothing:e,t=null==t?CloudAPI.handleError:t,$.ajax({url:CloudAPI.config.url_api+"capabilities/",type:"GET",success:e,error:t})},CloudAPI.cameraInfo=function(t){var o=$.Deferred();return null==(t=t||CloudAPI.cameraID())?o.reject():$.ajax({url:CloudAPI.config.url_cameras+t+"/",type:"GET"}).done(function(e){CloudAPI.cache.cameras[e.id]&&!CloudAPI.cache.cameras[e.id].memory_card?(console.log("cameraInfo cahce has not memory card info for camid="+e.id),CloudAPI.cameraMemoryCard(e.id)):CloudAPI.cache.cameras[e.id]||(console.log("cameraInfo has not in cache for camid="+e.id),CloudAPI.cameraMemoryCard(e.id)),CloudAPI.cache.setCameraInfo(e)?CloudAPI.cameraP2PSettings(t).done(function(e){o.resolve(CloudAPI.cache.cameras[t])}).fail(function(){o.resolve(CloudAPI.cache.cameras[t])}):o.resolve(CloudAPI.cache.cameras[t])}).fail(function(){o.reject()}),o},CloudAPI.updateCamera=function(t){var o=$.Deferred();return CloudAPI.isCameraID()?$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/",type:"PUT",data:JSON.stringify(t),contentType:"application/json"}).done(function(e){console.log("[CLOUDAPI] Updated camera in cache for "+CloudAPI.cameraID()),t.id=CloudAPI.cameraID(),CloudAPI.cache.updateCameraInfo(t),o.resolve(e)}).fail(function(){o.reject()}):o.reject(),o},CloudAPI.cameraMesaging=function(e){var t=$.Deferred();return null==(e=e||CloudAPI.cameraID())?t.reject():$.ajax({url:CloudAPI.config.url_cameras+e+"/raw_messaging/",type:"GET"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},CloudAPI.updateCameraAudio=function(t){var o=$.Deferred();if(!CloudAPI.isCameraID())return o.reject(),o;var r=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+r+"/audio/",type:"PUT",data:JSON.stringify(t),contentType:"application/json"}).done(function(e){console.log("[CLOUDAPI] Updated audio in cache for "+r),CloudAPI.cache.updateCameraAudio(r,t),o.resolve(e)}).fail(function(){o.reject()}),o},CloudAPI.cameraAudio=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+o+"/audio/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraAudio(o,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.cameraVideo=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+o+"/video/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraVideo(o,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraVideo=function(t){var o=$.Deferred();if(!CloudAPI.isCameraID())return o.reject(),o;var r=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+r+"/video/",type:"PUT",contentType:"application/json",data:JSON.stringify(t)}).done(function(e){CloudAPI.cache.updateCameraVideo(r,t),o.resolve(e)}).fail(function(){o.reject()}),o},CloudAPI.setCameraVideo=function(e,t,o){if(CloudAPI.isCameraID())return t=t||CloudAPI.handleNothing,o=o||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/video/",type:"PUT",success:t,error:o,contentType:"application/json",data:JSON.stringify(e)})},CloudAPI.cameraMediaStreams=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var o=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+o+"/media_streams/",type:"GET"}).done(function(e){CloudAPI.cache.setMediaStreams(o,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraMediaStreams=function(e,t){var o=$.Deferred();return(t=t||CloudAPI.cameraID())?$.ajax({url:CloudAPI.config.url_cameras+t+"/media_streams/",type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(e){o.resolve(e)}).fail(function(e){o.reject(e)}):o.reject(),o},CloudAPI.cameraLiveUrls=function(e){var t=$.Deferred();return(e=e||CloudAPI.cameraID())?$.ajax({url:CloudAPI.config.url_cameras+e+"/live_urls/",type:"GET"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}):t.reject(),t},CloudAPI.cameraBackwardStart=function(){if(CloudAPI.isCameraID()){var e={};CloudAPI.config.backwardURL&&(e.url=CloudAPI.config.backwardURL,CloudAPI.config.tmpBackwardURL==CloudAPI.config.backwardURL?CloudAPI.config.tmpBackwardURLCount++:(CloudAPI.config.tmpBackwardURLCount=1,CloudAPI.config.tmpBackwardURL=CloudAPI.config.backwardURL),CloudAPI.isP2PStreaming()&&(console.log("[CLOUDAPI] Send (audio streaming) backward start: "+CloudAPI.config.backwardURL),$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/audio/backward/start/",type:"POST",success:CloudAPI.handleNothing,data:JSON.stringify(e),contentType:"application/json"})))}},CloudAPI.cameraBackwardStop=function(){if(CloudAPI.isCameraID()){var e={};if(CloudAPI.config.backwardURL){if(e.url=CloudAPI.config.backwardURL,CloudAPI.config.tmpBackwardURL==CloudAPI.config.backwardURL){if(0==CloudAPI.config.tmpBackwardURLCount)return;CloudAPI.config.tmpBackwardURLCount--}CloudAPI.isP2PStreaming()&&(console.log("[CLOUDAPI] Send (audio streaming) backward stop: "+CloudAPI.config.backwardURL),$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/audio/backward/stop/",type:"POST",success:CloudAPI.handleNothing,data:JSON.stringify(e),contentType:"application/json"}))}}},CloudAPI.cameraSchedule=function(){if(CloudAPI.isCameraID())return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/schedule/",type:"GET",cache:!1})},CloudAPI.updateCameraSchedule=function(e){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/schedule/",type:"PUT",data:JSON.stringify(e),cache:!1,contentType:"application/json"})},CloudAPI.hasAccessCameraPreview=function(e){var t=CloudAPI.cache.cameraInfo(e);return!!t&&(CloudAPI.hasAccess(t,"live")||CloudAPI.hasAccess(t,"all")||CloudAPI.hasAccess(t,"ptz"))},CloudAPI.cameraPreview=function(e,t,o){return t=null==t?CloudAPI.handleNothing:t,o=null==o?CloudAPI.handleError:o,$.ajax({url:CloudAPI.config.url_cameras+e+"/preview/",type:"GET",success:t,error:o})},CloudAPI.hasAccessCameraUpdatePreview=function(e){var t=CloudAPI.cache.cameraInfo(e);return!!t&&(CloudAPI.hasAccess(t,"live")||CloudAPI.hasAccess(t,"all")||CloudAPI.hasAccess(t,"ptz"))},CloudAPI.cameraUpdatePreview=function(e){return $.ajax({url:CloudAPI.config.url_cameras+e+"/preview/update/",type:"POST"})},CloudAPI.storageDataFirstRecord=function(e){var t=$.Deferred(),o={camid:CloudAPI.cameraID(),limit:1,offset:0};return e&&(o.start=e),$.ajax({url:CloudAPI.config.url_storage+"data/",data:o,cache:!1,type:"GET"}).done(function(e){0<e.objects.length?t.resolve(e.objects[0]):t.reject()}).fail(function(){t.reject()}),t},CloudAPI.storageEventsFirstRecord=function(){var t=$.Deferred(),e={camid:CloudAPI.cameraID(),limit:1,offset:0};return $.ajax({url:CloudAPI.config.url_storage+"events/",data:e,cache:!1,type:"GET"}).done(function(e){0<e.objects.length?t.resolve(e.objects[0]):t.reject()}).fail(function(){t.reject()}),t},CloudAPI.storageThumbnailsFirstRecord=function(){var t=$.Deferred(),e={camid:CloudAPI.cameraID(),limit:1,offset:0};return $.ajax({url:CloudAPI.config.url_storage+"thumbnails/",data:e,cache:!1,type:"GET"}).done(function(e){0<e.objects.length?t.resolve(e.objects[0]):t.reject()}).fail(function(){t.reject()}),t},CloudAPI.getAllData=function(e,t){},CloudAPI.storageThumbnails=function(e,t){var r=$.Deferred(),n={meta:{limit:1e3,offset:0,total_count:-1},objects:[]},a={camid:CloudAPI.cameraID(),limit:n.meta.limit,offset:n.meta.offset,start:e};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_storage+"thumbnails/",data:e,cache:!1,async:!0,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return t&&(a.end=t),i(a).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],o=n.meta.limit;o<e.meta.total_count;o+=n.meta.limit)a.offset=o,t.push(i(a));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.storageTimeline=function(e,t){var r=$.Deferred(),n={meta:{limit:1e3,offset:0,total_count:-1},objects:[]},a={slices:1,camid:CloudAPI.cameraID(),limit:n.meta.limit,offset:n.meta.offset,start:e};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_storage+"timeline/"+CloudAPI.cameraID()+"/",data:e,cache:!1,async:!0,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return t&&(a.end=t),i(a).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],o=n.meta.limit;o<e.meta.total_count;o+=n.meta.limit)a.offset=o,t.push(i(a));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.storageEvents=function(e,t){var r=$.Deferred(),n={meta:{limit:1e3,offset:0,total_count:-1},objects:[]},a={camid:CloudAPI.cameraID(),limit:n.meta.limit,offset:n.meta.offset,start:e};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_storage+"events/",data:e,cache:!1,async:!0,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return t&&(a.end=t),i(a).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],o=n.meta.limit;o<e.meta.total_count;o+=n.meta.limit)a.offset=o,t.push(i(a));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.cameraMotionDetectionDemo=function(){return JSON.parse('{"caps": {"columns": 23, "max_regions": 8, "region_shape": "rect", "rows": 15, "sensitivity": "region"}}')},CloudAPI.cameraMotionDetection=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/motion_detection/",type:"GET"})},CloudAPI.cameraMotionDetectionRegionsDemo=function(){return JSON.parse('{"meta": {"limit": 20, "next": null, "offset": 0, "previous": null, "total_count": 8}, "objects": [{"enabled": true, "id": 2686, "map": "ZmQwMDBjM2ZjMDAwN2Y4MDAwZmYwMDAxZmUwMDAzZmNlNjAw", "name": "motion1", "sensitivity": 5}, {"enabled": true, "id": 2687, "map": "ZjYwMDBmMGZmODAwMWZmMDAwM2ZlMDAwN2ZjMDAwZmY4MDAxZmZmMDAw", "name": "motion2", "sensitivity": 5}, {"enabled": true, "id": 2688, "map": "ZjQwMDBmM2ZlMDAwN2ZjMDAwZmY4MDAxZmYwMDAzZmUwMDA3ZmNmMjAw", "name": "motion3", "sensitivity": 5}, {"enabled": true, "id": 2689, "map": "ZWMwMDBjMWZlMDAwM2ZjMDAwN2Y4MDAwZmYwMDAxZmVmNzAw", "name": "motion4", "sensitivity": 5}, {"enabled": true, "id": 2690, "map": "ZTQwMDA2ZTAwMDAxYzAwMDAzODBmOTAw", "name": "motion5", "sensitivity": 5}, {"enabled": true, "id": 2691, "map": "MmIwMWZmMDAwM2ZlMDAwN2ZjMDAwZmY4MDAxZmYwMDAzZmUwMDA3ZmMwMDBmZjgwMDFmZjAwMDNmZTAwMDdmYzAwMGZmODAwMWZmMDAwM2ZlMDAwN2ZjMDAw", "name": "motion6", "sensitivity": 5}, {"enabled": true, "id": 2692, "map": "MTJmZjgwMDFmZjAwMDNmZTAwMDdmYzAwMGZmODAwMWZmMDAwM2ZlMGU4MDA=", "name": "motion7", "sensitivity": 5}, {"enabled": false, "id": 2693, "map": "", "name": "motion8", "sensitivity": 5}]}')},CloudAPI.cameraMotionDetectionRegions=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/motion_detection/regions/",type:"GET"})},CloudAPI.cameraP2PSettings=function(t,o,e,r){return t=t||CloudAPI.cameraID(),o=null==o?CloudAPI.handleNothing:o,e=null==e?CloudAPI.handleError:e,r=null==r?CloudAPI.handleNothing:r,$.ajax({url:CloudAPI.config.url_cameras+t+"/p2p_settings/",type:"GET",success:function(e){CloudAPI.cache.setP2PSettings(t,e),o(e)},error:e,complete:r})},CloudAPI.cameraSetP2PSettings=function(e){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/p2p_settings/",type:"PUT",data:JSON.stringify(e),cache:!1,contentType:"application/json"})},CloudAPI.cameraLog=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/log/",type:"GET"})},CloudAPI.cameraLogDownload=function(e){var t=$.Deferred(),o=null;return(o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&(200==o.status?t.resolve(o.responseText):t.reject())},o.open("GET",e,!0),o.send(),t.promise()},CloudAPI.cameraLogUpdate=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/log/update/",type:"POST"})},CloudAPI.cameraManagersList=function(e,t){e=e||CloudAPI.handleNothing,t=t||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cmngrs,type:"GET",success:e,error:t})},CloudAPI.cameraManagerReset=function(e){return $.ajax({url:CloudAPI.config.url_cmngrs+e+"/reset/",type:"POST"})},CloudAPI.camerasList=function(e){e=e||{};var n=$.Deferred(),r={meta:{limit:20,offset:0,total_count:-1},objects:[]},a={limit:r.meta.limit,offset:r.meta.offset};for(var t in e)a[t]=e[t];function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_cameras,data:e,cache:!1,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}function s(t){var o=0,r=t.objects.length;o==r&&n.resolve(t);for(var e=0;e<r;e++)cam=t.objects[e],CloudAPI.cache.setCameraInfo(cam)?(console.log("update p2p_settings: ",cam.id),CloudAPI.cameraP2PSettings(cam.id).done(function(e){CloudAPI.cameraMemoryCard(cam.id).done(function(){(o+=1)==r&&n.resolve(t)}).fail(function(){(o+=1)==r&&n.resolve(t)})}).fail(function(){(o+=1)==r&&n.resolve(t)})):(o+=1)==r&&n.resolve(t)}return i(a).fail(function(){n.reject()}).done(function(e){if(r.meta.total_count=e.meta.total_count,$.merge(r.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)s(r);else{for(var t=[],o=r.meta.limit;o<e.meta.total_count;o+=r.meta.limit)a.offset=o,t.push(i(a));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(r.objects,arguments[e].objects);s(r)}).fail(function(){n.reject()})}}),n},CloudAPI.camerasListByCriterions=function(e,t,o){t=t||CloudAPI.handleNothing,o=o||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cameras,data:e,type:"GET",success:t,error:o})},CloudAPI.cameraManagerInfo=function(e,t,o){t=t||CloudAPI.handleNothing,o=o||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cmngrs+e+"/",type:"GET",success:t,error:o})},CloudAPI.cameraManagerSetTimezone=function(e,t,o,r){o=o||CloudAPI.handleNothing,r=r||CloudAPI.handleError;var n={};n.timezone=t,$.ajax({url:CloudAPI.config.url_cmngrs+e+"/",type:"PUT",success:o,error:r,data:JSON.stringify(n),contentType:"application/json"})},CloudAPI.storageClipList=function(){var r=$.Deferred(),n={meta:{limit:100,offset:0,total_count:-1},objects:[]},a={limit:n.meta.limit,offset:n.meta.offset,camid:CloudAPI.cameraID(),usecamtz:""};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_clips,data:e,cache:!1,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return i(a).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],o=n.meta.limit;o<e.meta.total_count;o+=n.meta.limit)a.offset=o,t.push(i(a));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.storageClipListAnon=function(e){var i=$.Deferred();return CloudAPI.anonToken().done(function(o){var r={meta:{limit:100,offset:0,total_count:-1},objects:[]},n={limit:r.meta.limit,offset:r.meta.offset,usecamtz:""};function a(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_clips,data:e,cache:!1,type:"GET",headers:{Authorization:"SkyVR "+o.token}}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}e&&(n.token=e),a(n).fail(function(){i.reject()}).done(function(e){if(r.meta.total_count=e.meta.total_count,r.meta.expire=e.meta.expire,$.merge(r.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)i.resolve(r);else{for(var t=[],o=r.meta.limit;o<e.meta.total_count;o+=r.meta.limit)n.offset=o,t.push(a(n));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(r.objects,arguments[e].objects);i.resolve(r)}).fail(function(){i.reject()})}})}).fail(function(){i.reject()}),i},CloudAPI.storageClipCreate=function(e,t,o,r,n){var a={};return a.camid=CloudAPI.cameraID(),a.title=e,a.group=t,a.start=o,a.end=r,a.delete_at=n,$.ajax({url:CloudAPI.config.url_clips,type:"POST",data:JSON.stringify(a),cache:!1,contentType:"application/json"})},CloudAPI.storageClip=function(e){return $.ajax({url:CloudAPI.config.url_clips+e+"/",type:"GET",cache:!1})},CloudAPI.serverTime=function(){return $.ajax({url:CloudAPI.config.url_server+"time/",type:"GET",cache:!1})},CloudAPI.storageClipAnon=function(t,e){var o=$.Deferred(),r={};return e&&(r.token=e),CloudAPI.anonToken().done(function(e){$.ajax({url:CloudAPI.config.url_clips+t+"/",type:"GET",data:r,cache:!1,headers:{Authorization:"SkyVR "+e.token}}).done(function(e){o.resolve(e)}).fail(function(){o.reject()})}).fail(function(){o.reject()}),o},CloudAPI.storageClipDelete=function(e){return $.ajax({url:CloudAPI.config.url_clips+e+"/",type:"DELETE",cache:!1})},CloudAPI.storageClipUpdate=function(e,t){return $.ajax({url:CloudAPI.config.url_clips+e+"/",data:JSON.stringify(t),type:"PUT",cache:!1,contentType:"application/json"})},CloudAPI.cameraSettings=function(){var a,e=$.Deferred(),t=[];function o(e){var t=$.Deferred();return e.always(function(){t.resolve()}),t}return t.push(o((a=$.Deferred(),CloudAPI.cameraMediaStreams().done(function(e){console.log("MediaStreams: ",e);var t=e.mstreams_supported,o=e.live_ms_id;if(0<t.length&&""!=o){for(var r="",n=0;n<t.length;n++)if(t[n].id==o){r=t[n].vs_id;break}""!=r?CloudAPI.cameraVideoStream(r).done(function(){a.resolve()}).fail(function(){a.reject()}):a.reject()}else a.resolve()}).fail(function(){a.reject()}),a))),CloudAPI.cache.cameraInfo().url||(t.push(o(CloudAPI.cameraVideo())),t.push(o(CloudAPI.cameraAudio())),t.push(o(CloudAPI.cameraLimits())),t.push(o(CloudAPI.cameraEventProcessingEventsMotion())),t.push(o(CloudAPI.cameraEventProcessingEventsSound())),t.push(o(CloudAPI.cameraMemoryCard()))),$.when.apply($,t).done(function(){e.resolve(CloudAPI.cache.cameraInfo())}).fail(function(){e.reject()}),e},CloudAPI.createCamsess=function(e){return e=e||{},$.ajax({url:CloudAPI.config.url_camsess,data:JSON.stringify(e),type:"POST",contentType:"application/json",cache:!1})},CloudAPI.updateCamsess=function(e,t){return t=t||{},$.ajax({url:CloudAPI.config.url_camsess+e+"/",data:JSON.stringify(t),type:"PUT",contentType:"application/json",cache:!1})},CloudAPI.cameraCreate=function(e){var t=$.Deferred();return e=e||{},$.ajax({url:CloudAPI.config.url_cameras,type:"POST",data:JSON.stringify(e),cache:!1,contentType:"application/json"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},CloudAPI.cameraDelete=function(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_cameras+e+"/",type:"DELETE",cache:!1}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},CloudAPI.cameraUpdate=function(e,t){var o=$.Deferred();return t=t||{},$.ajax({url:CloudAPI.config.url_cameras+e+"/",type:"PUT",data:JSON.stringify(t),cache:!1,contentType:"application/json"}).done(function(e){o.resolve(e)}).fail(function(e){o.reject(e)}),o},CloudAPI.adminCameras=function(e){return e=e||{},$.ajax({url:CloudAPI.config.url_admin_cameras,data:e,type:"GET",cache:!1})},CloudAPI.adminCameraInfo=function(e){return $.ajax({url:CloudAPI.config.url_admin_cameras+e+"/",type:"GET",cache:!1})},CloudAPI.updateAdminCamera=function(e,t){return t=t||{},$.ajax({url:CloudAPI.config.url_admin_cameras+e+"/",type:"PUT",data:JSON.stringify(t),contentType:"application/json",cache:!1})},CloudAPI.store={},CloudAPI.store.volume=function(e){return e&&CloudAPI.setToStorage("volume",e),CloudAPI.getFromStorage("volume")},CloudAPI.store.prev_volume=function(e){return e&&CloudAPI.setToStorage("prev_volume",e),CloudAPI.getFromStorage("prev_volume")},CloudAPI.store.zoom=function(e){return null!=e&&CloudAPI.setToStorage("zoom",e),CloudAPI.getFromStorage("zoom")},CloudAPI.store.zoom_left=function(e){return null!=e&&CloudAPI.setToStorage("zoom_left",e),CloudAPI.getFromStorage("zoom_left")},CloudAPI.store.zoom_top=function(e){return null!=e&&CloudAPI.setToStorage("zoom_top",e),CloudAPI.getFromStorage("zoom_top")},CloudAPI.store.user_profile=function(e){return null!=e&&CloudAPI.setToStorage("user_profile",e),CloudAPI.getFromStorage("user_profile")},CloudAPI.store.svcp_host=function(e){return null!=e&&CloudAPI.setToStorage("svcp_host",e),CloudAPI.getFromStorage("svcp_host")},CloudAPI.storageTemp={},CloudAPI.storageMode="local",CloudAPI.detectStorageMode=function(){try{localStorage.setItem("detectStorageMode","yes")}catch(e){CloudAPI.storageMode="temp"}},CloudAPI.detectStorageMode(),CloudAPI.setToStorage=function(e,t){"local"==CloudAPI.storageMode?localStorage.setItem(e,t):CloudAPI.storageTemp[e]=t},CloudAPI.getFromStorage=function(e){return"local"==CloudAPI.storageMode?localStorage.getItem(e):CloudAPI.storageTemp[e]},CloudAPI.removeFromStorage=function(e){"local"==CloudAPI.storageMode?localStorage.removeItem(e):CloudAPI.storageTemp[e]=void 0},CloudAPI.loadApiTokenFromHref=function(){var e=window.location.href.split("#"),t=e[e.length-1];for(var o in t=t.split("&")){var r=t[o].split("=")[0],n=decodeURIComponent(t[o].split("=")[1]);"token"==r?(CloudAPI.config.apiToken=CloudAPI.config.apiToken||{},CloudAPI.config.apiToken.token=n,CloudAPI.config.apiToken.type="api"):"expire"==r&&(CloudAPI.config.apiToken=CloudAPI.config.apiToken||{},CloudAPI.config.apiToken.expire=n,CloudAPI.config.apiToken.expireTimeUTC=Date.parse(n+"Z"))}console.log("Href token: ",CloudAPI.config.apiToken),CloudAPI.setToStorage("SkyVR_apiToken",JSON.stringify(CloudAPI.config.apiToken))},CloudAPI.cleanupApiToken=function(){CloudAPI.removeFromStorage("SkyVR_apiToken"),CloudAPI.config.apiToken=null,$.ajaxSetup({crossDomain:!0,cache:!1,beforeSend:function(e,t){e.setRequestHeader("Authorization","")}})},CloudHelpers.containsPageParam("svcp_host")?CloudAPI.setURL(CloudAPI.pageParams.svcp_host):CloudAPI.getFromStorage("CloudAPI_svcp_host")?CloudAPI.setURL(CloudAPI.getFromStorage("CloudAPI_svcp_host")):CloudAPI.setURL(("file:"==window.location.protocol?"http":window.location.protocol)+"//"+window.location.host.toString()+"/"),CloudAPI.events={},CloudAPI.events.listeners={},CloudAPI.events.names=["CAMERA_INFO_CHANGED"],CloudAPI.events.on=function(e,t,o){-1!=CloudAPI.events.names.indexOf(e)?(CloudAPI.events.listeners[e]||(CloudAPI.events.listeners[e]={}),CloudAPI.events.listeners[e][t]=o):console.error("[CLOUDAPI] Could not find event with name "+e)},CloudAPI.events.off=function(e,t){-1!=CloudAPI.events.names.indexOf(e)&&CloudAPI.events.listeners[e]?CloudAPI.events.listeners[e][t]?delete CloudAPI.events.listeners[e][t]:console.error("[CLOUDAPI] Could not find event with name "+e+" by id "+t):console.error("[CLOUDAPI] Could not find event with name "+e)},CloudAPI.events.trigger=function(e,o){if(-1!=CloudAPI.events.names.indexOf(e)){if(CloudAPI.events.listeners[e]){var r=CloudAPI.events.listeners[e];setTimeout(function(){for(var t in r)try{r[t](o)}catch(e){console.error("[CLOUDAPI] error on execute callback event ("+t+")",e)}},1)}}else console.error("[CLOUDAPI] Could not find event with name "+e)},window.CloudReturnCode={},CloudReturnCode.OK={name:"OK",code:-5049,text:"Success"},CloudReturnCode.OK_COMPLETIONPENDING={name:"OK_COMPLETIONPENDING",code:1,text:"Operation Pending"},CloudReturnCode.ERROR_NOT_CONFIGURED={name:"ERROR_NOT_CONFIGURED",code:-2,text:"Object not configured"},CloudReturnCode.ERROR_NOT_IMPLEMENTED={name:"ERROR_NOT_IMPLEMENTED",code:-1,text:"Function not implemented"},CloudReturnCode.ERROR_NO_MEMORY={name:"ERROR_NO_MEMORY",code:-12,text:"Out of memory"},CloudReturnCode.ERROR_ACCESS_DENIED={name:"ERROR_ACCESS_DENIED",code:-13,text:"Access denied"},CloudReturnCode.ERROR_BADARGUMENT={name:"ERROR_BADARGUMENT",code:-22,text:"Invalid argument"},CloudReturnCode.ERROR_STREAM_UNREACHABLE={name:"ERROR_STREAM_UNREACHABLE",code:-5049,text:"The stream specified is not reachable. Please check source URL or restart the stream"},CloudReturnCode.ERROR_EXPECTED_FILTER={name:"ERROR_EXPECTED_FILTER",code:-5050,text:"Expected filter"},CloudReturnCode.ERROR_NO_CLOUD_CONNECTION={name:"ERROR_NO_CLOUD_CONNECTION",code:-5051,text:"No cloud connection (has not conenction object or token is invalid)"},CloudReturnCode.ERROR_WRONG_RESPONSE={name:"ERROR_WRONG_RESPONSE",code:-5052,text:"Response from cloud expected in json, but got something else"},CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED={name:"ERROR_SOURCE_NOT_CONFIGURED",code:-5053,text:"Source not configured"},CloudReturnCode.ERROR_INVALID_SOURCE={name:"ERROR_INVALID_SOURCE",code:-5054,text:"Invalid source"},CloudReturnCode.ERROR_RECORDS_NOT_FOUND={name:"ERROR_RECORDS_NOT_FOUND",code:-5055,text:"Records are not found"},CloudReturnCode.ERROR_STREAM_UNREACHABLE_HLS={name:"ERROR_STREAM_UNREACHABLE_HLS",code:-5056,text:"The stream specified is not reachable (HLS)."},CloudReturnCode.ERROR_NOT_FOUND_HLS_PLUGIN={name:"ERROR_NOT_FOUND_HLS_PLUGIN",code:-5057,text:"HLS plugin not found."},CloudReturnCode.ERROR_COULD_NOT_DECODE_STREAM_OR_COULD_NOT_SET_COOKIE_HLS={name:"ERROR_COULD_NOT_DECODE_STREAM_OR_COULD_NOT_SET_COOKIE_HLS",code:-5058,text:"Could not decode stream or could not set cookie for streaming server (please allow cookie)."},CloudReturnCode.ERROR_WEBRTC_SERVER_ERROR={name:"ERROR_WEBRTC_SERVER_ERROR",code:-5059,text:"Unable to connect to server. Please check that you added an exception for the certificate, and that the port is available."},CloudReturnCode.ERROR_CAMERA_OFFLINE={name:"ERROR_CAMERA_OFFLINE",code:-5060,text:"Video source is offline"},CloudReturnCode.PLAYER_NOT_SUPPORTED={name:"PLAYER_NOT_SUPPORTED",code:-5061,text:"Player not supported"},CloudReturnCode.NOT_SUPPORTED_FORMAT={name:"NOT_SUPPORTED_FORMAT",code:-5062,text:"Not supported format"},CloudReturnCode.ERROR_HLS_ENDED={name:"ERROR_HLS_ENDED",code:-5063,text:"The stream is ended (HLS)."},CloudReturnCode.ERROR_INVALID_ACCESS_TOKEN_FORMAT={name:"ERROR_INVALID_ACCESS_TOKEN_FORMAT",code:-5064,text:"Invalid access token format"},CloudReturnCode.ERROR_CHANNEL_NOT_FOUND={name:"ERROR_CHANNEL_NOT_FOUND",code:-5065,text:"Channel is not found"},CloudReturnCode.ERROR_NETWORK_ERROR={name:"ERROR_NETWORK_ERROR",code:-5066,text:"Network error"},CloudReturnCode.ERROR_ACCESS_TOKEN_REQUIRED={name:"ERROR_ACCESS_TOKEN_REQUIRED",code:-5067,text:"Access token is required"},CloudReturnCode.ERROR_NOT_AUTHORIZED={name:"ERROR_NOT_AUTHORIZED",code:-5401,text:"Failed authorization on cloud (wrong credentials)"},CloudReturnCode.ERROR_NOT_FOUND={name:"ERROR_NOT_FOUND",code:-5404,text:"Not found object"},window.CloudCameraPrivacyFilter={},CloudCameraPrivacyFilter.PS_OWNER_NOT_PUBLIC={name:"PS_OWNER_NOT_PUBLIC",code:0,text:"My cameras which not public"},CloudCameraPrivacyFilter.PS_OWNER={name:"PS_OWNER",code:1,text:"Only my cameras"},CloudCameraPrivacyFilter.PS_PUBLIC_NOT_OWNERS={name:"PS_PUBLIC_NOT_OWNERS",code:2,text:"Public cameras exclude my"},CloudCameraPrivacyFilter.PS_PUBLIC={name:"PS_PUBLIC",code:3,text:"All public cameras"},CloudCameraPrivacyFilter.PS_OWNERS_PUBLIC={name:"PS_OWNERS_PUBLIC",code:4,text:"My public cameras"},CloudCameraPrivacyFilter.PS_ALL={name:"PS_ALL",code:5,text:"All cameras"},window.CloudCameraRecordingMode={},CloudCameraRecordingMode.CONTINUES={name:"CONTINUES",code:0},CloudCameraRecordingMode.BY_EVENT={name:"BY_EVENT",code:1},CloudCameraRecordingMode.NO_RECORDING={name:"NO_RECORDING",code:2},window.CloudCameraStatus={},CloudCameraStatus.ACTIVE={name:"ACTIVE",code:0},CloudCameraStatus.UNAUTHORIZED={name:"UNAUTHORIZED",code:1},CloudCameraStatus.INACTIVE={name:"INACTIVE",code:2},CloudCameraStatus.INACTIVE_BY_SCHEDULER={name:"INACTIVE_BY_SCHEDULER",code:3},CloudCameraStatus.OFFLINE={name:"OFFLINE",code:4},window.CloudTrialConnection=function(){var n=this;n.mAPI=null,n.AccountProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//cnvrclient2.videoexpertsgroup.com/",n.setAccpUrl=function(e){n.AccountProviderUrl=e},n.setSvcpUrlBase=function(e){n.ServiceProviderUrl=e},n.setApiConfig=function(e,t,o){n.ApiHost=e,n.ApiPort=t,n.ApiSecurePort=o},n.setCamConfig=function(e,t,o){n.CamHost=e,n.CamPort=t,n.CamSecurePort=o},n.open=function(e){var t=CloudHelpers.promise();return n.TrialKey=e,n.RequestData={username:n.TrialKey,password:n.TrialKey,cloud_token:!0},n._asyncLogin(t),t},n.isOpened=function(){return null!=n.mAPI},n.close=function(){n.mAPI=null},n._getAPI=function(){return n.mAPI},n.getUserInfo=function(){var r=CloudHelpers.promise();return n.isOpened()?n.mAPI.getAccountInfo().done(function(o){n.mAPI.getAccountCapabilities().done(function(e){var t=new CloudUserInfo(n,o,e);r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},n.getServerTimeDiff=function(){return n.mAPI.diffServerTime},n._asyncLogin=function(o){CloudHelpers.request({url:n.AccountProviderUrl+"api/v1/account/login/",type:"POST",data:JSON.stringify(n.RequestData),contentType:"application/json"}).done(function(e){if(e.cloud_token&&e.cloud_token.token){var t=CloudHelpers.parseUri(e.svcp_auth_app_url).host;t=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+t+"/",n.mAPI=new CloudAPI(e.cloud_token,n.ServiceProviderUrl||t),n.mAPI.getServerTime().done(function(){o.resolve()}).fail(function(e){o.reject(e)})}else console.warn("Try again after 1 sec"),setTimeout(function(){n._asyncLogin(o)},1e3)}).fail(function(e){console.error(e),o.reject(e)})}},window.CloudTokenConnection=function(e){var a=this;a.mAPI=null,a.options=e,a.ServiceProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+(a.options.cloud_domain?a.options.cloud_domain:"web.skyvr.videoexpertsgroup.com")+"/",a.open=function(e,t,o){var r={token:e,expire:t,type:"api"};o&&(a.ServiceProviderUrl=o);var n=CloudHelpers.promise();return a.mAPI=new CloudAPI(r,a.ServiceProviderUrl),a.mAPI.getServerTime().done(function(){n.resolve()}).fail(function(e){n.reject(e)}),n},a.isOpened=function(){return null!=a.mAPI},a.close=function(){a.mAPI=null},a._getAPI=function(){return a.mAPI},a.getUserInfo=function(){var r=CloudHelpers.promise();return a.isOpened()?a.mAPI.getAccountInfo().done(function(o){a.mAPI.getAccountCapabilities().done(function(e){console.warn("caps:",e);var t=new CloudUserInfo(a,o,e);r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},a.getServerTimeDiff=function(){return a.mAPI.diffServerTime}},window.CloudShareConnection=function(e){var n=this;n.options=e,n.mAPI=null,n.ServiceProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+(n.options.cloud_domain?n.options.cloud_domain:"web.skyvr.videoexpertsgroup.com")+"/",n.open=function(e){var t={token:e,expire:"",type:"share"},o=CloudHelpers.promise();return n.mAPI=new CloudAPI(t,n.ServiceProviderUrl),n.mAPI.getServerTime().done(function(){o.resolve()}).fail(function(e){o.reject(e)}),o},n.isOpened=function(){return null!=n.mAPI},n.close=function(){n.mAPI=null},n._getAPI=function(){return n.mAPI},n.getUserInfo=function(){var r=CloudHelpers.promise();return n.isOpened()?n.mAPI.getAccountInfo().done(function(o){n.mAPI.getAccountCapabilities().done(function(e){console.warn("caps:",e);var t=new CloudUserInfo(n,o,e);r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},n.getServerTimeDiff=function(){return n.mAPI.diffServerTime}},window.CloudUserConnection=function(){var r,n,a=this;a.mAPI=null,a.AccountProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//cnvrclient2.videoexpertsgroup.com/",a.open=function(e,t){r=e,n=t;var o=CloudHelpers.promise();return a.RequestData={username:r,password:n,cloud_token:!0},a._asyncLogin(o),o},a.isOpened=function(){return null!=a.mAPI},a.close=function(){a.mAPI=null},a._getAPI=function(){return a.mAPI},a.getUserInfo=function(){var r=CloudHelpers.promise();return a.isOpened()?a.mAPI.getAccountInfo().done(function(o){a.mAPI.getAccountCapabilities().done(function(e){console.warn("caps:",e);var t=new CloudUserInfo(a,o,e);r.resolve(t)}).fail(function(e){if(500==e.status){var t=new CloudUserInfo(a,o);r.resolve(t)}else CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},a.getServerTimeDiff=function(){return a.mAPI.diffServerTime},a._asyncLogin=function(o){CloudHelpers.request({url:a.AccountProviderUrl+"api/v1/account/login/",type:"POST",data:JSON.stringify(a.RequestData),contentType:"application/json"}).done(function(e){if(e.cloud_token&&e.cloud_token.token){var t=CloudHelpers.parseUri(e.svcp_auth_app_url).host;t=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+t+"/",a.mAPI=new CloudAPI(e.cloud_token,t),a.mAPI.getServerTime().done(function(){o.resolve()}).fail(function(e){o.reject(e)})}else console.warn("Try again after 1 sec"),setTimeout(function(){a._asyncLogin(o)},1e3)}).fail(function(e){console.error(e),o.reject(e)})}},window.CloudUserInfo=function(e,t,o){var r,n,a,i,s,l,c,u,d,m=this,f=e;function p(e,t){n=t,a=(r=e).id,i=e.email,s=e.first_name,l=e.last_name,c=e.preferred_name,t?(u=t.cameras_creation.limits.total_cameras,t.cameras_creation.limits.hosted_cameras,d=t.cameras_creation.created.total_cameras,t.cameras_creation.created.hosted_cameras):d=u=0}p(t,o),m._getConn=function(){return f},m._origJsonAccount=function(){return r},m._origJsonCapabilities=function(){return n},m.getID=function(){return a},m.getEmail=function(){return i},m.getFirstName=function(){return s},m.getLastName=function(){return l},m.getPreferredName=function(){return c},m.getCameraLimit=function(){return u},m.getCameraCreated=function(){return d},m.refresh=function(){var o=CloudHelpers.promise();return f&&f.isOpened()?f._getAPI().getAccountInfo().done(function(t){f._getAPI().getAccountCapabilities().done(function(e){p(t,e),o.resolve()}).fail(function(e){500==e.status?p(t):CloudHelpers.handleError(e,o)})}).fail(function(e){CloudHelpers.handleError(e,o)}):o.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),o}},window.CloudCamera=function(e,t){var o=this;o.type="camera";var r,n,a,i,s,l,c,u,d,m,f,p,h,g,v,C,y,_,A,P=e,E=t.id,T=t.cmngrid;function S(e){a=(r=e).login,i=e.password,n=e.url,m=e.name,l=e.timezone,s=e.status,c=e.latitude,u=e.longitude,f=e.rec_mode,p="on"==e.rec_status,d=e.delete_at,h=e.brand,g=e.group_name,v=e.fw_version,y=e.model,e.serial_number,_=e.uuid,C=e.led,A=!!e.public&&e.public}var w={};S(t),o._getConn=function(){return console.log("mConn = "+P),P},o._origJson=function(){return r},o.getID=function(){return E},o.getRecStatus=function(){console.warn("TODO")},o.hasPTZ=function(){console.warn("TODO")},o.getURL=function(){return n},o.setURL=function(e){n=e,w.url=e},o.getURLLogin=function(){return a},o.setURLLogin=function(e){a=e,w.login=e},o.getURLPassword=function(){return i},o.setURLPassword=function(e){i=e,w.password=e},o.getDeleteAt=function(){return d},o.getTimezone=function(){return l},o.setTimezone=function(e){l=e,w.timezone=e},o.isPublic=function(){return A},o.setPublic=function(e){A=e,w.public=e},o.getStatus=function(){var e=s.toUpperCase();return CloudCameraStatus[e]?CloudHelpers.copy(CloudCameraStatus[e]):(console.error("Unknown camera status"),null)},o.getName=function(){return m},o.setName=function(e){m=e,w.name=e},o.getLatitude=function(){return c},o.setLatitude=function(e){c=e,w.latitude=e},o.getLongitude=function(){return u},o.setLongitude=function(e){u=e,w.longitude=e},o.isRecording=function(){return p},o.getCameraManagerID=function(){return T},o.getBrand=function(){return h},o.getGroupName=function(){return g},o.getFirmwareVersion=function(){return v},o.getModel=function(){return y},o.getUUID=function(){return _},o.getLed=function(){return C},o.setRecordingMode=function(e){e.name==CloudCameraRecordingMode.CONTINUES.name?w.rec_mode="on":e.name==CloudCameraRecordingMode.BY_EVENT.name?w.rec_mode="by_event":e.name==CloudCameraRecordingMode.NO_RECORDING.name?w.rec_mode="off":console.error("[CloudCamera] Unknown mode of recording")},o.getRecordingMode=function(){return"on"==f?CloudHelpers.copy(CloudCameraRecordingMode.CONTINUES):"by_event"==f?CloudHelpers.copy(CloudCameraRecordingMode.BY_EVENT):"off"==f?CloudHelpers.copy(CloudCameraRecordingMode.NO_RECORDING):void console.error("[CloudCamera] Unknown mode of recording")},o.save=function(){var t=CloudHelpers.promise();return P._getAPI().updateCamera(E,w).done(function(e){S(e),w.timezone?P._getAPI().updateCameraManager(T,{timezone:w.timezone}).done(function(){l=w.timezone,w={},t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}):(w={},t.resolve())}).fail(function(e){CloudHelpers.handleError(e,t)}),t},o.getPreview=function(){var o=CloudHelpers.promise();if(!P||!P.isOpened())return o.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),o;var r=P._getAPI().diffServerTime;return P._getAPI().cameraPreview(E).done(function(t){console.log(t);var e=CloudHelpers.parseUTCTime(t.time);curr_time=CloudHelpers.getCurrentTimeUTC()+r,60<(curr_time-e)/1e3?P._getAPI().cameraUpdatePreview(E).done(function(e){o.resolve(t.url)}).fail(function(e){CloudHelpers.handleError(e,o)}):o.resolve(t.url)}).fail(function(e){CloudHelpers.handleError(e,o)}),o},o.getTimeline=function(a,i){var s=CloudHelpers.promise();if(!P||!P.isOpened())return s.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),s;var e=CloudHelpers.formatUTCTime(a),t=CloudHelpers.formatUTCTime(i);return P._getAPI().storageTimeline(E,e,t,4).done(function(e){var t={};t.start=a,t.end=i,t.periods=[];var o=e.objects[0][4];for(var r in o){var n={};n.start=CloudHelpers.parseUTCTime(o[r][0]),n.end=n.start+1e3*o[r][1],t.periods.push(n)}s.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,s)}),s},o.getTimelineDays=function(e){var r=CloudHelpers.promise();return P&&P.isOpened()?P._getAPI().storageActivity(E,e).done(function(e){var t=[];for(var o in e.objects)t.push(CloudHelpers.parseUTCTime(e.objects[o]+"T00:00:00"));r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},o.getCameraUsage=function(){var t=CloudHelpers.promise();return P&&P.isOpened()?P._getAPI().cameraUsage(E).done(function(e){t.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t};var b="COMMON_SHARING_TOKEN";function I(e){var t={};return t.token=e,t.camid=E,t.access="watch",P.ServiceProviderUrl&&(t.svcp=P.ServiceProviderUrl),P.ApiHost&&(t.api=P.ApiHost),P.ApiPort&&80!=P.ApiPort&&(t.api_p=P.ApiPort),P.ApiSecurePort&&443!=P.ApiSecurePort&&(t.api_sp=P.ApiSecurePort),CloudHelpers.base64_encode(JSON.stringify(t))}o.enableSharing=function(){var n=CloudHelpers.promise();return P&&P.isOpened()?P._getAPI().getCameraSharingTokensList(E).done(function(e){var t=!1;for(var o in e.objects){var r=e.objects[o];if(r.name==b)return t=!0,void(1==r.enabled?n.resolve(I(r.token)):P._getAPI().updateCameraSharingToken(E,r.id,{enabled:!0}).done(function(e){n.resolve(I(r.token))}).fail(function(e){CloudHelpers.handleError(e,n)}))}t||P._getAPI().creareCameraSharingToken(E,b,["live","play","clipsplay"]).done(function(e){n.resolve(I(e.token))}).fail(function(e){CloudHelpers.handleError(e,n)})}).fail(function(e){CloudHelpers.handleError(e,n)}):n.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),n},o.disableSharing=function(e){var r=CloudHelpers.promise();return P&&P.isOpened()?P._getAPI().getCameraSharingTokensList(E).done(function(e){for(var t in e.objects){var o=e.objects[t];if(o.name==b)return!0,void P._getAPI().updateCameraSharingToken(E,o.id,{enabled:!1}).done(function(e){console.log(e),r.resolve()}).fail(function(e){CloudHelpers.handleError(e,r)})}r.reject()}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r};var R="COMMON_SHARING_TOKEN_FOR_STREAM";function k(e){var t={};return t.token=e,t.camid=E,t.cmngrid=T,t.access="all",t.api_p=80,t.api_sp=443,t.cam="cam.skyvr.videoexpertsgroup.com",t.cam_p=8888,t.cam_sp=8883,P.ServiceProviderUrl&&(t.svcp=P.ServiceProviderUrl),P.ApiHost&&(t.api=P.ApiHost),P.ApiPort&&80!=P.ApiPort&&(t.api_p=P.ApiPort),P.ApiSecurePort&&443!=P.ApiSecurePort&&(t.api_sp=P.ApiSecurePort),P.CamHost&&(t.cam=P.CamHost),P.CamPort&&(t.cam_p=P.CamPort),P.CamSecurePort&&(t.cam_sp=P.CamSecurePort),CloudHelpers.base64_encode(JSON.stringify(t))}o.enableSharingForStream=function(){var n=CloudHelpers.promise();return P&&P.isOpened()?P._getAPI().getCameraSharingTokensList(E).done(function(e){var t=!1;for(var o in e.objects){var r=e.objects[o];if(r.name==R)return t=!0,void(1==r.enabled?n.resolve(k(r.token)):P._getAPI().updateCameraSharingToken(E,r.id,{enabled:!0}).done(function(e){n.resolve(k(r.token))}).fail(function(e){CloudHelpers.handleError(e,n)}))}t||P._getAPI().creareCameraSharingToken(E,R,["all"]).done(function(e){n.resolve(k(e.token))}).fail(function(e){CloudHelpers.handleError(e,n)})}).fail(function(e){CloudHelpers.handleError(e,n)}):n.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),n},o.getStreamingURL=function(){var t=CloudHelpers.promise();return P&&P.isOpened()?P._getAPI().getCameraStreamingURLs(E).done(function(e){t.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t},o.setPublishPassword=function(e){w.publish_password=e}},window.CloudCameraListFilter=function(){var n=this;n.filterParams={detail:"detail",limit:50},n.setLimit=function(e){n.filterParams.limit=e},n.setOffset=function(e){n.filterParams.offset=e},n.setName=function(e){void 0!==e?n.filterParams.name=e:delete n.filterParams.name},n.setPartOfName=function(e){void 0!==e?n.filterParams.name__icontains=e:delete n.filterParams.name__icontains},n.sortByName=function(e){n.filterParams.order_by=(e?"-":"")+"name"},n.sortByDate=function(e){n.filterParams.order_by=(e?"-":"")+"created"},n.setOwner=function(e){console.warn("setPublic is deprecated"),void 0!==e?n.filterParams.is_owner=e:delete n.filterParams.is_owner},n.setPublic=function(e){console.warn("setPublic is deprecated"),void 0!==e?n.filterParams.public=e:delete n.filterParams.public},n.setForStream=function(e){void 0!==e&&void 0!==e?n.filterParams.url__isnull=e:delete n.filterParams.url__isnull},n.setPrivacy=function(e){void 0!==e&&e.name?"PS_OWNER_NOT_PUBLIC"==e.name?(n.filterParams.public=!1,n.filterParams.is_owner=!0):"PS_OWNER"==e.name?(delete n.filterParams.public,n.filterParams.is_owner=!0):"PS_PUBLIC_NOT_OWNERS"==e.name?(n.filterParams.public=!0,n.filterParams.is_owner=!1):"PS_PUBLIC"==e.name?(n.filterParams.public=!0,delete n.filterParams.is_owner):"PS_OWNERS_PUBLIC"==e.name?(n.filterParams.public=!0,n.filterParams.is_owner=!0):("PS_ALL"==e.name||console.error("Unknown privacy filter"),delete n.filterParams.public,delete n.filterParams.is_owner):(console.error("Unknown privacy filter"),delete n.filterParams.public,delete n.filterParams.is_owner)},n.setURL=function(e){void 0!==e?n.filterParams.url=e:delete n.filterParams.url},n.setLatLngBounds=function(e,t,o,r){console.warn("[CloudCamerasListFilter] SetLatLngBounds, TODO test -1 < lat,lang < 1"),e<=t&&(n.filterParams.latitude__gte=e,n.filterParams.latitude__lte=t),o<=r&&(n.filterParams.longitude__gte=o,n.filterParams.longitude__lte=r)},n._values=function(){return n.filterParams}},window.CloudCameraList=function(e){var i=this,s=e;i.getCamera=function(e){var t=CloudHelpers.promise();return s&&s.isOpened()?s._getAPI().getCamera(e).done(function(e){t.resolve(new CloudCamera(s,e))}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t},i.createCamera=function(e,t,o){var r=CloudHelpers.promise();if(!s||!s.isOpened())return r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r;var n={url:e,login:t,password:o};return s._getAPI().createCamera(n).done(function(e){r.resolve(new CloudCamera(s,e))}).fail(function(e){CloudHelpers.handleError(e,r)}),r},i.createCameraForStream=function(){var t=CloudHelpers.promise();if(!s||!s.isOpened())return t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t;return s._getAPI().createCamera({}).done(function(e){t.resolve(new CloudCamera(s,e))}).fail(function(e){CloudHelpers.handleError(e,t)}),t},i.findOrCreateCamera=function(e){var n=CloudHelpers.promise(),t=new CloudCameraListFilter;t.setOwner(!0);var a=CloudHelpers.splitUserInfoFromURL(e);return t.setURL(a.url),a.login=a.login||"",s._getAPI().camerasList(t._values()).done(function(e){var t=!1;for(var o in e.objects){var r=e.objects[o];if(r.login=r.login||"",r.login==a.login){t=!0,n.resolve(new CloudCamera(s,r));break}}t||i.createCamera(a.url,a.login,a.password).done(function(e){n.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,n)})}).fail(function(e){CloudHelpers.handleError(e,n)}),n},i.getCameraList=function(e){var r=CloudHelpers.promise();return(e=e||new CloudCameraListFilter)._values?s&&s.isOpened()?s._getAPI().camerasList(e._values()).done(function(e){var t=[];for(var o in e.objects)t.push(new CloudCamera(s,e.objects[o]));r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION):(console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),r.reject(CloudReturnCode.ERROR_EXPECTED_FILTER)),r},i.getCameraListLight=function(e){var t=CloudHelpers.promise();if(!(e=e||new CloudCameraListFilter)._values)return console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),t.reject(CloudReturnCode.ERROR_EXPECTED_FILTER),t;if(!s||!s.isOpened())return t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t;var o=e._values();return delete filterMap.detail,s._getAPI().camerasList(o).done(function(e){t.resolve(e.objects)}).fail(function(e){CloudHelpers.handleError(e,t)}),t},i.deleteCamera=function(e){var t=CloudHelpers.promise();return s&&s.isOpened()?s._getAPI().deleteCamera(e).done(function(){t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t}},window.CloudSession=function(e,t){var o=this;o.type="session";var r,n,a,i,s,l,c,u,d,m,f,p,h,g,v,C,y,_=e,A=t.id,P=0,E=0,T=0;function S(e){n=(r=e).active,a=e.title,e.preview&&(i=e.preview.url),e.live_urls&&(v=e.live_urls.rtmp,C=e.live_urls.hls,y=e.live_urls.expire),c=e.latitude,u=e.longitude,s=e.streaming,l=e.public,d=e.start,m=e.end,f=e.has_records,e.statistics&&(E=e.statistics.peak_live||0,T=e.statistics.playback||0,P=e.statistics.live||0),g=e.author?e.author.preferred_name:"unknown",e.access&&(p=-1!=e.access.indexOf("all"),h=-1!=e.access.indexOf("watch"))}i="";S(t),o._getConn=function(){return _},o._origJson=function(){return r},o.hasAccessAll=function(){return p},o.hasAccessWatch=function(){return p||h},o.getID=function(){return A},o.isOnline=function(){return n},o.getTitle=function(){return a},o.getAuthorPreferredName=function(){return g},o.getStatisticsLive=function(){return P},o.getStatisticsPeakLive=function(){return E},o.getStatisticsPlayback=function(){return T},o.getStartTime=function(){return null==d?(console.error("[CloudSession] #"+A+" Start time is null"),0):CloudHelpers.parseUTCTime(d)},o.getEndTime=function(){return null==d?(console.error("[CloudSession] #"+A+" End time is null but session is mActive: "+n),0):CloudHelpers.parseUTCTime(m)},o.getPreview=function(){return i},o.getLatitude=function(){return c},o.getLongitude=function(){return u},o.isStreaming=function(){return s},o.isPublic=function(){return l},o.hasRecords=function(){return f},o.getLiveUrl_Rtmp=function(){return v},o.getLiveUrl_HLS=function(){return C},o.getLiveUrl_Expire=function(){return y},o.refresh=function(){var t=CloudHelpers.promise();return _._getAPI().getCamsess(A).done(function(e){S(e),t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}),t}},window.CloudSessionListFilter=function(){var n=this;n.filterParams={limit:50,order_by:"-start"},n.setLimit=function(e){n.filterParams.limit=e},n.setOffset=function(e){n.filterParams.offset=e},n.setTitle=function(e){n.filterParams.title__icontains=e},n.setStartLessThen=function(e){n.filterParams.start__lte=e},n.setHasRecords=function(e){"any"==e||("yes"==e?(n.filterParams.has_records=!0,n.filterParams.active=!1):"no"==e?(n.filterParams.has_records=!1,n.filterParams.active=!1):console.error("[CloudSessionListFilter] setHasRecords, expected 'any', 'yes' or 'no'"))},n.setStreaming=function(e){"any"==e||("yes"==e?(n.filterParams.streaming=!0,n.filterParams.camera_online=!0,n.filterParams.active=!0):"no"==e?(n.filterParams.streaming=!1,delete n.filterParams.camera_online,n.filterParams.active=!1):console.error("[CloudSessionListFilter] setStreaming, expected 'any', 'yes' or 'no'"))},n.setAuthorName=function(e){n.filterParams.author_name__icontains=e},n.setAuthorID=function(e){e?n.filterParams.author_id=e:delete n.filterParams.author_id},n.setAuthorPreferredName=function(e){e?n.filterParams.author_preferred_name__icontains=e:delete n.filterParams.author_preferred_name__icontains},n.setWithDetails=function(){console.warn("[CloudSessionListFilter] 'setWithDetails' not supported anymore. Please use getSessionList or getSessionListLight")},n.setOnline=function(e){console.warn("[CloudSessionListFilter] 'setOnline' not supported anymore")},n.setPublic=function(e){"any"==e||("yes"==e?n.filterParams.public=!0:"no"==e?n.filterParams.public=!1:console.error("[CloudSessionListFilter] setOnline, expected 'any', 'yes' or 'no'"))},n.setLatLngBounds=function(e,t,o,r){e<=t?(n.filterParams.latitude__gte=e,n.filterParams.latitude__lte=t):console.error("[CloudCamerasListFilter] latitude_max must be greater or equal to latitude_min"),o<=r?(n.filterParams.longitude__gte=o,n.filterParams.longitude__lte=r):console.error("[CloudCamerasListFilter] longitude_max must be greater or equal to longitude_min")},n._values=function(){var e={};for(var t in n.filterParams)e[t]=n.filterParams[t];return e}},window.CloudSessionList=function(e){var n=e;this.getSession=function(e){var t=CloudHelpers.promise();return n&&n.isOpened()?n._getAPI().getCamsess(e).done(function(e){t.resolve(new CloudSession(n,e))}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t},this.getSessionList=function(e){var r=CloudHelpers.promise();if(!(e=e||new CloudSessionListFilter)._values)return console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),r.reject(CloudReturnCode.ERROR_EXPECTED_FILTER),r;if(!n||!n.isOpened())return r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r;var t=e._values();return t.detail="detail",n._getAPI().getCamsessList(t).done(function(e){var t=[];for(var o in e.objects)t.push(new CloudSession(n,e.objects[o]));r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)}),r},this.getSessionListLight=function(e){var t=CloudHelpers.promise();if(!(e=e||new CloudSessionListFilter)._values)return console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),t.reject(CloudReturnCode.ERROR_EXPECTED_FILTER),t;if(!n||!n.isOpened())return t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t;var o=e._values();return delete o.detail,n._getAPI().getCamsessList(o).done(function(e){t.resolve(e.objects)}).fail(function(e){CloudHelpers.handleError(e,t)}),t},this.deleteSession=function(e){var t=CloudHelpers.promise();return n&&n.isOpened()?n._getAPI().deleteCamsess(e).done(function(){t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t}},window.CloudPlayerEvent={},CloudPlayerEvent.CONNECTING={name:"CONNECTING",code:0,text:"Connection is establishing"},CloudPlayerEvent.CONNECTED={name:"CONNECTED",code:1,text:"Connection is established"},CloudPlayerEvent.PLAYED={name:"PLAYED",code:2,text:"Player changes state to PLAY."},CloudPlayerEvent.PAUSED={name:"PAUSED",code:3,text:"Player state is PAUSE."},CloudPlayerEvent.CLOSED={name:"CLOSED",code:6,text:"Player state is CLOSED."},CloudPlayerEvent.SEEK_COMPLETED={name:"SEEK_COMPLETED",code:17,text:"setPosition() is successfully finished."},CloudPlayerEvent.ERROR={name:"ERROR",code:105,text:"Player is disconnected from media stream due to an error"},CloudPlayerEvent.SOURCE_CHANGED={name:"SOURCE_CHANGED",code:3e3,text:"setSource() is successfully finished."},CloudPlayerEvent.POSITION_JUMPED={name:"POSITION_JUMPED",code:3001,text:"Position was changed by player (possible that player did not found records)."},CloudPlayerEvent.RANGE_ENDED={name:"RANGE_ENDED",code:4455,text:"The player reached the end of the range when playing"},CloudPlayerEvent.CHANNEL_STATUS={name:"CHANNEL_STATUS",code:4456,text:"When channel status"},CloudPlayerEvent.USER_CLICKED_ON_TIMELINE={name:"USER_CLICKED_ON_TIMELINE",code:4457,text:"When user click on timeline."},CloudPlayerEvent.CHANGED_CONTROLS={name:"CHANGED_CONTROLS",code:4458,text:"Event when controls changes"},CloudPlayerEvent.TIMELINE_END_UPDATED={name:"TIMELINE_END_UPDATED",code:4459,text:"Event when timeline end updated"},window._cloudPlayers=window._cloudPlayers||{},window.CloudPlayer=function(a,e){var g=this;g.options=e=e||{},g.elid=a;var u=null,r=null,t=!0,n=0,i=!0,s=!1,l=!1,d=CloudHelpers.createCallbacks(),c="",m=null,f=null,p=null,h=null,v=null,C=null,y=null,_=!1,A=null,o=null,P=null,E=null,T=null,S=null,w=null,b=!0,I=0;if(g.timePolingLiveUrls=15e3,g.player=document.getElementById(a),_cloudPlayers[a])return _cloudPlayers[a];var R=null,k=null,O=-1,M=-1,D={w:0,h:0};if(CloudHelpers.isChrome()&&!CloudHelpers.isMobile()?(videojs.options.hls=videojs.options.hls||{},videojs.options.html5.nativeAudioTracks=!0,videojs.options.html5.nativeVideoTracks=!1,videojs.options.hls.overrideNative=!1):(videojs.options.hls=videojs.options.hls||{},videojs.options.html5.nativeAudioTracks=!1,videojs.options.html5.nativeVideoTracks=!1,videojs.options.hls.overrideNative=!0),videojs.options.hls.enableLowInitialPlaylist=!0,null==g.player)return console.error("[CloudPlayer] Not found element"),null;if("DIV"!=g.player.tagName)return console.error("[CloudPlayer] Expected DIV tag but got "+g.player.tagName),null;var N=-1,L=0,x=2e3,U=5e3,H=null,j=null;g.m={},g.m.mute=!1,g.m.waitSourceActivation=e.waitSourceActivation||0,g.m.useTimezone=e.useTimezone,g.m.useTimezone&&console.warn("[CloudPlayer] useTimezone: "+g.m.useTimezone),g.m.waitSourceActivation<0&&(console.warn("[CloudPlayer] option waitSourceActivation must be greater than -1"),g.m.waitSourceActivation=0),g.m.useNativeHLS=e.useNativeHLS||!1,g.m.backwardAudio=!1,g.m.backwardAudio=e.backwardAudio||null!=g.player.getAttribute("backward-audio")||g.m.backwardAudio,g.defualtAutohide=CloudHelpers.isMobile()?0:3e3,void 0!==e.autohide?g.m.autohide=e.autohide:g.m.autohide=g.defualtAutohide,e.trasholdPlaybackInMs&&(I=e.trasholdPlaybackInMs,console.log("[CloudPlayer] applied option trasholdPlaybackInMs "+e.trasholdPlaybackInMs)),g.mPlayerFormat="html5";var z="";if(e.preferredPlayerFormat)g.mPreferredPlayerFormat=e.preferredPlayerFormat,z=e.preferredPlayerFormat;else try{z=localStorage.getItem("preferred_player_format")}catch(e){console.error("[CloudPlayer] error load format: ",e)}if("webrtc"==z||"html5"==z||"flash"==z?g.mPlayerFormat=z:console.warn("[CloudPlayer] Unknown player format: ",z,", html5 is used by default"),e.useOnlyPlayerFormat){var F=e.useOnlyPlayerFormat;if("webrtc"!==F&&"html5"!==F&&"flash"!==F)console.error("Wrong value of useOnlyPlayerFormat, expected 'webrtc' or 'html5' or 'flash'");else{g.mPlayerFormat=F,E=F;try{localStorage.setItem("preferred_player_format",F)}catch(e){}}}void 0!==e.mute&&(g.m.mute=!0===e.mute),g.swf_backwardaudio="",g.player.classList.add("cloudplayer"),g.player.classList.add("green"),g.player.classList.add("black"),g.player.innerHTML='<div class="cloudplayer-loader" style="display: inline-block"></div><div class="cloudplayer-screenshot-loading" style="display: none">\t\t<div class="cloudplayer-screenshot-loading">     </div></div><div class="cloudplayer-error" style="display: none">\t<div class="cloudplayer-error-text" style="display: none"></div></div><div class="cloudplayer-ptz"><div class="ptz-controls">\t<div class="ptz-arrow ptz-top"></div>\t<div class="ptz-arrow ptz-right"></div>\t<div class="ptz-arrow ptz-bottom"></div>\t<div class="ptz-arrow ptz-left"></div><div class="ptz-zoom">\t<div class="ptz-zoom-plus"></div>\t<div class="ptz-zoom-minus"></div></div></div><div class="ptz-presets"><h4>Presets</h4><ul class="presets-list"><li data-presetNo="1">1</li><li data-presetNo="2">2</li><li data-presetNo="3">3</li><li data-presetNo="4">4</li><li data-presetNo="5">5</li></ul></div></div><div class="cloudplayer-controls-zoom-container"><div class="cloudplayer-controls-zoom-position">\t\t<div class="cloudplayer-zoom-position-cursor"></div></div><div class="cloudplayer-controls-zoom">\t<div class="cloudplayer-zoom-up"></div>\t<div class="cloudplayer-zoom-progress zoom10x"></div>\t<div class="cloudplayer-zoom-down"></div></div></div><div class="cloudplayer-watermark"></div><div class="cloudplayer-sdkversion">SDK '+CloudSDK.version+'</div><div class="cloudplayer-info"><div class="cloudplayer-info-main">\t\t<div class="cloudplayer-info-title">Settings</div>\t\t<div class="cloudplayer-info-container">\t\t<div class="cloudplayer-info-player-mode" style="'+(null!==E?"disabled":"")+'"> Preferred format: \t\t<div class="selected-format"></div></div>\t\t<div class="cloudplayer-info-player-dewarping enabled"  style="">Dewarping: \t\t<div class="selected-dewarping">Off</div></div>\t\t<div class="cloudplayer-info-player-speed enabled">Speed: \t\t<div class="selected-speed">1x</div></div>\t\t\x3c!-- div class="cloudplayer-info-latency">Player Latency: \t\t\t<div class="cloudplayer-info-latency-minimal">Minimal Latency</div>\t\t\t/  \t\t<div class="cloudplayer-info-latency-smoothless">Maximum Smoothness</div>\t\t</div --\x3e\t\t\x3c!-- div class="cloudplayer-info-latency-not-supported">Player Latency: Setting is not available for HTML5 player</div --\x3e\t\t<div class="cloudplayer-info-bufferlength"></div>\t\t<div class="cloudplayer-info-audio-stream">Audio stream: \t\t\t<div class="cloudplayer-info-audio-stream-on">On</div>\t\t\t/  \t\t<div class="cloudplayer-info-audio-stream-off">Off</div>\t\t</div>\t\t<div class="cloudplayer-info-playerversion">Version: '+CloudSDK.version+" ("+CloudSDK.datebuild+')</div>\t\t<div class="cloudplayer-info-playertype">Used player:</div></div></div><div class="cloudplayer-info-setting mode-select">\t\t<div class="cloudplayer-info-title"><span class="back"></span>Preferred format</div>\t\t<div class="cloudplayer-info-container">\t\t<div class="cloudplayer-player-mode cloudplayer-webrtc-mode" style="display: none">'+(e.alt_protocol_names?"Low latency":"WebRTC")+'</div> \t\t<div class="cloudplayer-player-mode cloudplayer-flash-mode selected">'+(e.alt_protocol_names?"Standard":"RTMP")+'</div> \t\t<div class="cloudplayer-player-mode cloudplayer-html5-mode">'+(e.alt_protocol_names?"Reliable":"HLS")+'</div>\t\t</div></div><div class="cloudplayer-info-setting dewarping-select">\t\t<div class="cloudplayer-info-title"><span class="back"></span>Dewarping</div>\t\t<div class="cloudplayer-info-container">\t\t\t<div class="cloudplayer-player-mode cloudplayer-dewarping-mode selected" data-dewarping="0">Off</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-dewarping-mode" data-dewarping="1">On</div>\t\t</div></div><div class="cloudplayer-info-setting speed-select">\t\t<div class="cloudplayer-info-title"><span class="back"></span>Speed</div>\t\t<div class="cloudplayer-info-container">\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="0.125">0.125x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="0.25">0.25x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="0.5">0.5x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode selected" data-speed="1">1x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="2">2x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="4">4x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="8">8x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="16">16x</div>\t\t</div></div></div><div class="cloudplayer-backwardaudio-container">'+(g.m.backwardAudio?'<object data="'+g.swf_backwardaudio+'" type="application/x-shockwave-flash" id="backwardaudio_swf_single" align="top">\t\t<param name="movie" value="'+g.swf_backwardaudio+'" />\t\t<embed type="application/x-shockwave-flash" src="'+g.swf_backwardaudio+'">\t\t<param name="allowScriptAccess" value="always"/>\t\t<param value="allowNetworking" value="all"/>\t\t<param name="menu" value="true" />\t\t<param name="wmode" value="transparent"/>\t\t\x3c!-- param name="bgcolor" value="#ffffff" / --\x3e\t\t<param name="menu" value="false" /></object>':"")+'</div><div class="cloudplayer-calendar-container"></div><div class="cloudplayer-live-container"></div><div class="cloudplayer-controls-container"><div class="cloudplayer-timeline-container"></div><div class="cloudplayer-controls">\t<div class="cloudplayer-play" style="display: none"></div>\t<div class="cloudplayer-stop" style="display: none"></div>\t<div class="cloudplayer-volume-mute"></div>\t<div class="cloudplayer-volume-container">\t<input type="range" min="0" max="100" step="1" data-buffer="0" id="volume" class="cloudplayer-volume" data-rangeSlider>\t<output></output></div>\t<div class="cloudplayer-time"></div>\t<div class="cloudplayer-volume-down"></div>\t<div class="cloudplayer-volume-progress vol7"></div>\t<div class="cloudplayer-volume-up"></div>\t<div class="cloudplayer-microphone"></div>\t<div class="cloudplayer-settings"></div>\t<div class="cloudplayer-show-zoom"></div>\t<div class="cloudplayer-show-ptz"></div>\t<div class="cloudplayer-fullscreen"></div></div></div><div class="cloudcameracalendar-content"></div><div class="cloudplayer-big-play-button" style="display: none"></div><div class="allvideotags" style="width:100%; height:100%;" ><video crossorigin="anonymous" id="'+a+'_vjs" class="video-js" preload="auto" class="video-js vjs-default-skin vjs-live" muted='+g.m.mute+' autoplay=true preload playsinline="true"></video><video crossorigin="anonymous" id="'+a+'_vjs2" class="video-js" preload="auto" class="video-js vjs-default-skin vjs-live" muted='+g.m.mute+' autoplay=true preload playsinline="true" ></video><video crossorigin="anonymous" id="'+a+'_nv1" class="cloudplayer-native-video" autoplay=true preload  playsinline="true" ></video><video crossorigin="anonymous" id="'+a+'_nv2" class="cloudplayer-native-video" autoplay=true preload  playsinline="true" ></video><video crossorigin="anonymous" id="'+a+'_native_hls" class="cloudplayer-native-hls" muted='+g.m.mute+' autoplay=true preload  playsinline="true" ></video><video crossorigin="anonymous" id="'+a+'_webrtc" class="cloudplayer-webrtc" muted='+g.m.mute+' preload  playsinline="true" ></video></div><div class="cloudplayer-black-screen" style="display: none">\t\t<div class="cloudplayer-watermark"></div>\t\t<div class="cloudplayer-sdkversion">SDK '+CloudSDK.version+"</div></div>",g.vjs=videojs(a+"_vjs",{controls:!1}),g.vjs2=videojs(a+"_vjs2",{controls:!1}).ready(function(){g.vjs2.el().style.display="none"}),g.vjs.on("error",function(e){if(ze(),null!=g.vjs.error()){var t=g.vjs.error();g.isLive()?4!=t.code||CloudHelpers.supportFlash()||CloudHelpers.isMobile()||"flash"!=g.mPlayerFormat?3==t.code&&CloudHelpers.isMobile()?g._showConsoleError(CloudReturnCode.ERROR_COULD_NOT_DECODE_STREAM_OR_COULD_NOT_SET_COOKIE_HLS):g._showConsoleError({name:"VIDEOJS_ERROR",text:"Code "+t.code+": "+t.message,code:-6e3}):g._showConsoleError({name:"REQUIRE_FLASH",text:"Please install and enable <a target='_black' href='https://get.adobe.com/flashplayer/'>Adobe Flash Player</a> and try again",code:-6001}):g._showConsoleError({name:"VIDEOJS_ERROR",text:"Code "+t.code+": "+t.message,code:-6e3})}g.stop("by_vjs_error"),g.play()});var B=null,W=null;W=b?(B=new CloudPlayerNativeVideo(a+"_nv1"),new CloudPlayerNativeVideo(a+"_nv2")):(B=g.vjs,g.vjs2);var G=null;g.time=0;var Y=g.player,q=g.player.getElementsByClassName("cloudplayer-controls")[0],V=g.player.getElementsByClassName("cloudplayer-volume")[0],$=g.player.getElementsByClassName("cloudplayer-controls-zoom-container")[0],K=g.player.getElementsByClassName("cloudplayer-controls-zoom")[0],J=g.player.getElementsByClassName("cloudplayer-controls-zoom-position")[0],X=g.player.getElementsByClassName("cloudplayer-controls-container")[0],Z=g.player.getElementsByClassName("cloudplayer-show-zoom")[0],Q=g.player.getElementsByClassName("cloudplayer-show-ptz")[0],ee=g.player.getElementsByClassName("cloudplayer-ptz")[0],te=g.player.getElementsByClassName("cloudplayer-play")[0],oe=g.player.getElementsByClassName("cloudplayer-info")[0],re=g.player.getElementsByClassName("cloudplayer-stop")[0],ne=g.player.getElementsByClassName("cloudplayer-loader")[0],ae=g.player.getElementsByClassName("cloudplayer-error")[0],ie=g.player.getElementsByClassName("cloudplayer-error-text")[0],se=g.player.getElementsByClassName("cloudplayer-time")[0],le=g.player.getElementsByClassName("cloudplayer-big-play-button")[0];m=g.player.getElementsByClassName("cloudplayer-webrtc")[0],h=g.player.getElementsByClassName("cloudplayer-native-hls")[0],C=document.getElementById(a+"_nv1"),y=document.getElementById(a+"_nv2");for(var ce=g.player.getElementsByClassName("cloudplayer-info-playertype")[0],ue=g.player.getElementsByClassName("cloudplayer-settings")[0],de=(g.player.getElementsByClassName("cloudplayer-info-close")[0],g.player.querySelectorAll(".cloudplayer-info-title .back")),me=g.player.getElementsByClassName("cloudplayer-info-player-mode")[0],fe=g.player.querySelector(".cloudplayer-info-player-speed"),pe=g.player.getElementsByClassName("selected-format")[0],he=g.player.querySelector(".cloudplayer-info-player-speed.enabled .selected-speed"),ge=g.player.querySelector(".cloudplayer-info-player-dewarping.enabled .selected-dewarping"),ve=g.player.getElementsByClassName("cloudplayer-webrtc-mode")[0],Ce=g.player.getElementsByClassName("cloudplayer-flash-mode")[0],ye=g.player.getElementsByClassName("cloudplayer-html5-mode")[0],_e=(T=g.player.getElementsByClassName("cloudcameracalendar-content")[0],g.player.getElementsByClassName("cloudplayer-calendar-container")[0]),Ae=g.player.getElementsByClassName("ptz-left")[0],Pe=g.player.getElementsByClassName("ptz-right")[0],Ee=g.player.getElementsByClassName("ptz-top")[0],Te=g.player.getElementsByClassName("ptz-bottom")[0],Se=g.player.getElementsByClassName("ptz-zoom-plus")[0],we=g.player.getElementsByClassName("ptz-zoom-minus")[0],be=g.player.getElementsByClassName("cloudplayer-calendar-container")[0],Ie=g.player.getElementsByClassName("cloudplayer-live-container")[0],Re=g.player.querySelectorAll(".cloudplayer-speed-mode"),ke=g.player.querySelectorAll(".cloudplayer-dewarping-mode"),Oe=Re.length-1;0<=Oe;Oe--)Re[Oe].onclick=xe;for(var Me=ke.length-1;0<=Me;Me--)ke[Me].onclick=Ue;"undefined"!=typeof rangeSlider&&rangeSlider.create(V);var De=document.querySelectorAll("[data-rangeSlider]");function Ne(e){var t=e.value;e.parentNode.getElementsByTagName("output")[0].innerHTML=t+"%"}for(var Le=De.length-1;0<=Le;Le--)Ne(De[Le]);function xe(){for(var e=Re.length-1;0<=e;e--)Re[e].classList.remove("selected");this.classList.add("selected"),he.textContent=this.textContent,function(e){for(var t=document.getElementById(player.playerElementID).getElementsByClassName("cloudplayer-native-video"),o=0;o<t.length;o++)t[o].defaultPlaybackRate=t[o].playbackRate=e}(this.dataset.speed)}function Ue(){for(var e=ke.length-1;0<=e;e--)ke[e].classList.remove("selected");this.classList.add("selected"),ge.textContent=this.textContent,1==this.dataset.dewarping?g.pano.start():g.pano.stop()}for(Array.prototype.slice.call(document.querySelectorAll('input[type="range"]')).forEach(function(e){e.addEventListener("input",function(e){Ne(e.target)},!1)}),Le=0;Le<de.length;Le++)de[Le].onclick=function(){Y.classList.remove("showing-format-selection"),Y.classList.remove("showing-dewarping-selection"),Y.classList.remove("showing-speed-selection")};function He(){ae.style.display="none",ie.style.display="none"}function je(){1==g.mShowedBigPlayButton?ze():t||(ne.style.display="inline-block",t=!0)}function ze(){t&&(ne.style.display="none",t=!1)}function Fe(e){e=e||{},ve.style.display=e.rtc||e.webrtc?"":"none",Ce.style.display=!CloudHelpers.isMobile()&&e.rtmp?"":"none",ye.style.display=e.hls?"":"none",ve.classList.remove("selected"),Ce.classList.remove("selected"),ye.classList.remove("selected"),"webrtc"==g.mPlayerFormat?(ve.classList.add("selected"),pe.textContent=ve.textContent):"flash"==g.mPlayerFormat?(Ce.classList.add("selected"),pe.textContent=Ce.textContent):"html5"==g.mPlayerFormat&&(ye.classList.add("selected"),pe.textContent=ye.textContent)}g.onDocumentClick=function(e){if(!(oe.contains(e.target)||ue==e.target||ue.contains(e.target)||T==e.target||T.contains(e.target)||Z==e.target||Z.contains(e.target)||$==e.target||$.contains(e.target)||_e==e.target||_e.contains(e.target))&&(g.player.classList.remove("showing-zoom","showing-settings"),g.calendar)){g.calendar.hideCalendar();var t=g.player.getElementsByClassName("cloudcameratimeline-calendar")[0];t&&t.classList.remove("shadowed")}},document.addEventListener("click",g.onDocumentClick),ue.onclick=function(){if(g.player.classList.toggle("showing-settings"),g.player.classList.remove("showing-zoom"),g.calendar){g.calendar.hideCalendar();var e=g.player.getElementsByClassName("cloudcameratimeline-calendar")[0];e&&e.classList.remove("shadowed")}},pe.onclick=function(){Y.classList.toggle("showing-format-selection")},he.onclick=function(){Y.classList.toggle("showing-speed-selection")},ge.onclick=function(){Y.classList.toggle("showing-dewarping-selection")},Ae.onmousedown=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"left",timeout:1e4}).done(function(e){console.log("shifted to left")}).fail(function(e){console.error(e)})}},Pe.onmousedown=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"right",timeout:1e4}).done(function(e){console.log("shifted to right")}).fail(function(e){console.error(e)})}},Ee.onmousedown=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"top",timeout:1e4}).done(function(e){console.log("shifted to up")}).fail(function(e){console.error(e)})}},Te.onmousedown=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"bottom",timeout:1e4}).done(function(e){console.log("shifted to down")}).fail(function(e){console.error(e)})}},Se.onmousedown=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"zoom_in",timeout:1e4}).done(function(e){console.log("Zoomed in")}).fail(function(e){console.error(e)})}},we.onmousedown=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"zoom_out",timeout:1e4}).done(function(e){console.log("Zoomed out")}).fail(function(e){console.error(e)})}},Se.onmouseup=we.onmouseup=Ae.onmouseup=Pe.onmouseup=Ee.onmouseup=Te.onmouseup=function(){var e=u._getAPI();if(null!=e){e.cameraPtzExecute(g.mSrc.getID(),{action:"stop",timeout:1e3}).done(function(e){console.log("stop move")}).fail(function(e){console.error(e)})}},Z.onclick=function(){if(g.player.classList.toggle("showing-zoom"),g.player.classList.remove("showing-settings"),g.calendar){g.calendar.hideCalendar();var e=g.player.getElementsByClassName("cloudcameratimeline-calendar")[0];e&&e.classList.remove("shadowed")}},Q.onclick=function(){Y.classList.toggle("showing-ptz")},ve.onclick=function(){g.setPlayerFormat("webrtc"),g.play()},Ce.onclick=function(){g.setPlayerFormat("flash"),g.play()},ye.onclick=function(){g.setPlayerFormat("html5"),g.play()},CloudHelpers.isMobile()&&(Ce.style.display="none"),Fe();var Be=g.player.getElementsByClassName("cloudplayer-black-screen")[0];function We(){Be.style.display=""}ze(),g._showerror=function(e){console.error(e),g._setError(e),g.showErrorText(e.text),console.error(e.text),d.executeCallbacks(CloudPlayerEvent.ERROR,e)},g._showConsoleError=function(e){console.error(e),console.error(e.text)};var Ge=30,Ye=15,qe=null;function Ve(){var e=0;"camera"==g.mSrc.type&&g.m.useTimezone?e=CloudHelpers.getOffsetTimezone(g.m.useTimezone):"camera"==g.mSrc.type&&(e=CloudHelpers.getOffsetTimezone(g.mSrc.getTimezone()));var t=new Date;t.setTime(t.getTime()+e);var o=t.getUTCHours(),r="";return g.options.timelineampm&&(r=12<=o?" pm":" am",o=0==o?12:12<o?o-12:o)," "+("0000"+t.getUTCFullYear()).slice(-4)+"-"+("00"+(t.getUTCMonth()+1)).slice(-2)+"-"+("00"+t.getUTCDate()).slice(-2)+" "+("00"+o).slice(-2)+":"+("00"+t.getUTCMinutes()).slice(-2)+":"+("00"+t.getUTCSeconds()).slice(-2)+r}function $e(){clearInterval(S),se.innerHTML=""}function Ke(){console.warn("[PLAYER] Start poling player time"),clearInterval(S),S=setInterval(function(){if(s&&!i){var e=0;if("camera_records"==qe)e=H.startUTC+1e3*R.currentTime();else if("camera_live"==qe)if("webrtc0"==c||"webrtc2"==c)e=m?m.currentTime:0;else if("native-hls"==c)e=h?h.currentTime:0;else{try{e=1e3*g.vjs.currentTime()}catch(e){console.error("Ignore: ",e)}try{t=g.vjs.videoHeight(),o=g.vjs.videoWidth(),D.w==o&&D.h==t||(setTimeout(function(){var e=g.vjs.el();if(e){var t=e.getElementsByTagName("object")[0];t&&(t.style.width="calc(100% - 5px)",setTimeout(function(){t.style.width=""},1e3))}},1e3),D.w=o,D.h=t)}catch(e){}}else try{e=1e3*g.vjs.currentTime()}catch(e){console.error("Ignore: ",e)}e==g.time?(je(),n++,0==g.time&&Ge<n?(g.stop("by_poling_time_1"),"webrtc"===g.mPlayerFormat?(g.stop("by_setError"),g.play()):(g.count_ERROR_STREAM_UNREACHABLE=1+(0|g.count_ERROR_STREAM_UNREACHABLE),3<g.count_ERROR_STREAM_UNREACHABLE?(g._showerror(CloudReturnCode.ERROR_STREAM_UNREACHABLE),g.count_ERROR_STREAM_UNREACHABLE=0):(console.warn("[PLAYER] stream unreachable: restart count"+g.count_ERROR_STREAM_UNREACHABLE),g.stop("by_setError"),g.play()))):0!=g.time&&Ye<n?(console.warn("Restart player"),g.stop("by_poling_time_2"),-1!=N&&g.time>N&&(N=Math.floor(g.time)),g.play()):console.warn("[PLAYER] Wait stream "+n)):(g.count_ERROR_STREAM_UNREACHABLE=0,n=0,g.mShowedBigPlayButton,le.style.display="none","camera_records"==qe?(g.time=e,N=g.time,se.innerHTML=function(e){var t=0;"camera"==g.mSrc.type&&g.m.useTimezone?t=CloudHelpers.getOffsetTimezone(g.m.useTimezone):"camera"==g.mSrc.type&&(t=CloudHelpers.getOffsetTimezone(g.mSrc.getTimezone()));var o=new Date;o.setTime(e+t);var r=o.getUTCHours(),n="";return g.options.timelineampm&&(n=12<=r?" pm":" am",r=0==r?12:12<r?r-12:r)," "+("0000"+o.getUTCFullYear()).slice(-4)+"-"+("00"+(o.getUTCMonth()+1)).slice(-2)+"-"+("00"+o.getUTCDate()).slice(-2)+" "+("00"+r).slice(-2)+":"+("00"+o.getUTCMinutes()).slice(-2)+":"+("00"+o.getUTCSeconds()).slice(-2)+n}(g.time)):"camera_live"==qe?(g.time=e,se.innerHTML=Ve(),g.isRange()&&CloudHelpers.getCurrentTimeUTC()>M&&($e(),g.stop("by_ended_timerange2"),d.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{}))):(g.time=-1==N?1e3*g.vjs.currentTime():H.startUTC+1e3*g.vjs.currentTime(),se.innerHTML=Ve()),ze(),He()),g.isRange()&&g.time>M&&(N=O,$e(),g.stop("by_ended_timerange"),d.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{}))}else ze(),se.innerHTML="";var t,o},1e3)}function Je(){if(null!=H){var a=H.endUTC,e=CloudHelpers.formatUTCTime(a-5*CloudHelpers.ONE_SECOND);if(j=null,g.isRange()&&M<e)return;if(null==u._getAPI())return;u._getAPI().storageRecordsFirst(g.mSrc.getID(),e,3).done(function(e){if(0==e.meta.total_count)j=null;else for(var t=e.objects.length,o=0;o<t;o++){var r=e.objects[o];if(r.size<500)console.error("mNextPlayRecord less than 500 bytes, skip ",r);else if(r.startUTC=CloudHelpers.parseUTCTime(r.start),r.endUTC=CloudHelpers.parseUTCTime(r.end),r.endUTC>a&&r.startUTC<a&&console.warn("[CloudPlayer] found trashold segment in "+(r.startUTC-a)+" ms, segment",r),r.startUTC>=a-I&&null==j){var n=(j=e.objects[o]).url;0==n.indexOf("http://")&&(n=n.replace("http://",("file:"==location.protocol?"http:":location.protocol)+"//")),k.reset(),k.src([{src:n,type:"video/mp4"}]),k.off("loadeddata"),k.on("loadeddata",function(){k.pause()});break}}})}else j=null}function Xe(e){g.mSrc?(n=0,"camera"==g.mSrc.type?function(s){if("camera"==g.mSrc.type){g.updateAudioCaps&&g.updateAudioCaps(g.mSrc.getID()),Fe(),qe="camera_records";var l=N,e=CloudHelpers.formatUTCTime(l-2*CloudHelpers.ONE_MINUTE);null!=u._getAPI()&&u._getAPI().storageRecordsFirst(g.mSrc.getID(),e,25).done(function(e){if(s==G){var t=e.objects.length,o=H=null;We();for(var r=0,n=0;n<t;n++)if(rec=e.objects[n],rec.size<500)console.error("Record less than 500 bytes will be skip ",rec);else if(rec.startUTC=CloudHelpers.parseUTCTime(rec.start),rec.endUTC=CloudHelpers.parseUTCTime(rec.end),null==o&&rec.startUTC>l&&(o=rec,console.log("firstRecordAfterT selected ",o)),rec.startUTC>l&&r++,!(l>rec.endUTC||l<rec.startUTC)){if(null==H&&l>=rec.startUTC&&l<=rec.endUTC){H=rec;break}if(g.isRange()){if(rec.startUTC>M)break;if(null==H&&l<rec.startUTC&&rec.startUTC<M){H=rec,l=rec.startUTC;break}}}var a=!1;if(null==H&&null!=o&&(!g.isRange()||g.isRange()&&o.startUTC<M)&&(l=(H=o).startUTC,a=!0),g.isRange()||null!=H||0!=r){if(null==H)return ze(),g._showerror(CloudReturnCode.ERROR_RECORDS_NOT_FOUND),void $e();if(s==G){if(g.isRange()&&M<l)return ze(),$e(),g.stop("by_ended_time_range_2"),void d.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{});a&&(g.time=l,d.executeCallbacks(CloudPlayerEvent.POSITION_JUMPED,{new_pos:l})),R=B,k=W,b?(R.el().style.display="block",k.el().style.display="none",g.vjs.el().style.display="none",R.onAutoplayBlocked=g.playbackAutoplayBlocked):(R.el().style.display="",k.el().style.display="none"),Je(),R.off("loadeddata"),R.ready(function(){var e=H.url;0==e.indexOf("http://")&&(e=e.replace("http://",("file:"==location.protocol?"http:":location.protocol)+"//")),R.src([{src:e,type:"video/mp4"}]);var t=l-H.startUTC,o=H.endUTC-H.startUTC;console.log(H),console.log("mCurrentRecord_vjs: "+t+" / "+o),R.currentTime(Math.floor(t/1e3)),R.play()}),R.off("ended"),k.off("ended"),R.on("ended",i),k.on("ended",i),Ke()}else console.warn("_uniqPlay not current [[_loadCameraRecords fail]]")}else setTimeout(function(){g.setPosition(CloudPlayer.POSITION_LIVE),g.play(),d.executeCallbacks(CloudPlayerEvent.POSITION_JUMPED,{new_pos:CloudHelpers.getCurrentTimeUTC()})},10)}else console.warn("_uniqPlay not current [[_loadCameraRecords fail]]");function i(){if(console.warn("ended"),g.isRange()&&null==j)return console.warn("stop player"),ze(),$e(),g.stop("by_ended_time_range_3"),void d.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{});if(null!=j){var e=R;R=k,k=e,b?(R.el().style.display="block",k.el().style.display="none",g.vjs.el().style.display="none"):(R.el().style.display="",k.el().style.display="none"),H=j,j=null,R.ready(function(){R.play()}),Je()}}})}else g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE)}(e):g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE)):g._showerror(CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED)}function Ze(){function e(){var e="pause"==l,t=CloudHelpers.isIOS()||CloudHelpers.isAndroid(),o=CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed&&"html5"==g.mPlayerFormat;if(!r&&(t||e||o)){$e();try{g.vjs.pause()}catch(e){console.warn("_vjs_play_live: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,le.style.display="block",le.onclick=function(e){r=e,le.style.display="none",document.getElementById("player1_vjs_Html5_api")&&(document.getElementById("player1_vjs_Html5_api").setAttribute("webkit-playsinline",!0),document.getElementById("player1_vjs_Html5_api").setAttribute("playsinline",!0)),!1,n=0,g.vjs.play(),$e(),Ke()},console.log("vjs_play ")}else g.vjs.play(),$e(),Ke()}console.log("[PLAYER] _vjs_play_live, mEvent: ",r),le.style.display="none",CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed&&"html5"==g.mPlayerFormat?CloudHelpers.checkAutoplay(e):e()}if(g.showErrorText=function(e){ze(),ae.style.display="block",ie.style.display="inline-block",ie.innerHTML=e,We()},g.getCalendarContent=function(){return T},g.setSource=function(e){if(He(),clearInterval(A),g.mSrc=e,u=null==g.mSrc?(te.style.display="none",null):(te.style.display="inline-block",e._getConn()),g.isRange()){var t=CloudHelpers.getCurrentTimeUTC();O<t&&t<M?g.setPosition(CloudPlayer.POSITION_LIVE):g.setPosition(O)}else g.setPosition(CloudPlayer.POSITION_LIVE);d.executeCallbacks(CloudPlayerEvent.SOURCE_CHANGED);var o=document.querySelector(".cloudplayer");if(o&&(o.classList.remove("showing-ptz"),u)){var r=g.player.getElementsByClassName("cloudplayer-show-ptz")[0],n=g.player.getElementsByClassName("ptz-top")[0],a=g.player.getElementsByClassName("ptz-bottom")[0],i=g.player.getElementsByClassName("ptz-left")[0],s=g.player.getElementsByClassName("ptz-right")[0],l=g.player.getElementsByClassName("ptz-zoom-plus")[0],c=g.player.getElementsByClassName("ptz-zoom-minus")[0];g.mSrc._origJson().access.indexOf("all")<0?r.style.display="none":u._getAPI().cameraPtz(g.mSrc.getID()).done(function(e){console.log(e);var t=e.actions;void 0!==t?(r.style.display="block",n.style.display=-1<t.indexOf("top")?"block":"none",a.style.display=-1<t.indexOf("bottom")?"block":"none",i.style.display=-1<t.indexOf("left")?"block":"none",s.style.display=-1<t.indexOf("right")?"block":"none",l.style.display=-1<t.indexOf("zoom_in")?"block":"none",c.style.display=-1<t.indexOf("zoom_out")?"block":"none"):r.style.display="none"}).fail(function(e){console.log(e),r.style.display="none"})}},g.getSource=function(){return g.mSrc},g.removeCallback=function(e){d.removeCallback(e)},g.addCallback=function(e,t){d.addCallback(e,t)},g.onTimelineEndUpdate=function(){-1==N&&i&&"block"==ae.style.display&&(console.warn("TODO Restart live if some errors happends"),g.play())},g.playbackAutoplayBlocked=function(){if(-1!=N){$e();try{B.pause()}catch(e){console.warn("_vjs_play: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,le.style.display="block",le.onclick=function(e){r=e,le.style.display="none";var t=R.el().getElementsByTagName("video")[0];t&&(t.setAttribute("webkit-playsinline",!0),t.setAttribute("playsinline",!0)),!1,n=0,R.play(),$e(),Ke()}}else console.warn("Skip error player already in live mode")},g.setPlayerFormat=function(e){if("webrtc"==(e=e.toLowerCase())||"flash"==e||"html5"==e){g.mPlayerFormat=e;try{localStorage.setItem("preferred_player_format",g.mPlayerFormat)}catch(e){console.error("[CloudPlayer] error save format: ",e)}Fe()}else console.error("Player format expected 'webrtc' or 'flash' or 'html5'")},g.getPlayerFormat=function(){return sMode},g.play=function(e){s&&g.stop("by_play"),"camera"==g.mSrc.type?(G=Math.random(),r=e,console.warn("[PLAYER] mUniqPlay: "+G),re.style.display="inline-block",te.style.display="none",s=!(i=!1),$e(),Ke(),g._reset_players(),He(),g.isRange()&&-1==N&&CloudHelpers.getCurrentTimeUTC()>M&&(N=O),g.isRange()&&M<N&&(N=O),-1==N?(!function(e){if(e==G){if(!g.mSrc)return console.error("[CloudPlayer] source not set"),g.setError(100);if("active"!=g.mSrc._origJson().status)return 0==g.m.waitSourceActivation&&(g._showerror(CloudReturnCode.ERROR_CAMERA_OFFLINE),d.executeCallbacks(CloudPlayerEvent.CHANNEL_STATUS,{status:"offline"})),ct(e);n=0,"camera"==g.mSrc.type?(ct(e),g._polingLoadCameraLiveUrl(e)):(console.error("[CloudPlayer] invalid source"),g.setError(100))}else console.warn("_uniqPlay not current [cameraLiveUrls fail]")}(G),d.executeCallbacks(CloudPlayerEvent.POSITION_JUMPED,{new_pos:CloudHelpers.getCurrentTimeUTC()})):(console.warn("Try load records from "+CloudHelpers.formatUTCTime(N)),Xe(G)),je()):g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE)},g.setPosition=function(e){(N=e)==CloudHelpers.POSITION_LIVE?_=!0:g.time=e},void 0!==e.position&&g.setPosition(N),g.getPosition=function(){return s?-1==N?"webrtc0"!=c&&"webrtc2"!=c||!m||0==m.currentTime?"native-hls"==c&&h&&0!=h.currentTime?CloudHelpers.getCurrentTimeUTC()+(u?u.getServerTimeDiff():0):"webrtc0"!=c&&"webrtc2"!=c&&g.vjs&&0!=g.vjs.currentTime()?CloudHelpers.getCurrentTimeUTC()+(u?u.getServerTimeDiff():0):0:CloudHelpers.getCurrentTimeUTC()+(u?u.getServerTimeDiff():0):0==g.time?N:Math.floor(g.time):0},g.isLive=function(){return-1==N&&!i},g.stop=function(e){console.log("[PLAYER] stop called "+e),_=s=!(i=!(G=null)),("by_webrtc2_error"===e||"by_webrtc0_error"===e||"by_setError"===e&&"webrtc"===g.mPlayerFormat)&&(g.mPlayerFormat="html5"),console.log("[PLAYER] self.stop: somebody call"),g._reset_players(),null!=C&&(C.style.display="none"),null!=y&&(y.style.display="none"),null!=f&&(f.stopWS(),m.style.display="none"),null!=p&&(p.stopWS(),m.style.display="none"),null!=v&&(v.stop(),h.style.display="none"),re.style.display="none",te.style.display="inline-block",$e(),clearInterval(w),g._stopPolingMediaTicket(),ze()},g.close=function(){g.stop("by_close"),clearInterval(g.currentTime),clearInterval(A)},g.destroy=function(){document.removeEventListener("click",g.onDocumentClick),g.stop("by_destroy"),clearInterval(g.currentTime),clearInterval(A),g.vjs.dispose(),g.vjs2.dispose(),delete window._cloudPlayers[g.elid],g.player.onwebkitfullscreenchange=null,g.player.onmozfullscreenchange=null,g.player.onfullscreenchange=null,g.player.onfullscreenchange=null,g.f_callbackFullscreenFunc&&(g.f_callbackFullscreenFunc=null)},g.error=function(){return g.mLastError||-1},g.onError=function(e){o=e},g.onChannelStatus=function(e){P=e},g._setError=function(e){setTimeout(function(){g.stop("by_setError")},10),g.mLastError=e,o&&(d.executeCallbacks(CloudPlayerEvent.ERROR,e),setTimeout(function(){o(g,e)},10))},g.setRange=function(e,t){console.warn("[PLAYER] setRange"),O=e,M=t},void 0!==e.range){var Qe=parseInt(e.range.min,10),et=parseInt(e.range.max,10);g.setRange(Qe,et)}function tt(e,t,o){for(var r in e)o(e[r],t)}function ot(){g.currentZoom=0;var e=g.player.getElementsByClassName("cloudplayer-controls-zoom")[0],o=g.player.getElementsByClassName("cloudplayer-controls-zoom-position")[0],t=g.player.getElementsByClassName("cloudplayer-zoom-up")[0],r=g.player.getElementsByClassName("cloudplayer-zoom-down")[0],n=g.player.getElementsByClassName("cloudplayer-zoom-progress")[0],p=g.player.getElementsByClassName("cloudplayer-zoom-position-cursor")[0],h=[];h.push(document.getElementById(a+"_vjs")),h.push(document.getElementById(a+"_vjs2")),h.push(C),h.push(y),h.push(g.player.getElementsByClassName("cloudplayer-webrtc")[0]),CloudHelpers.isMobile()&&(e.style.display="none"),g.zoomCursorDownBool=!1,g.zoomCursorX=0,g.zoomCursorY=0,g.zoomCursorWidth=176,g.zoomCursorHeight=160,g.zoomControlsWidth=0,g.zoomControlsHeight=0,g.setNewZoom=function(e){if(30<=e&&(e=30),e<=10&&(e=10),g.currentZoom!=e){g.currentZoom=e;var t="scale("+g.currentZoom/10+")";tt(h,t,function(e,t){e.style.transform=t}),p.style.transform="scale("+10/g.currentZoom+")",n.className=n.className.replace(/zoom\d+x/g,"zoom"+Math.ceil(g.currentZoom)+"x"),o.style.display=10==g.currentZoom?"none":"",p.style.left="",p.style.top="",tt(h,"",function(e,t){e.style.left=t,e.style.top=t})}},g.setNewZoom(10),g.zoomUp=function(){g.setNewZoom(g.currentZoom+5)},g.zoomDown=function(){g.setNewZoom(g.currentZoom-5)},g.zoomProgressDownBool=!1,g.zoomProgressDown=function(e){g.zoomProgressDownBool=!0},g.zoomProgressMove=function(e){if(1==g.zoomProgressDownBool){var t=e.pageY-CloudHelpers.getAbsolutePosition(e.currentTarget).y,o=n.offsetHeight,r=o/5;t=10*(Math.floor((o-t)/r)/2+1),g.setNewZoom(t)}},g.zoomProgressLeave=function(e){g.zoomProgressDownBool=!1},g.zoomProgressUp=function(e){if(1==g.zoomProgressDownBool){var t=e.pageY-CloudHelpers.getAbsolutePosition(e.currentTarget).y,o=n.offsetHeight,r=o/5;t=10*(Math.floor((o-t)/r)/2+1),g.setNewZoom(t)}g.zoomProgressDownBool=!1},g.zoomCursorDown=function(e){g.zoomCursorX=e.pageX,g.zoomCursorY=e.pageY,g.zoomCursorWidth=p.offsetWidth,g.zoomCursorHeight=p.offsetHeight,g.zoomControlsWidth=o.offsetWidth,g.zoomControlsHeight=o.offsetHeight,g.zoomCursorDownBool=!0},g.zoomCursorUp=function(e){console.log("zoomCursorUp"),g.zoomCursorDownBool=!1},g.zoomCursorMove=function(e){if(1==g.zoomCursorDownBool){var t=g.zoomCursorX-e.pageX,o=g.zoomCursorY-e.pageY;g.zoomCursorX=e.pageX,g.zoomCursorY=e.pageY;var r=p.offsetLeft-t,n=p.offsetTop-o,a=g.zoomControlsWidth-g.zoomCursorWidth*(10/g.currentZoom),i=g.zoomControlsHeight-g.zoomCursorHeight*(10/g.currentZoom),s=-1*a/2,l=a/2,c=-1*i/2,u=i/2;r<s&&(r=s),n<c&&(n=c),l<=r&&(r=l),u<=n&&(n=u),p.style.left=r+"px",p.style.top=n+"px";var d=g.currentZoom/10-1,m=Math.floor(r/a*d*-100),f=Math.floor(n/i*d*-100);g.vjs.videoHeight(),g.vjs.videoWidth();tt(h,m+"%",function(e,t){e.style.left=t}),tt(h,f+"%",function(e,t){e.style.top=t})}},t.onclick=g.zoomUp,r.onclick=g.zoomDown,p.addEventListener("mousedown",g.zoomCursorDown,!1),p.addEventListener("mousemove",g.zoomCursorMove,!1),p.addEventListener("mouseleave",g.zoomCursorUp,!1),p.addEventListener("mouseup",g.zoomCursorUp,!1),n.addEventListener("mousedown",g.zoomProgressDown,!1),n.addEventListener("mousemove",g.zoomProgressMove,!1),n.addEventListener("mouseleave",g.zoomProgressLeave,!1),n.addEventListener("mouseup",g.zoomProgressUp,!1)}function rt(){var e=g.player.getElementsByClassName("cloudplayer-volume-mute")[0],t=g.player.getElementsByClassName("cloudplayer-volume-down")[0],o=g.player.getElementsByClassName("cloudplayer-volume-progress")[0],r=g.player.getElementsByClassName("cloudplayer-volume-up")[0],n=g.player.getElementsByClassName("cloudplayer-volume-container")[0],a=g.player.getElementsByClassName("cloudplayer-volume")[0];function i(e){var t=0==e;player_native_hls=document.getElementById(g.elid+"_native_hls"),player_vjs2=document.getElementById(g.elid+"_vjs2"),player_vjs=document.getElementById(g.elid+"_vjs"),player_nv1=document.getElementById(g.elid+"_nv1"),player_nv2=document.getElementById(g.elid+"_nv2"),player_webrtc=document.getElementById(g.elid+"_webrtc"),null!=player_native_hls&&"undefined"!=typeof player_native_hls&&(player_native_hls.muted=t),null!=player_vjs2&&"undefined"!=typeof player_vjs2&&(player_vjs2.muted=t),null!=player_vjs&&"undefined"!=typeof player_vjs&&(player_vjs.muted=t),null!=player_nv1&&"undefined"!=typeof player_nv1&&(player_nv1.muted=t),null!=player_nv2&&"undefined"!=typeof player_nv2&&(player_nv2.muted=t),g.vjs.muted(t),g.vjs2.muted(t),g.vjs.volume(e),g.vjs2.volume(e),B.volume(e),W.volume(e),null!=m&&(null!=player_webrtc&&"undefined"!=typeof player_webrtc&&(player_webrtc.muted=t),m.volume=e)}g.m=g.m||{},g.m.volume=.5,e.style.display="inline-block",g.m.mute?(n.style.display="none",e.classList.add("unmute")):(n.style.display="flex",e.classList.remove("unmute")),g.mute=function(){g.isAudioChannelExists()&&(g.m.mute=!g.m.mute,g.m.mute?(n.style.display="none",e.classList.add("unmute")):(n.style.display="flex",e.classList.remove("unmute")),i(g.m.mute?0:""+g.m.volume.toFixed(1)))},g.volume=function(e){if(g.isAudioChannelExists())return null==e?g.m.volume:(e=(e=1<e?1:e)<0?0:e,g.m.volume=Math.ceil(10*e)/10,i(g.m.mute?0:g.m.volume.toFixed(1)),void(o.className=o.className.replace(/vol\d+/g,"vol"+Math.ceil(10*g.m.volume))))},g.volup=function(){g.isAudioChannelExists()&&(Math.round(10*g.m.volume)<10&&(g.m.volume=g.m.volume+.1,i(g.m.mute?0:g.m.volume.toFixed(1)),o.className=o.className.replace(/vol\d+/g,"vol"+Math.ceil(10*g.m.volume))))},g.voldown=function(){g.isAudioChannelExists()&&(0<Math.round(10*g.m.volume)&&(g.m.volume=g.m.volume-.1,i(g.m.mute?0:g.m.volume.toFixed(1)),o.className=o.className.replace(/vol\d+/g,"vol"+Math.floor(10*g.m.volume))))},e.onclick=g.mute,t.onclick=g.voldown,r.onclick=g.volup,a.addEventListener("input",function(e){g.player.getElementsByClassName("cloudplayer-volume")[0]&&g.volume(e.target.value/100)}),g.vjs.ready(function(){g.isAudioChannelExists()&&(g.vjs.muted(!0),g.volume(g.m.volume))}),g.isAudioChannelExists()||(t.style.display="none",o.style.display="none",r.style.display="none",e.style.display="none")}function nt(e,t){if(t.rtc){console.warn("webrtc0 - depracated"),c="webrtc0",ce.innerHTML="Used player: WebRTC (v0)";var o="https:"==location.protocol?"wss://":"ws://",r=location.hostname,n=8080;u.ServiceProviderUrl;if(t.rtc){var a=CloudHelpers.parseUri(t.rtc).protocol;"http"==a||"ws"==a?o="ws://":"https"==a||"wss"==a?o="wss://":console.warn("Unknown protocol in '"+t+"'"),r=CloudHelpers.parseUri(t.rtc).host,n=CloudHelpers.parseUri(t.rtc).port}var i=o+r+":"+n+"/";g.vjs.el().style.display="none",g.vjs2.el().style.display="none",h.style.display="none",m.style.display="block",window.CloudPlayerWebRTC0?((f=new CloudPlayerWebRTC0(m,i,t.rtmp)).onAutoplayBlocked=g.WebRTC2_autoplayBlocked,f.onServerError=function(e){console.error("[WebRTC0] Event error ",e),g._showerror(CloudReturnCode.ERROR_WEBRTC_SERVER_ERROR),g.stop("by_webrtc0_error")},f.startWS(),Ke()):console.error("Not found module CloudPlayerWebRTC0")}else g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function at(e,t){if(t.webrtc)if(c="webrtc2",ce.innerHTML="Used player: WebRTC (v2)",g.vjs.el().style.display="none",g.vjs2.el().style.display="none",h.style.display="none",m.style.display="block",window.CloudPlayerWebRTC2){var o=CloudHelpers.promise();0<CloudHelpers.compareVersions(CloudPlayerWebRTC2.version,t.webrtc.version)?(console.warn("Expected version webrtc.version (v"+t.webrtc.version+")  mismatch with included CloudPlayerWebRTC (v"+CloudPlayerWebRTC2.version+")"),o=CloudHelpers.requestJS(t.webrtc.scripts.player,function(e){for(e=e.replace("CloudPlayerWebRTC =","CloudPlayerWebRTC2 =");-1!==e.indexOf("CloudPlayerWebRTC.");)e=e.replace("CloudPlayerWebRTC.","CloudPlayerWebRTC2.");return e})):o.resolve(),o.done(function(){console.log("[PLAYER] ",t.webrtc.connection_url),(p=new CloudPlayerWebRTC2(m,t.webrtc.connection_url,t.webrtc.ice_servers,{send_video:!1,send_audio:!1})).onAutoplayBlocked=g.WebRTC2_autoplayBlocked,p.onServerError=function(e){console.error("[WebRTC2] Event error ",e),g._showerror(CloudReturnCode.ERROR_WEBRTC_SERVER_ERROR),g.stop("by_webrtc2_error")},p.startWS(),Ke()})}else console.error("Not found module CloudPlayerWebRTC2");else g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function it(e,t){if(t.rtmp){ce.innerHTML="Used player: Flash",g.vjs.ready(function(){console.log("[PLAYER] Set url (rtmp): "+t.rtmp),g.vjs.options().flash.swf=CloudSDK.flashswf||"swf/video-js-by-vxg-buff200.swf",g.vjs.src([{src:t.rtmp,type:"rtmp/mp4"}]),CloudHelpers.isFireFox()?console.warn("in firefox not good solution for a hiding adobe flash player"):Be.style.display="block"}),g.vjs.off("ended"),g.vjs.on("ended",function(){g.stop("by_rtmp_ended")});var o=!1;g.vjs.off("loadeddata"),g.vjs.on("loadeddata",function(){console.warn("loadeddata"),o=!0,We(),e==G?(ze(),ot(),rt(),Ze()):console.warn("[PLAYER]  _uniqPlay not current [loadeddata]")}),g.vjs.off("loadedmetadata"),g.vjs.on("loadedmetadata",function(){console.warn("loadedmetadata")}),setTimeout(function(){console.log("[PLAYER] Set url (rtmp) 2: "+t.rtmp),o||g.vjs.src([{src:t.rtmp,type:"rtmp/mp4"}])},5e3),$e(),Ke(),CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed?Ze():g.vjs.play()}else g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function st(e,t){var o;t.hls?g.m.useNativeHLS?(o=t).hls?(c="native-hls",ce.innerHTML="Used player: NativeHLS",g.vjs.el().style.display="none",g.vjs2.el().style.display="none",m.style.display="none",h.style.display="block",window.CloudPlayerNativeHLS?((v=new CloudPlayerNativeHLS(h,o.hls)).play(),Ke()):console.error("[PLAYER]  Not found module CloudPlayerNativeHLS")):g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT):(ce.innerHTML="Used player: HTML5 (hls)",c="hls",console.log("[PLAYER] Set url (hls): "+t.hls),clearInterval(w),function e(t,o){if(o==G){var r=new XMLHttpRequest;r.open("GET",t.hls),r.onload=function(){if(o==G)if(200===r.status){if(o!=G)return;g._applyMediaTiket(t.hls,t.expire),g.vjs.src([{src:t.hls,type:"application/x-mpegURL"}]),r=null}else if(404===r.status){if(o!=G)return void console.warn("[VXGCLOUDPLAYER] polingHLSList, camid was changed stop poling hls list, currentCmaID="+g.mSrc.getID());if(Ge<++n)return g.count_ERROR_STREAM_UNREACHABLE=1+(0|g.count_ERROR_STREAM_UNREACHABLE),void(3<g.count_ERROR_STREAM_UNREACHABLE?(g._showerror(CloudReturnCode.ERROR_STREAM_UNREACHABLE_HLS),g.count_ERROR_STREAM_UNREACHABLE=0):(g.stop(),g.play()));setTimeout(function(){console.warn("Wait one sec "+t.hls),r=null,e(t,o)},1e3)}else console.error("Unhandled");else console.warn("_uniqPlay not current [_polingCameraHLSList 2]")},r.send()}else console.warn("_uniqPlay not current [_polingCameraHLSList]")}(t,e),g.vjs.off("ended"),g.vjs.on("ended",function(){g.stop("by_hls_ended"),g._showerror(CloudReturnCode.ERROR_HLS_ENDED)}),l="",g.vjs.off("loadeddata"),g.vjs.on("loadeddata",function(){console.warn("loadeddata"),We(),e==G?(ze(),ot(),rt(),Ze(),CloudHelpers.isSafari()&&(l="loadeddata")):console.warn("_uniqPlay not current [loadeddata]")}),g.vjs.off("loadedmetadata"),g.vjs.on("loadedmetadata",function(){}),g.vjs.off("playing"),g.vjs.on("playing",function(){CloudHelpers.isSafari()&&"loadeddata"===l&&(l="playing")}),g.vjs.off("pause"),g.vjs.on("pause",function(){CloudHelpers.isSafari()&&"playing"===l&&(l="pause",Ze())}),$e(),Ke(),CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed?Ze():g.vjs.play()):g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function lt(o){if(null!=G&&o!=G)return console.warn("[_polingCameraStatus] _uniqPlay not current 1"),void clearInterval(A);if(!g.mSrc)return console.warn("[_polingCameraStatus] no source"),void clearInterval(A);if("camera"!=g.mSrc.type)return console.warn("[_polingCameraStatus] no type camera"),void clearInterval(A);var e=g.mSrc.getID(),r=g.mSrc._origJson().status;u._getAPI().getCamera2(e,{}).done(function(e){var t=e.status;if(null!=G&&o!=G)return console.warn("[_polingCameraStatus] _uniqPlay not current (2) "+o+"!="+G),void clearInterval(A);"active"!==t&&0!=g.m.waitSourceActivation&&L>g.m.waitSourceActivation&&(g._showerror(CloudReturnCode.ERROR_CAMERA_OFFLINE),L=0),r!=t&&(console.warn("switched camera status: from "+r+" to "+t+" mLiveModeAutoStart: "+_),g.mSrc._origJson().status=t,_&&("active"==t?g.play():(g.stop("by_poling_camera_status"),g._showerror(CloudReturnCode.ERROR_CAMERA_OFFLINE),ct(o))),d.executeCallbacks(CloudPlayerEvent.CHANNEL_STATUS,{status:t}),P&&setTimeout(function(){P(g,t)},10))}).fail(function(e){console.error("[_polingCameraStatus] ",e),g.mSrc._origJson().status="error"})}function ct(t){setTimeout(function(){_=!0,clearInterval(A),lt(t),L=100;var e=3e3;e="active"==g.mSrc._origJson().status?U:x,A=setInterval(function(){0<L&&(L+=e),lt(t)},e)},100)}g.isRange=function(){return-1!=O&&-1!=M},g.resetRange=function(){console.warn("[PLAYER] resetRange"),M=O=-1},ot(),g.isAudioChannelExists=function(){return!0},g.updateAudioStream=function(){el_info_audio_stream.style.display="none",u._getAPI().cameraMediaStreams(g.currentCamID).done(function(e){if(e.mstreams_supported&&1<e.mstreams_supported.length){for(var t in el_info_audio_stream.style.display="block",g.mstreams.audio_on="",g.mstreams.audio_off="",g.mstreams.current=e.live_ms_id,e.mstreams_supported)e.mstreams_supported[t].as_id&&e.mstreams_supported[t].vs_id?g.mstreams.audio_on=e.mstreams_supported[t].id:e.mstreams_supported[t].vs_id&&(g.mstreams.audio_off=e.mstreams_supported[t].id);g.mstreams.audio_on==g.mstreams.current?el_info_audio_stream_on.classList.add("selected"):g.mstreams.audio_off==g.mstreams.current&&el_info_audio_stream_off.classList.add("selected")}else el_info_audio_stream.style.display="none";g.isAudioChannelExists()}).fail(function(e){console.error(e),el_info_audio_stream.style.display="none"})},rt(),g.WebRTC0_autoplayBlocked=function(){$e();try{f.stopWS()}catch(e){console.warn("WebRTC0_autoplayBlocked: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,le.style.display="block",le.onclick=function(e){r=e,le.style.display="none",!1,n=0,g.play()}},g.WebRTC2_autoplayBlocked=function(){$e();try{p.stopWS()}catch(e){console.warn("WebRTC2_autoplayBlocked: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,le.style.display="block",le.onclick=function(e){r=e,le.style.display="none",!1,n=0,g.play()}},g._polingLoadCameraLiveUrl=function(o){o==G?"camera"==g.mSrc.type?(g.updateAudioCaps&&g.updateAudioCaps(g.mSrc.getID()),qe="camera_live",c="",u._getAPI().cameraLiveUrls(g.mSrc.getID()).done(function(e){if(o==G){Fe(e);var t=1;e.webrtc&&(t=e.webrtc.version.split(".")[0],t=parseInt(t,10)),e.hls||e.rtmp||(E="webrtc"),null===E?("webrtc"==g.mPlayerFormat&&(e.rtc&&CloudHelpers.supportWebRTC()?nt(0,e):e.webrtc&&2===t&&CloudHelpers.supportWebRTC()?at(0,e):st(o,e)),"flash"==g.mPlayerFormat&&(CloudHelpers.useHls()?st(o,e):it(o,e)),"html5"==g.mPlayerFormat&&st(o,e)):"flash"===E?it(o,e):"html5"===E?st(o,e):e.rtc&&"webrtc"===E?nt(0,e):e.webrtc&&2===t&&"webrtc"===E?at(0,e):g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}else console.warn("_uniqPlay not current [_polingLoadCameraLiveUrl.done]")}).fail(function(e){console.error(e),o==G?e.status&&503==e.status&&++n<g.timePolingLiveUrls?setTimeout(function(){g._polingLoadCameraLiveUrl(o)},1e3):console.error(e):console.warn("_uniqPlay not current [_polingLoadCameraLiveUrl.fail]")})):g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE):console.warn("_uniqPlay not current [_polingLoadCameraLiveUrl]")},g._reset_players=function(){console.log("_reset_players"),g.vjs.reset(),g.vjs.controls(!1),g.vjs.muted(!0),g.vjs.autoplay(!0),g.vjs.volume(0),g.vjs.el().style.display="",g.vjs2.reset(),g.vjs2.controls(!1),g.vjs2.muted(!0),g.vjs2.autoplay(!0),g.vjs2.volume(0),g.vjs2.el().style.display="none",B.reset(),B.el().style.display="none",W.reset(),W.el().style.display="none",g.volume(g.m.volume),$e(),g._stopPolingMediaTicket()},g.isPlaying=function(){return s},g.set_controls_opacity=function(e){q.style.opacity!=e&&d.executeCallbacks(CloudPlayerEvent.CHANGED_CONTROLS,{opacity:e}),q.style.opacity=e,K.style.opacity=e,J.style.opacity=e,X.style.opacity=e,oe.style.opacity=e,T.style.opacity=e,ee.style.opacity=e,$.style.opacity=e,be.style.opacity=e,Ie.style.opacity=e},g.restartTimeout=function(){g.m.autohide<0?g.set_controls_opacity("0"):0!=g.m.autohide?(g.set_controls_opacity("1"),clearTimeout(g.timeout),g.timeout=setTimeout(function(){g.set_controls_opacity("0")},g.m.autohide)):g.set_controls_opacity("1")},g.restartTimeout(),g.player.addEventListener("mousemove",g.restartTimeout,!0),g.player.addEventListener("touchmove",g.restartTimeout,!0),g.player.addEventListener("touchstart",g.restartTimeout,!0),te.onclick=g.play,re.onclick=g.stop,g.size=function(e,t){console.error("[CloudPlayer] size not support")},g.setFullscreenCallback=function(e){g.f_callbackFullscreenFunc=e},g.initFullscreenControls=function(){var e,t,o,r,n=g.player.getElementsByClassName("cloudplayer-fullscreen")[0];g.changedFullscreen=function(){console.log("changedFullscreen: "+document.webkitIsFullScreen),document.webkitIsFullScreen?(e=g.player.style.height,t=g.player.style.width,r=g.player.style.maxHeight,o=g.player.style.maxWidth,g.player.style.height="100%",g.player.style.width="100%",g.player.style.maxHeight="100%",g.player.style.maxWidth="100%",console.log("changedFullscreen -> fullscreen")):(g.player.style.height=e,g.player.style.width=t,g.player.style.maxHeight=r,g.player.style.maxWidth=o,console.log("changedFullscreen -> NOT fullscreen")),g.f_callbackFullscreenFunc&&g.f_callbackFullscreenFunc()},g.player.onwebkitfullscreenchange=g.changedFullscreen,g.player.onmozfullscreenchange=g.changedFullscreen,g.player.onfullscreenchange=g.changedFullscreen,g.fullscreen=function(){console.log("fullscreen: clicked"),1==document.webkitIsFullScreen?document.webkitCancelFullScreen():document.mozFullScreen?document.mozCancelFullScreen():document.msFullscreenElement&&null!=document.msFullscreenElement?document.msExitFullscreen():g.player.mozRequestFullScreen?g.player.mozRequestFullScreen():g.player.requestFullscreen?g.player.requestFullscreen():g.player.webkitRequestFullscreen?g.player.webkitRequestFullscreen():g.player.msRequestFullscreen&&g.player.msRequestFullscreen()},n.onclick=g.fullscreen},g.initFullscreenControls(),g.initHLSMechanism=function(){g._applyMediaTiket=function(e,t){console.log("media-tiсket: old = "+g.hls_mediaticket_value),-1!=e.indexOf("?")&&(g.hls_mediaticket_value="?"+e.split("?")[1]),Date.parse(t+"Z"),console.log("media-tiсket: new = "+g.hls_mediaticket_value)},g._stopPolingMediaTicket=function(){clearInterval(g._polingMediaTicketInterval)}},g.initHLSMechanism(),(window._cloudPlayers[a]=g).pano=CloudPano(g.player.getElementsByClassName("allvideotags")[0],g),g.enableSpeedSetting=function(){fe.classList.add("enabled")},g.disableSpeedSetting=function(){fe.classList.remove("enabled")},g.enableModeSetting=function(){me.classList.add("enabled")},g.disableModeSetting=function(){me.classList.remove("enabled")},void 0!==g.mPreferredPlayerFormat?g.disableModeSetting():g.enableModeSetting()},CloudPlayer.POSITION_LIVE=-1,window.CloudPlayerNativeHLS=function(e,t){var o=e,r=t;console.warn("[NativeHLS] canPlay: application/vnd.apple.mpegurl => ",o.canPlayType("application/vnd.apple.mpegurl")),console.warn("[NativeHLS] canPlay: application/x-mpegURL => ",o.canPlayType("application/x-mpegURL")),console.warn("[NativeHLS] canPlay: video/mp4 => ",o.canPlayType("video/mp4")),this.play=function(){0<o.children.length&&o.removeChild(o.children[0]);var e=document.createElement("source");e.src=r,e.type="video/mp4",o.append(e),o.load()},this.stop=function(){0<o.children.length&&o.removeChild(o.children[0])},o.addEventListener("abort",function(){console.warn("[NativeHLS] abort")},!0),o.addEventListener("canplay",function(){console.warn("[NativeHLS] canplay")},!0),o.addEventListener("canplaythrough",function(){console.warn("[NativeHLS] canplaythrough")},!0),o.addEventListener("durationchange",function(){console.warn("[NativeHLS] durationchange")},!0),o.addEventListener("emptied",function(){console.warn("[NativeHLS] emptied")},!0),o.addEventListener("encrypted",function(){console.warn("[NativeHLS] encrypted")},!0),o.addEventListener("ended",function(){console.warn("[NativeHLS] ended")},!0),o.addEventListener("error",function(e,t){console.error("[NativeHLS] error ",e),console.error("[NativeHLS] error ",t)},!0),o.addEventListener("interruptbegin",function(){console.warn("[NativeHLS] interruptbegin")},!0),o.addEventListener("interruptend",function(){console.warn("[NativeHLS] interruptend")},!0),o.addEventListener("loadeddata",function(){console.warn("[NativeHLS] loadeddata"),o.play()},!0),o.addEventListener("loadedmetadata",function(){console.warn("[NativeHLS] loadedmetadata")},!0),o.addEventListener("loadstart",function(){console.warn("[NativeHLS] loadstart")},!0),o.addEventListener("mozaudioavailable",function(){console.warn("[NativeHLS] mozaudioavailable")},!0),o.addEventListener("pause",function(){console.warn("[NativeHLS] pause")},!0),o.addEventListener("play",function(){console.warn("[NativeHLS] play")},!0),o.addEventListener("playing",function(){console.warn("[NativeHLS] playing")},!0),o.addEventListener("progress",function(){console.warn("[NativeHLS] progress")},!0),o.addEventListener("ratechange",function(){console.warn("[NativeHLS] ratechange")},!0),o.addEventListener("seeked",function(){console.warn("[NativeHLS] seeked")},!0),o.addEventListener("seeking",function(){console.warn("[NativeHLS] seeking")},!0),o.addEventListener("stalled",function(){console.warn("[NativeHLS] stalled")},!0),o.addEventListener("suspend",function(){console.warn("[NativeHLS] suspend")},!0),o.addEventListener("timeupdate",function(){console.warn("[NativeHLS] timeupdate")},!0),o.addEventListener("volumechange",function(){console.warn("[NativeHLS] volumechange")},!0),o.addEventListener("waiting",function(){console.warn("[NativeHLS] waiting")},!0)},window.CloudPlayerNativeVideo=function(e){var o=document.getElementById(e),t=null,r=this,n="[NativeVideo] ",a=0,i=null;r.onAutoplayBlocked=function(){},r.on=function(e,t){"error"==e?i=t:"loadeddata"==e?o.onloadeddata=t:"ended"==e?o.onended=t:"autoplay_blocked"==e?t:console.error(n+"ON Unknown "+e)},r.off=function(e){"loadeddata"==e?o.onloadeddata=null:"ended"==e?o.onended=null:console.error(n+"OFF Unknown "+e)},r.ready=function(e){e(),console.error(n+"TODO ready")},r.muted=function(e){o.muted=e,console.error(n+"TODO muted")},r.volume=function(e){if(void 0===e)return o.volume;o.volume=e},r.reset=function(){console.warn(n,"reset"),!0,a=0,o.pause(),null!=t&&t.removeAttribute("src"),o.load()},r.controls=function(e){console.error(n+"TODO controls")},r.autoplay=function(e){1==e&&console.error(n+"Not supported autoplay")},r.el=function(){return o},r.src=function(e){null==t&&(t=document.createElement("source"),o.appendChild(t)),o.pause(),o.currentTime=0,t.setAttribute("src",e[0].src),o.load()},r.currentTime=function(e){return void 0!==e?(a=e,void(o.currentTime=e)):o.currentTime||a},r.play=function(){var e,t;e=o.play(),t="",window.Promise&&(t=window.Promise.toString()),-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")?e.catch(function(e){console.error(n+"checkAutoplay, error:",e),"NotAllowedError"==e.name?(console.error(n+"_checkAutoPlay: error.name:","NotAllowedError"),r.onAutoplayBlocked()):"AbortError"==e.name&&CloudHelpers.isSafari()?(console.error(n+"_checkAutoPlay: AbortError (Safari)"),r.onAutoplayBlocked()):(console.error(e),console.error(n+"checkAutoplay: happened something else"))}).then(function(){console.log(n+"checkAutoplay: then")}):console.error(n+"checkAutoplay: could not work in your browser ",e)},r.pause=function(){o.pause()},o.addEventListener("abort",function(){},!0),o.addEventListener("canplay",function(){},!0),o.addEventListener("canplaythrough",function(){},!0),o.addEventListener("durationchange",function(){},!0),o.addEventListener("emptied",function(){},!0),o.addEventListener("encrypted",function(){},!0),o.addEventListener("ended",function(){console.warn(n+"ended")},!0),o.addEventListener("error",function(e,t){console.error(n+"err0 ",e),null!=i&&i(e)},!0),o.addEventListener("interruptbegin",function(){},!0),o.addEventListener("interruptend",function(){},!0),o.addEventListener("loadeddata",function(){o.currentTime=a},!0),o.addEventListener("loadedmetadata",function(){},!0),o.addEventListener("loadstart",function(){},!0),o.addEventListener("mozaudioavailable",function(){},!0),o.addEventListener("pause",function(){},!0),o.addEventListener("play",function(){},!0),o.addEventListener("playing",function(){},!0),o.addEventListener("progress",function(){},!0),o.addEventListener("ratechange",function(){},!0),o.addEventListener("seeked",function(){},!0),o.addEventListener("seeking",function(){},!0),o.addEventListener("stalled",function(){},!0),o.addEventListener("suspend",function(){},!0),o.addEventListener("timeupdate",function(){},!0),o.addEventListener("volumechange",function(){},!0),o.addEventListener("waiting",function(){},!0)},window.CloudPlayerWebRTC0=function(e,t,o){var r,n=e,a=t,i=o,s=null,l="[WEBRTC0] ",c={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:turn.vxg.io:3478?transport=udp"],username:"vxgturn",credential:"vxgturn"}]},u=this,d=Math.floor(8990*Math.random()+10).toString();u.onWsError=function(e){console.error(e)},u.onAutoplayBlocked=function(){console.error(l+"onAutoplayBlocked")},CloudHelpers.isSafari()&&navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(e){console.log(l+"Camera permission granted")}).catch(function(e,t){console.error(e,t)}),u.resetState=function(){r.close()},u.handleIncomingError=function(e){console.error(l+"IncomingError: ",e),resetState()},u.resetVideoElement=function(){n.pause(),n.src="",n.load()},u.onIncomingSDP=function(e){e.sdp=e.sdp.replace(/profile-level-id=[^;]+/,"profile-level-id=42e01f"),console.log(l+"Incoming SDP is "+JSON.stringify(e)),s.setRemoteDescription(e).then(function(){console.log("Remote SDP set"),"offer"==e.type&&(console.log(l+"Got SDP offer, creating answer"),s.createAnswer().then(u.onLocalDescription).catch(function(e){console.error("[WEBRTC0] createAnswer: ",e)}))}).catch(function(e){console.error(l+"setRemoteDescription: ",e)})},u.onLocalDescription=function(e){console.log(l+"Got local description: "+JSON.stringify(e)),s.setLocalDescription(e).then(function(){var e,t;console.log(l+"Sending SDP answer"),sdp={sdp:s.localDescription},r.send(JSON.stringify(sdp)),console.warn(l+"Streaming (1)"),e=n.play(),t="",window.Promise&&(t=window.Promise.toString()),-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")?e.catch(function(e){console.error(l+"_checkAutoplay, error:",e),"NotAllowedError"==e.name?(console.error(l+"_checkAutoPlay: error.name:","NotAllowedError"),u.onAutoplayBlocked()):"AbortError"==e.name&&CloudHelpers.isSafari()?(console.error(l+"_checkAutoPlay: AbortError (Safari)"),u.onAutoplayBlocked()):(console.error(e),console.error(l+"checkAutoplay: happened something else"))}).then(function(){console.log(l+"checkAutoplay: then")}):console.error(l+"_checkAutoplay: could not work in your browser ",e)})},u.onIncomingICE=function(e){console.log(l+"Incoming ICE: "+JSON.stringify(e));var t=new RTCIceCandidate(e);s.addIceCandidate(t).catch(function(e){console.error(l+"addIceCandidate ",e)})},u.onServerMessage=function(t){switch(console.log(l+"Received "+t.data),t.data){case"HELLO":return void console.log(l+"Registered with server, waiting for stream");default:if(t.data.startsWith("ERROR"))return void u.handleIncomingError(t.data);try{msg=JSON.parse(t.data)}catch(e){return void(e instanceof SyntaxError?handleIncomingError("Error parsing incoming JSON: "+t.data):handleIncomingError("Unknown error parsing response: "+t.data))}null==s&&u.createCall(msg),null!=msg.sdp?u.onIncomingSDP(msg.sdp):null!=msg.ice?u.onIncomingICE(msg.ice):u.handleIncomingError("Unknown incoming JSON: "+msg)}},u.stopWS=function(){r.close()},u.onServerClose=function(e){u.resetVideoElement(),null!=s&&(s.close(),s=null)},u.onServerError=function(e){console.error("[WEBRTC0] Unable to connect to server, did you add an exception for the certificate?")},u.onRemoteStreamAdded=function(e){videoTracks=e.stream.getVideoTracks(),audioTracks=e.stream.getAudioTracks(),0<videoTracks.length?(console.log("[WEBRTC0] Incoming stream: "+videoTracks.length+" video tracks and "+audioTracks.length+" audio tracks"),n.srcObject=e.stream):u.handleIncomingError("[WEBRTC0] Stream with unknown tracks added, resetting")},u.errorUserMediaHandler=function(){console.error("[WEBRTC0] Browser doesn't support getUserMedia!")},u.createCall=function(e){connect_attempts=0,(s=new RTCPeerConnection(c)).onaddstream=u.onRemoteStreamAdded,e.sdp||console.log("[WEBRTC0] WARNING: First message wasn't an SDP message!?"),s.onicecandidate=function(e){null!=e.candidate?r.send(JSON.stringify({ice:e.candidate})):console.error("[WEBRTC0] ICE Candidate was null, done")},console.log("[WEBRTC0] Created peer connection for call, waiting for SDP")},u.startWS=function(){if(u.connect_attempts++,3<u.connect_attempts)console.error("[WEBRTC0] Too many connection attempts, aborting. Refresh page to try again");else{console.log("[WEBRTC0] Connecting to server..."),loc=null,(r=new WebSocket(a)).addEventListener("open",function(e){r.send("HELLO "+d),console.log(l+"Registering with server"),r.send("SPAWN "+i)}),r.addEventListener("error",u.onServerError),r.addEventListener("message",u.onServerMessage),r.addEventListener("close",u.onServerClose)}}},window.CloudPlayerWebRTC2=function(e,t,o,r){r=r||{};var a=this,i="[WEBRTC2] ";console.log(i,r);var s=e,l="",n=t||"",c=r.send_video||!1,u=r.send_audio||!1,d={},m={iceServers:o||[]},f=!1,p=null;function h(){console.warn(i+"loadeddata"),console.warn(i+"currentTime = "+s.currentTime)}a.onWsError=function(e){console.error("[WEBRTC2] onWsError, ",e)},a.resetState=function(){p.close()},a.handleIncomingError=function(e){console.error("[WEBRTC2] ERROR: ",e),a.resetState()},a.reset=function(){s&&s.srcObject&&(s.pause(),s.srcObject=null,l="",s.load())},a.el=function(){return s},a.onAutoplayBlocked=function(){console.error(i+"onAutoplayBlocked")},a.initCalbacks=function(){s&&s.addEventListener("loadeddata",h,!0)},a.removeCalbacks=function(){s&&s.removeEventListener("loadeddata",h,!0)},a.createWatchingConnection=function(t){connect_attempts=0,console.assert(!(t in d)),objPeer=new RTCPeerConnection(m),objPeer.strPeerUID=t,d[t]=objPeer,objPeer.onaddstream=a.onRemoteStreamAdded,objPeer.onicecandidate=function(e){null!=e.candidate?p.send(JSON.stringify({to:t,ice:e.candidate})):console.error("[WEBRTC2] ICE Candidate was null, done")},console.log("[WEBRTC2] Created peer connection for call, waiting for SDP")},a.getUserMediaConstraints=function(){var e={};e.audio=u,e.video=c;try{console.warn(i+"getSupportedConstraints: ",navigator.mediaDevices.getSupportedConstraints())}catch(e){console.error(i+"error on getSupportedConstraints",e)}return e},a.createPublishingConnection=function(o){connect_attempts=0,console.assert(!(o in d)),f=!0,u||c?navigator.mediaDevices.getUserMedia(a.getUserMediaConstraints()).then(function(e){console.log("[WEBRTC2] Local stream successfully received");var t=new RTCPeerConnection(m);t.strPeerUID=o,(d[o]=t).onaddstream=a.onRemoteStreamAdded,t.onicecandidate=function(e){null!=e.candidate?p.send(JSON.stringify({to:o,ice:e.candidate})):console.error("[WEBRTC2] ICE Candidate was null, done")},t.onconnectionstatechange=function(e){console.error("[WEBRTC2] Connection state changed "+t.connectionState)},console.log("[WEBRTC2] Created peer connection for publishing"),t.addStream(e),console.log("[WEBRTC2] Local SDP set"),t.createOffer().then(function(e){t.setLocalDescription(e),console.log("[WEBRTC2] Sending SDP offer"),sdp={to:o,sdp:e},p.send(JSON.stringify(sdp)),console.warn("[WEBRTC2] Streaming (1)")}).catch(function(e){console.error("[WEBRTC2] error on createOffer ",e)})}).catch(function(e,t){console.error("[WEBRTC2] error on getUserMedia a1 = ",e),console.error("[WEBRTC2] error on getUserMedia a2 = ",t)}):console.error("[WEBRTC2] Publisher must send audio or video stream")},a.onIncomingSDP=function(o,r,n){n.sdp=n.sdp.replace(/profile-level-id=[^;]+/,"profile-level-id=42e01f"),console.log("[WEBRTC2] Incoming SDP from "+o+": "+JSON.stringify(n)),r.setRemoteDescription(n).then(function(){console.log("[WEBRTC2] Remote SDP set"),f?(console.assert("answer"===n.type),console.log("[WEBRTC2] Got SDP answer from "+o)):(console.assert("offer"===n.type),console.log("[WEBRTC2] Got SDP offer from "+o),onLocalDescription=function(e){console.log("[WEBRTC2] Got local description: "+JSON.stringify(e)),r.setLocalDescription(e).then(function(){var e,t;console.log("[WEBRTC2] Sending SDP answer to "+o),n={to:o,sdp:r.localDescription},p.send(JSON.stringify(n)),console.warn("[WEBRTC2] Streaming (2)"),e=s.play(),t="",window.Promise&&(t=window.Promise.toString()),-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")?e.catch(function(e){console.error(i+"_checkAutoplay, error:",e),"NotAllowedError"==e.name?(console.error(i+"_checkAutoPlay: error.name:","NotAllowedError"),a.onAutoplayBlocked()):"AbortError"==e.name&&CloudHelpers.isSafari()?(console.error(i+"_checkAutoPlay: AbortError (Safari)"),a.onAutoplayBlocked()):(console.error(e),console.error(i+"checkAutoplay: happened something else"))}).then(function(){console.log(i+"checkAutoplay: then")}):console.error(i+"_checkAutoplay: could not work in your browser ",e)})},c||u?(console.log("[WEBRTC2] Watcher is configured to send stream"),navigator.mediaDevices.getUserMedia({audio:u,video:c}).then(function(e){r.addStream(e),console.log("[WEBRTC2] Local SDP set, creating answer"),r.createAnswer().then(onLocalDescription).catch(function(e){console.error("[WEBRTC2] error on createAnswer (1) ",e)})})):(console.log("[WEBRTC2] Creating answer without stream sending"),r.createAnswer().then(onLocalDescription).catch(function(e){console.error("[WEBRTC2] error on createAnswer (2) ",e)})))}).catch(function(e){console.error("[WEBRTC2] error on setRemoteDescription ",e)})},a.onIncomingICE=function(e,t,o){console.log("[WEBRTC2] Incoming ICE from "+e+": "+JSON.stringify(o));var r=new RTCIceCandidate(o);t.addIceCandidate(r).catch(function(e){console.error("[WEBRTC2] error on addIceCandidate ",e)})},a.onServerMessage=function(t){if(console.log("[WEBRTC2] Received "+t.data),t.data.startsWith("HELLO"))console.log("[WEBRTC2] Registered with server, waiting for stream");else{if(t.data.startsWith("SESSION_STARTED")){var e=t.data.split(" ")[1];return console.log("[WEBRTC2] Publisher "+e+" is going to start session"),void a.createWatchingConnection(e)}if(t.data.startsWith("SESSION_STOPPED")){e=t.data.split(" ")[1];return console.log("[WEBRTC2] Session of publisher "+e+" is terminated"),void(e in d&&(d[e]&&(d[e].close(),d[e]=null),delete d[e],s&&l===e&&a.reset()))}if(t.data.startsWith("START_SESSION")){e=t.data.split(" ")[1];return console.log("[WEBRTC2] Watcher "+e+" has come and awaiting for publishing"),void a.createPublishingConnection(e)}if(t.data.startsWith("ERROR"))a.handleIncomingError(t.data);else{var o=null,r="",n=null;try{r=(o=JSON.parse(t.data)).from,n=d[r]}catch(e){return void(e instanceof SyntaxError?a.handleIncomingError("Error parsing incoming JSON: "+t.data):a.handleIncomingError("Unknown error parsing response: "+t.data))}null!=o.sdp?a.onIncomingSDP(r,n,o.sdp):null!=o.ice?a.onIncomingICE(r,n,o.ice):a.handleIncomingError("Unknown incoming JSON: "+o)}}},a.stopWS=function(){p.close(),a.removeCalbacks()},a.onServerClose=function(e){for(strSessionPartnerPeerUID in console.error("[WEBRTC2] Closed WebRTC ",e),a.reset(),d)d[strSessionPartnerPeerUID]&&(d[strSessionPartnerPeerUID].close(),d[strSessionPartnerPeerUID]=null);d={}},a.onServerError=function(e){console.error("[WEBRTC2] Unable to connect to server, did you add an exception for the certificate?",e)},a.onRemoteStreamAdded=function(e){videoTracks=e.stream.getVideoTracks(),audioTracks=e.stream.getAudioTracks(),0<videoTracks.length||0<audioTracks.length?(console.log("[WEBRTC2] Incoming stream: "+videoTracks.length+" video tracks and "+audioTracks.length+" audio tracks"),s&&""===l&&(s.srcObject=e.stream,l=e.currentTarget.strPeerUID)):a.handleIncomingError("[WEBRTC2] Stream with unknown tracks added, resetting")},a.errorUserMediaHandler=function(){console.error("[WEBRTC2] Browser doesn't support getUserMedia!")},a.startWS=function(){if(a.connect_attempts++,3<a.connect_attempts)console.error("[WEBRTC2] Too many connection attempts, aborting. Refresh page to try again");else{console.log("[WEBRTC2] Connecting to server..."),(p=new WebSocket(n)).addEventListener("open",function(e){p.send("HELLO "+window.CloudPlayerWebRTC2.version),console.log("[WEBRTC2] Registering with server")}),p.addEventListener("error",a.onServerError),p.addEventListener("message",a.onServerMessage),p.addEventListener("close",a.onServerClose)}}},window.CloudPlayerWebRTC2.version="2.0.1",window.CloudCameraTimelineMode={},CloudCameraTimelineMode.MINUTES_MODE={name:"MINUTES_MODE",code:0},CloudCameraTimelineMode.HOUR_MODE={name:"HOUR_MODE",code:1},CloudCameraTimelineMode.HOURS_12_MODE={name:"HOURS_12_MODE",code:2},window.CloudCameraTimelineView=function(e,t,o){var _=this;t=_.options=t||{};var f=null,l=0,r=null,p=108e5,h={},n=0,g=!1,a=0,i=0,v=0,s=e,c=null,d=0,m=null,C=-1,y=-1,u=!1,A=0,P=0,E=!1,T=0,S=0,w=!1,b=null,I=null,R=null,k=CloudHelpers.createCallbacks(),O=null,M=null,D=null,N=null;function L(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}t.useTimezone&&(b=t.useTimezone,console.warn("[CloudTimeline] useTimezone: "+b)),void 0!==t.calendar&&(w=1==t.calendar),void 0!==t.polingRangeDataEveryInSec&&(I=parseInt(t.polingRangeDataEveryInSec));var x={HOURS_12_MODE:{len_ms:324e5,step_short:18e5,step_long:9e6},HOUR_MODE:{len_ms:54e5,step_short:3e5,step_long:18e5},MINUTES_MODE:{len_ms:9e5,step_short:6e4,step_long:3e5}},U=1086e4,H=L(x.MINUTES_MODE),j=document.createElement("div");j.classList.add("cloudcameratimeline"),j.classList.add("green"),j.classList.add("black"),D=o&&o.player?(O=o.player.getElementsByClassName("cloudplayer-timeline-container")[0],M=o.player.getElementsByClassName("cloudplayer-calendar-container")[0],o.player.getElementsByClassName("cloudplayer-live-container")[0]):(O=document.getElementsByClassName("cloudplayer-timeline-container")[0],M=document.getElementsByClassName("cloudplayer-calendar-container")[0],document.getElementsByClassName("cloudplayer-live-container")[0]),j.innerHTML='<div class="cloudcameratimeline-calendar" style="display: none"></div><div class="cloudcameratimeline-shift shift-minus">-1h</div><div class="cloudcameratimeline-left"></div><div class="cloudcameratimeline-content">\t\t<div class="cloudcameratimeline-scale"></div>\t\t<div class="cloudcameratimeline-data"></div>\t\t<div class="cloudcameratimeline-cursor"></div></div></div><div class="cloudcameratimeline-right"></div><div class="cloudcameratimeline-shift shift-plus">+1h</div><div class="cloudcameratimeline-goto-live disabled">Live</div>',_.left_border=Math.floor(CloudHelpers.getCurrentTimeUTC()-H.len_ms/2),_.right_border=Math.floor(_.left_border+H.len_ms);var z=j.getElementsByClassName("cloudcameratimeline-content")[0],F=j.getElementsByClassName("cloudcameratimeline-data")[0],B=j.getElementsByClassName("cloudcameratimeline-calendar")[0],W=j.getElementsByClassName("cloudcameratimeline-cursor")[0],G=j.getElementsByClassName("cloudcameratimeline-scale")[0],Y=j.getElementsByClassName("cloudcameratimeline-goto-live")[0],q=j.getElementsByClassName("cloudcameratimeline-left")[0],V=j.getElementsByClassName("cloudcameratimeline-right")[0],$=j.getElementsByClassName("shift-minus")[0],K=j.getElementsByClassName("shift-plus")[0];M.appendChild(B),D.appendChild(Y),_.elem=document.getElementById(e),N=null!=_.elem&&"DIV"===_.elem.tagName?(_.elem.appendChild(j),_.elem):(O.appendChild(j),O);var J=null;function X(){a!=G.offsetWidth&&0!=G.offsetWidth&&(a=G.offsetWidth),i=a/(_.right_border-_.left_border),v=(_.right_border-_.left_border)/a}function Z(e){var t=e;return t-=t%1e3,t-=t%p}function Q(){clearInterval(_._polingCursor),Y.classList.remove("now"),Y.classList.add("disabled")}function ee(){if(null!=f&&"camera"==f.type){var e=f.getID(),t=CloudHelpers.formatUTCTime(d);if(null==r._getAPI())return;r._getAPI().storageRecordsFirst(e,t,50).done(function(e){var t=!1;for(var o in e.objects){var r=e.objects[o],n=CloudHelpers.parseUTCTime(r.start),a=CloudHelpers.parseUTCTime(r.end),i=Z(n);Z(a);h[i]||(h[i]={status:1,data:[]});var s=0,l=0;for(var c in h[i].data){(u=h[i].data[c]).end>l&&(l=u.end),u.start<n&&n-2e3<u.end&&(a>u.end?(h[i].data[c].end=a,s=1,_._eventRedrawTimeline(),t=!0):s=2)}if(0==s&&l<a){var u={start:n,end:a};h[i].data.push(u),_._eventRedrawTimeline(),t=!0}d<a&&(d=a+CloudHelpers.ONE_SECOND)}t&&(k.executeCallbacks(CloudPlayerEvent.TIMELINE_END_UPDATED,{}),null!=m&&setTimeout(m.onTimelineEndUpdate,1))})}}function te(e){return Math.floor((e-_.left_border)*i)}function oe(e){if(e=e||{},null!=m&&null!=m.getSource()?m.isLive()?(Y.classList.remove("disabled"),Y.classList.add("now")):(Y.classList.remove("disabled"),Y.classList.remove("now")):(Y.classList.remove("now"),Y.classList.add("disabled")),n<_.left_border-1e3||n>_.right_border+1e3)"none"!=W.style.display&&(W.style.display="none");else if("inline-block"!=W.style.display&&(W.style.display="inline-block"),0!=n){var t=te(n);if(-5<t&&t<a)W.style.left=t+T+-10+"px",100*(a-t)/a<3&&("poling"!=e.sender&&"click"!=e.sender||_.isRange()||u||E||(console.log("[TIMELINE] Auto move if not user drag"),setTimeout(function(){console.log("[TIMELINE] mCursorPosition: "+n),_.moveToPosition(n)},100)));else"none"!=W.style.display&&(W.style.display="none")}else"none"!=W.style.display&&(W.style.display="none")}function re(){(new Date).getTime();var e=Z(_.left_border),t=Z(_.right_border)+p;if(t<e)return console.error("[ERROR] start must be more than end"),!1;if(_.isRange()){if(e<mRangeMin_Normalize)return console.error("[ERROR] Going beyond the range (start)"),!1;if(t>mRangeMax_Normalize)return console.error("[ERROR] Going beyond the range (end)"),!1}for(var o=F.getElementsByTagName("crect"),r=0,n=e;n<=t;n+=p){var a=h[n];if(a&&1==a.status)for(var i=0;i<a.data.length;i++)if(!(a.data[i].end<_.left_border||a.data[i].start>_.right_border)){var s=te(a.data[i].start),l=s+"px",c=te(a.data[i].end)-s+"px";if(r<o.length)o[r].style.display="",o[r].style.left=l,o[r].style.width=c,r++;else{var u='<crect style="left: '+l+"; width: "+c+'"></crect>';F.innerHTML+=u,r++}}}for(n=r;n<o.length;n++)"none"!=o[n].style.display&&(o[n].style.display="none")}function ne(t){var e=CloudHelpers.promise(),o=h[t];return o&&1==o.status?e.resolve():null!=f?(h[t]={},h[t].status=0,h[t].data=[],f.getTimeline(t,t+p).done(function(e){h[t]&&(h[t].status=1,h[t].data=e.periods),re()}).fail(function(){h[t]&&(h[t].status=-1),e.reject()})):e.reject(),e}function ae(t){f.getTimeline(t,t+p).done(function(e){(function(e,t){if(0==e.length&&0==t.length)return!1;for(var o=0;o<e.length;o++){for(var r=e[o],n=!1,a=0;a<t.length;a++){var i=t[a];r.start==i.start&&r.end==i.end&&(n=!0)}if(!n)return!0}for(a=0;a<t.length;a++){for(i=t[a],n=!1,o=0;o<e.length;o++)(r=e[o]).start==i.start&&r.end==i.end&&(n=!0);if(!n)return!0}return!1})(h[t].data,e.periods)&&(h[t].data=e.periods,re())})}function ie(){console.log("_reloadRangeData");var e=Z(C),t=Z(y)+p;if(null!=f)for(var o=e;o<=t;o+=p){var r=h[o];r&&1==r.status&&ae(o)}}function se(){console.log("_stopPolingRangeData"),clearInterval(R)}function le(){console.warn("_disposeTimeline"),d=0,h={},F.innerHTML="",Q(),clearInterval(c),se(),null!=J&&J.dispose()}function ce(){console.warn("_changedSource"),le(),null!=m?(f=m.getSource())?(l=b?CloudHelpers.getOffsetTimezone(b):CloudHelpers.getOffsetTimezone(f.getTimezone()),r=f._getConn(),null!=J&&J.setSource(f),Q(),_._polingCursor=setInterval(function(){null!=m?0!=m.getPosition()&&(n=m.getPosition()):n=0,oe({sender:"poling"})},1e3),clearInterval(c),d=CloudHelpers.getCurrentTimeUTC()-CloudHelpers.ONE_MINUTE,c=setInterval(ee,3e4),se(),null!=I&&_.isRange()&&(R=setInterval(function(){null!=f&&ie()},1e3*I))):(f=r=null,l=0):f=null,_.redrawTimeline({sender:"changed_source"})}function ue(e,t){console.warn("_playerEvent ",e),"SOURCE_CHANGED"==e.name?ce():"POSITION_JUMPED"==e.name&&(console.warn("POSITION_JUMPED",m),n=t.new_pos,oe({sender:"pos jumped"}),_.moveToPosition(t.new_pos))}function de(){T=0,"none"!=q.style.display&&(T+=80),S=0,"none"!=V.style.display&&(S+=80),0==T&&(T=80),0==S&&(S=80),z.style.width="calc(100% - "+(T+S)+"px)",z.style.left=T+"px",F.style.width="calc(100% - "+(T+S)+"px)",F.style.left=T+"px",G.style.width="calc(100% - "+(T+S)+"px)",G.style.left=T+"px"}if(B.onclick=function(){null!=J&&(console.log(m),m.player.classList.remove("showing-settings","showing-zoom"),J.toggleCalendar(B))},$.onclick=function(){var e=m.getPosition();0==e&&(e=CloudHelpers.getCurrentTimeUTC()),0!=e?(m.stop("by_timeline_2"),m.setPosition(e-36e5),_.moveToPosition(e-36e5),m.play()):console.log("Invalid current position")},K.onclick=function(){if(1!=m.isLive()){var e=m.getPosition();0==e&&(e=CloudHelpers.getCurrentTimeUTC()),0!=e?(m.stop("by_timeline_2"),m.setPosition(e+36e5),_.moveToPosition(e+36e5),m.play()):console.log("Invalid current position ")}},Y.onclick=function(e){if(null!=m&&null!=m.getSource()){var t=Y.classList.value;-1==t.indexOf("now")&&-1==t.indexOf("disabled")&&(m.setPosition(CloudPlayer.POSITION_LIVE),m.play(e),_.moveToPosition(CloudHelpers.getCurrentTimeUTC())),-1!=t.indexOf("now")&&_.moveToPosition(CloudHelpers.getCurrentTimeUTC())}},X(),_.removeCallback=function(e){k.removeCallback(e)},_.addCallback=function(e,t){k.addCallback(e,t)},_.reloadRangeData=function(){ie()},_.hideCalendarButton=function(){"none"!=B.style.display&&(B.style.display="none"),de(),_.redrawTimeline()},_.showCalendarButton=function(){"none"==B.style.display&&(B.style.display=""),de(),_.redrawTimeline()},_.hideArrowsButtons=function(){"none"!=q.style.display&&(q.style.display="none"),"none"!=V.style.display&&(V.style.display="none"),de(),_.redrawTimeline()},_.showArrowsButtons=function(){"none"==q.style.display&&(q.style.display=""),"none"==V.style.display&&(V.style.display=""),de(),_.redrawTimeline()},_.hideShiftButtons=function(){"none"!=$.style.display&&($.style.display="none"),"none"!=K.style.display&&(K.style.display="none"),de(),_.redrawTimeline()},_.showShiftButtons=function(){"none"==$.style.display&&($.style.display=""),"none"==K.style.display&&(K.style.display=""),de(),_.redrawTimeline()},_.hideGotoLiveButton=function(){"none"!=Y.style.display&&(Y.style.display="none"),de(),_.redrawTimeline()},_.showGotoLiveButton=function(){"none"==Y.style.display&&(Y.style.display=""),de(),_.redrawTimeline()},_.setPlayer=function(e){le(),m&&m.removeCallback(s),e?(null!=(m=e)?w&&((J=new CloudCameraCalendarView(m.getCalendarContent(),t)).onChangeDate=function(e,t){null!=m?(m.setPosition(e-l),_.moveToPosition(e-l),m.play(t)):console.error("[TIMELINE] player is null")},_.calendar=J):console.error("[TIMELINE] player is null"),ce(),m.addCallback(s,ue),m.setFullscreenCallback(function(){console.warn("fullscreenCallback"),_.redrawTimeline()})):(m=null,ce())},_.setRange=function(e,t){console.warn("[TIMELINE] setRange todo"),C=e,y=t,mRangeMin_Normalize=Z(e),mRangeMax_Normalize=Z(t)+p,N.classList.add("range"),X();var o=y-C,r=C,n=y;if(o<=U)_.hideArrowsButtons(),_.hideShiftButtons(),H.len_ms=o,_.left_border=Math.floor(r),_.right_border=Math.floor(n);else{n=C+U,H.len_ms=U;var a=CloudHelpers.getCurrentTimeUTC();a<y&&C<a&&n<a&&(n=a+Math.floor(U/2),y<n&&(n=y),r=n-U),_.left_border=Math.floor(r),_.right_border=Math.floor(n)}_.redrawTimeline({sender:"animation"})},_.isRange=function(){return-1!=C&&-1!=y},_.resetRange=function(){console.warn("[TIMELINE] resetRange"),y=C=-1,N.classList.remove("range"),_.showArrowsButtons(),_.showShiftButtons(),X()},_.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"],_.dateFormat=function(e,t,o){var r="";if(_.isRange()){var n=(e=((e=Math.floor((e-C)/1e3))-e%60)/60)%60;r=("00"+(e-n)/60).slice(-2)+":"+("00"+n).slice(-2)}else{var a=new Date;a.setTime(e+l);var i=a.getUTCHours(),s="";o&&(s=12<=i?" pm":" am",i=0==i?12:12<i?i-12:i);r=("00"+i).slice(-2)+":"+("00"+a.getUTCMinutes()).slice(-2);r+=s,t&&(r+=" ("+a.getUTCDate()+" "+_.months[a.getUTCMonth()]+")")}return r},_._eventRedrawTimeline=function(){setTimeout(_.redrawTimeline,10)},_.redrawTimeline=function(e){if(e=e||{},g)console.warn("redrawTimeline busy");else{g=!0,X();var t=Math.floor(_.left_border/H.step_short),o=Math.floor(_.right_border/H.step_short)+1;_.isRange()&&(_.left_border<=C?q.classList.add("disabled"):q.classList.remove("disabled"),_.right_border>=y?V.classList.add("disabled"):V.classList.remove("disabled")),G.innerHTML='<vtext id="texttimelinetest"><vtext>';var r=document.getElementById("texttimelinetest");if(r){r.innerHTML=_.dateFormat(_.left_border,!1,!0===_.options.timelineampm);var n=r.clientWidth;r.innerHTML=_.dateFormat(_.left_border,!0,!0===_.options.timelineampm);for(var a=r.clientWidth,i=H.step_long;i<n*v;)i+=H.step_long;var s=2*i;G.innerHTML+="<hline></hline>";for(var l=t;l<o;l++){var c=l*H.step_short,u=te(c);if(c%H.step_long==0){var d=c%s==0,m=u-(d?a:n)/2;G.innerHTML+='<vline style="left: '+u+'px"></vline>',c%i==0&&(G.innerHTML+='<vtext style="left: '+m+'px">'+_.dateFormat(c,d,!0===_.options.timelineampm)+"</vtext>")}else G.innerHTML+='<vline style="left: '+u+'px"></vline>'}if(oe(e),null!=f)if(function(e,t){var o=Z(e),r=Z(t)+p;if(r<o)return console.error("[ERROR] start must be more than end"),!1;for(var n=!0,a=o;a<=r;a+=p)h[a]?1!=h[a].status&&(n=!1):n=!1;return n}(_.left_border,_.right_border))re();else{if(_.isRange()&&(_.left_border<mRangeMin_Normalize||_.right_border>mRangeMax_Normalize))return void(g=!1);!function(e,t){var o=Z(e),r=Z(t)+p;if(r<o)return console.error("[ERROR] start must be more than end");if(_.isRange()){if(e<mRangeMin_Normalize)return console.error("[ERROR] Going beyond the range (left)");if(r>mRangeMax_Normalize)return console.error("[ERROR] Going beyond the range (right)")}if(null!=f)for(var n=o;n<=r;n+=p){var a=h[n];(!a||a&&-1==a.status)&&ne(n)}}(_.left_border,_.right_border)}g=!1}}},_.redrawTimeline(),_.onTimeLineResize=function(){_.redrawTimeline()},window.addEventListener("resize",_.onTimeLineResize),_.animationTo=function(t,o,r){E=!0,r=r||H;var n=25,e=t-_.left_border,a=o-_.right_border;if(0==e&&0==a)return console.warn("Already in current position"),_.redrawTimeline({sender:"animation"}),void(E=!1);for(var i=r.step_short-H.step_short,s=r.step_long-H.step_long,l=0!=i&&0!=s,c=(_.left_border,_.right_border,[]),u=3.14/n,d=0,m=0;m<n;m++){d+=C=Math.sin(m*u),c.push({k:C})}var f=e/d,p=a/d,h=i/d,g=s/d,v=c[0].k;c[0].left=_.left_border+v*f,c[0].right=_.right_border+v*p,l&&(c[0].step_short=H.step_short+v*h,c[0].step_long=H.step_long+v*g);for(m=1;m<n;m++){var C=c[m].k;c[m].left=c[m-1].left+C*f,c[m].right=c[m-1].right+C*p,l&&(c[m].step_short=c[m-1].step_short+C*h,c[m].step_long=c[m-1].step_short+C*g)}c[n-1].left=t,c[n-1].right=o;var y=0;setTimeout(function e(){_.left_border=Math.floor(c[y].left),_.right_border=Math.floor(c[y].right),l&&(H.step_short=Math.floor(c[y].step_short),H.step_long=Math.floor(c[y].step_long)),_.redrawTimeline({sender:"animation"}),++y<n?setTimeout(e,10):(l&&(H=L(r)),_.left_border=t,_.right_border=o,_.redrawTimeline({sender:"animation"}),E=!1)},15)},_.fixBorderLimit=function(e,t){var o={};if(o.left=e,o.right=t,_.isRange())o.right>y&&(o.right=y,o.left=o.right-H.len_ms),o.left<C&&(o.left=C,o.right=o.left+H.len_ms);else{var r=CloudHelpers.getCurrentTimeUTC()+H.len_ms/2;if(o.right>r){var n=o.right-r;o.left=o.left-n,o.right=o.right-n}}return o},_.moveToRight=function(){var e=_.right_border-_.left_border;e=Math.floor(.75*e);var t=_.left_border+e,o=_.right_border+e,r=_.fixBorderLimit(t,o);_.animationTo(r.left,r.right)},V.onclick=_.moveToRight,_.moveToLeft=function(){var e=_.right_border-_.left_border;e=Math.floor(.75*e);var t=_.left_border-e,o=_.right_border-e,r=_.fixBorderLimit(t,o);_.animationTo(r.left,r.right)},q.onclick=_.moveToLeft,_.moveToPosition=function(e){console.log("moveToPosition");var t=Math.floor((_.right_border-_.left_border)/2),o=e-t,r=e+t;_.isRange()&&(o<C||y<r)?console.error("Can not move beyond range"):_.animationTo(o,r)},_.mousedown=function(e){if(!u){A=e.offsetX,P=e.offsetX,u=!0,z.style.cursor="move";try{window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}catch(e){console.error(e)}}},_.mousemove=function(e){if(u&&!_.isRange()){var t=e.offsetX-P;if(void 0!==e.movementX&&(t=e.movementX),0!=t){var o=Math.floor(t*v);P+=t;var r=_.fixBorderLimit(_.left_border-o,_.right_border-o);_.left_border=r.left,_.right_border=r.right,_.redrawTimeline({sender:"mousemove"})}}},_.mouseup=function(e){u&&(z.style.cursor="default",u=!1)},_.mouseout=function(e){if(u){if(e.relatedTarget&&"CRECT"==e.relatedTarget.nodeName||e.target&&"CRECT"==e.target.nodeName)return;if(e.relatedTarget&&"cloudcameratimeline-cursor"==e.relatedTarget.className||e.target&&"cloudcameratimeline-cursor"==e.target.className)return;z.style.cursor="default",u=!1}},z.addEventListener("mousedown",_.mousedown),z.addEventListener("mousemove",_.mousemove),z.addEventListener("mouseup",_.mouseup),z.addEventListener("mouseout",_.mouseout),F.onclick=function(e){if(null!=m)if(null!=f){if(A==P){var t=e.currentTarget.getBoundingClientRect(),o=e.clientX-t.left,r=Math.floor(o*v);(r+=_.left_border)>=CloudHelpers.getCurrentTimeUTC()&&m?(n=CloudHelpers.getCurrentTimeUTC(),oe({sender:"click"}),m.stop("by_timeline_1"),m.setPosition(CloudPlayer.POSITION_LIVE),m.play(),k.executeCallbacks(CloudPlayerEvent.USER_CLICKED_ON_TIMELINE,{pos:CloudPlayer.POSITION_LIVE})):r&&m?(n=r,oe({sender:"click"}),m.stop("by_timeline_2"),m.setPosition(r),m.play(),k.executeCallbacks(CloudPlayerEvent.USER_CLICKED_ON_TIMELINE,{pos:r})):oe({sender:"click"})}}else console.log("[CloudCameraTimeline] source is null");else console.log("[CloudCameraTimeline] player is null")},_.setMode=function(e){var t=null;if(!x[e.name])return console.error("Unknown timeline mode"),-1;t=x[e.name];var o=(_.right_border-_.left_border)/2+_.left_border,r=L(t),n=t.len_ms/2;return _.animationTo(o-n,o+n,r),0},_.getMode=function(){return H},_.destroy=function(){if(window.removeEventListener("resize",_.onTimeLineResize),_.elem&&"DIV"===_.elem.tagName)for(;_.elem.firstChild;)_.elem.firstChild.remove();clearInterval(c)},void 0!==t.arrows&&(1==t.arrows?_.showArrowsButtons():_.hideArrowsButtons()),void 0!==t.gotoLive&&(1==t.gotoLive?_.showGotoLiveButton():_.hideGotoLiveButton()),void 0!==t.range){var me=t.range.min,fe=t.range.max;_.setRange(me,fe)}w?_.showCalendarButton():_.hideCalendarButton(),console.log("options: ",t)},window.CloudCameraCalendarView=function(e,t){var r=e;t=t||{};var a=this,o=null,y={},n=null,i=null,s=(new Date).getMonth(),l=(new Date).getFullYear(),c=100*l+s,u=100*l+s;function d(e,t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t%12]+" "+e}function _(e,t,o){return e+"-"+("00"+(t+1)).slice(-2)+"-"+("00"+o).slice(-2)}function m(e,t){var o=new Date;o.setFullYear(e),o.setMonth(t),o.setDate(1);var r=o.getDay(),n=(t-1+12)%12,a=0==t?e-1:e,i=(t+1+12)%12,s=11==t?e+1:e,l=new Date(s,i,0),c=l.getDate(),u=l.getDay(),d=new Date(a,n+1,0).getDate(),m=["Su","Mo","Tu","We","Th","Fr","Sa"],f=[];d=d-r+1;for(var p=0;p<r;p++)f.push({d:d,cl:"disabled",dt:_(s,i,d)}),d++;for(p=1;p<=c;p++)f.push({d:p,cl:"",dt:_(e,t,p)});var h=0;for(p=u+1;p<7;p++)h++,f.push({d:h,cl:"disabled",dt:_(s,i,h)});for(p=0;p<y.length;p++)for(var g=y[p],v=0;v<f.length;v++)f[v].dt===g&&(f[v].cl+="active-day");var C='<div class="cal-row week">';for(p=0;p<m.length;p++)C+='<div class="cal-day name">'+m[p]+"</div>";C+="</div>",C+='<div class="cal-row">';for(p=0;p<f.length;p++)p%7==0&&0<p&&(C+='</div><div class="cal-row">'),C+='<div class="cal-day '+f[p].cl+'" dt="'+f[p].dt+'">'+f[p].d+"</div>";return C+="</div>"}r.innerHTML='\t<div class="cloudcameracalendar-header">\t\t<div class="cloudcameracalendar-prev-month"></div>\t\t<div class="cloudcameracalendar-title">'+d(l,s)+"</div>\t\t<div class=\"cloudcameracalendar-next-month\"></div>\t</div>\t<div class='cloudcameracalendar-table'>"+m(l,s)+"\t</div>";r.getElementsByClassName("cloudcameracalendar-close")[0];var f=r.getElementsByClassName("cloudcameracalendar-prev-month")[0],p=r.getElementsByClassName("cloudcameracalendar-next-month")[0],h=r.getElementsByClassName("cloudcameracalendar-table")[0],g=r.getElementsByClassName("cloudcameracalendar-title")[0];a.renderContent=function(){g.innerHTML=d(l,s),h.innerHTML=m(l,s);for(var e=r.getElementsByClassName("active-day"),t=0;t<e.length;t++)e[t].onclick=function(e){var t=this.getAttribute("dt");a.onChangeDate&&a.onChangeDate(Date.parse(t),e)};var o=100*l+s;f.style.display=o<=c?"none":"",p.style.display=u<=o?"none":""},a.renderContent(),a.updateActivity=function(){if(null==o)return console.log("[CALENDAR] mConn is null"),y=[],void a.renderContent();mApi=o._getAPI(),mApi&&mApi.storageActivity(n,!0).done(function(e){i=new Date,y=e.objects;for(var t=0;t<y.length;t++){var o=y[t].split("-"),r=parseInt(o[1],10)-1,n=100*parseInt(o[0],10)+r;u=0==t?c=n:(c=Math.min(n,c),Math.max(n,u))}a.renderContent()})},a.setSource=function(e){s=(new Date).getMonth(),l=(new Date).getFullYear(),(i=null)!=e?(o=e._getConn(),n=e.getID(),CloudHelpers.getOffsetTimezone(e.getTimezone()),a.updateActivity()):(o=null,0,y=[],a.renderContent())},a.dispose=function(){o=null},f.onclick=function(){(s-=1)<0&&(s=11,l-=1),a.renderContent()},p.onclick=function(){11<(s+=1)&&(s=0,l+=1),a.renderContent()},a.isVisible=function(){return""!==r.style.display},a.showCalendar=function(){if(console.log("[CALENDAR] show"),r.style.display="block",null!=o)if(null!=i){var e=new Date;e.setUTCHours(24),e.setUTCMinutes(0),e.setUTCSeconds(0),(new Date).getTime()>e.getTime()&&i.getTime()<e.getTime()&&a.updateActivity()}else a.updateActivity();else a.renderContent()},a.hideCalendar=function(){console.log("[CALENDAR] hide"),r.style.display=""},a.toggleCalendar=function(e){console.log("[CALENDAR] toggle"),a.isVisible()?(a.hideCalendar(),e.classList.remove("shadowed")):(a.showCalendar(),e.classList.add("shadowed"))}},window.CloudSessionTimeline=function(e){var C=this,m=null,t={};function y(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}t.h12={to:"min",len_ms:324e5,step_short:18e5,step_long:9e6},t.hr={to:"h12",len_ms:54e5,step_short:3e5,step_long:18e5},t.min={to:"hr",len_ms:9e5,step_short:6e4,step_long:3e5};var _=y(t.min);if(C.elem=document.getElementById(e),null==C.elem)return console.error("[CloudPlayerTimeline] Not found element"),null;if("DIV"!=C.elem.tagName)return console.error("[CloudPlayerTimeline] Expected DIV tag but got "+C.elem.tagName),null;C.elem.classList.add("cloudplayertimeline"),C.elem.classList.add("green"),C.elem.classList.add("black"),C.elem.innerHTML='<div class="cloudplayertimeline-content">\t\t<div class="cloudplayertimeline-scale session"></div>\t\t<div class="cloudplayertimeline-data session"></div>\t\t<div class="cloudplayertimeline-cursor"></div></div>',C.left_border=CloudHelpers.getCurrentTimeUTC()-_.len_ms/2,C.right_border=C.left_border+_.len_ms,C.el_data=C.elem.getElementsByClassName("cloudplayertimeline-data")[0];var f=C.elem.getElementsByClassName("cloudplayertimeline-cursor")[0];function o(){clearInterval(C._polingCursor)}C.el_scale=C.elem.getElementsByClassName("cloudplayertimeline-scale")[0],C.setPlayer=function(e){o(),C.plr=e,C.plr&&(o(),C._polingCursor=setInterval(function(){var e=C.plr.getPosition();if((e<C.left_border||e>C.right_border)&&"none"!=f.style.display&&(f.style.display="none"),"inline-block"!=f.style.display&&(f.style.display="inline-block"),0!=e){var t=C.calcPosition(e)+50+"px";f.style.left=t}},1e3))},C.calcPosition=function(e){return Math.floor((e-C.left_border)*C.distPx)},C.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"],C.dateFormat=function(e,t){var o=new Date;o.setTime(e);var r=("00"+o.getUTCHours()).slice(-2)+":"+("00"+o.getUTCMinutes()).slice(-2);return t&&(r+=" ("+o.getUTCDate()+" "+C.months[o.getUTCMonth()]+")"),r},C.redrawTimeline=function(){null!=(m=null!=C.plr?C.plr.getSource():null)&&(C.left_border=m.getStartTime(),C.right_border=m.getEndTime(),_.step_short=(C.right_border-C.left_border)/20),f.style.display="none",C.containerWidth=C.el_scale.offsetWidth,C.distPx=C.containerWidth/(C.right_border-C.left_border),C.distSec=(C.right_border-C.left_border)/C.containerWidth;var e=Math.floor(C.left_border/_.step_short),t=Math.floor(C.right_border/_.step_short)+1;C.el_data.innerHTML="",C.el_scale.innerHTML='<vtext id="texttimelinetest"><vtext>';var o=document.getElementById("texttimelinetest");o.innerHTML=C.dateFormat(C.left_border,!1);var r=o.clientWidth;o.innerHTML=C.dateFormat(C.left_border,!0);for(var n=o.clientWidth,a=_.step_long;r*C.distSec>a;)a+=_.step_long;var i=2*a;C.el_scale.innerHTML+="<hline></hline>";for(var s=e;s<t;s++){var l=s*_.step_short,c=C.calcPosition(l);if(l%_.step_long==0){var u=l%i==0,d=c-(u?n:r)/2;C.el_scale.innerHTML+='<vline style="left: '+c+'px"></vline>',l%a==0&&(C.el_scale.innerHTML+='<vtext style="left: '+d+'px">'+C.dateFormat(l,u)+"</vtext>")}else C.el_scale.innerHTML+='<vline style="left: '+c+'px"></vline>'}C.el_data.innerHTML="",null!=m&&m.getTimeline(C.left_border,C.right_border).done(function(e){var t=e.periods;C.el_data.innerHTML="";for(var o=0;o<t.length;o++){var r=C.calcPosition(t[o].start),n='<crect style="left: '+r+"px; width: "+(C.calcPosition(t[o].end)-r)+'px"></crect>';C.el_data.innerHTML+=n}}).fail(function(e){console.error(e)})},C.redrawTimeline(),window.addEventListener("resize",C.redrawTimeline),C.animationTo=function(e,t,o){o=o||_;for(var r=25,n=e-C.left_border,a=t-C.right_border,i=o.step_short-_.step_short,s=o.step_long-_.step_long,l=0!=i&&0!=s,c=[],u=[],d=[],m=[],f=3.14/r,p=0,h=0;h<r;h++){p+=g=Math.sin(h*f)}for(h=0;h<r;h++){var g=Math.sin(h*(3.14/r));c.push(g*(n/p)),u.push(g*(a/p)),l&&(d.push(g*(i/p)),m.push(g*(s/p)))}var v=0;setTimeout(function e(){C.left_border+=c[v],C.right_border+=u[v],l&&(_.step_short+=d[v],_.step_long+=m[v]),C.redrawTimeline(),++v<r?setTimeout(e,10):(l&&(_=y(o)),C.redrawTimeline())},15)},C.fixBorderLimit=function(e,t){var o={};o.left=e,o.right=t;var r=CloudHelpers.getCurrentTimeUTC()+_.len_ms/2;if(o.right>r){var n=o.right-r;o.left=o.left-n,o.right=o.right-n}return o},C._clickOnData=function(e){if(null!=C.plr)if(null!=m){var t=Math.floor(e.offsetX*C.distSec);(t+=C.left_border)&&C.plr&&(C.plr.stop("by_session_timeline_1"),C.plr.setPosition(t),C.plr.play())}else console.log("[CloudCameraTimeline] source is null");else console.log("[CloudCameraTimeline] player is null")},C.el_data.onclick=C._clickOnData,C._startMove=!1,C._lastMoveX=0,C.mousedown=function(e){C._lastMoveX=e.offsetX,C._startMove=!0,C.el_data.style.cursor="move"},C.mousemove=function(e){if(C._startMove){var t=e.offsetX-C._lastMoveX;if(0!=t){var o=Math.floor(t*C.distSec);C._lastMoveX=e.offsetX;var r=C.fixBorderLimit(C.left_border-o,C.right_border-o);C.left_border=r.left,C.right_border=r.right,C.redrawTimeline()}}},C.mouseup=function(e){C._startMove=!1,C.el_data.style.cursor="default"},C.el_data.addEventListener("mousedown",C.mousedown),C.el_data.addEventListener("mousemove",C.mousemove),C.el_data.addEventListener("mouseup",C.mouseup),C.el_data.addEventListener("mouseout",C.mouseup)},window.CloudSDK=window.CloudSDK||{},CloudSDK.version="3.0.18",CloudSDK.datebuild="200702",console.log("CloudSDK.version="+CloudSDK.version+"_"+CloudSDK.datebuild),window.CloudPlayerSDK=function(e,t){console.log(t);var o=this;o.options=t||{},o.player=null,o.conn=null,o.filter=null,o.cm=null,o.mCameraID=null;var r=CloudPlayer.POSITION_LIVE;if(o.camera=null,o.svcp_url=null,o.sharedKey=null,o.playerElementID=null,window._CloudPlayerSDK=window._CloudPlayerSDK||{},!e||""===e)throw"Player container element ID is required.";if(o.playerElementID=e,-1===o.playerElementID.indexOf("%")&&(o.playerElementID=encodeURIComponent(o.playerElementID)),o.conn=new CloudShareConnection(o.options),window._CloudPlayerSDK[e])throw"Oops! CloudPlayerSDK instance with player element ID: "+e+" already exist. Try use another ID.";window._CloudPlayerSDK[e]={},o.player=new CloudPlayer(e,o.options),console.log("self.options: ",o.options),null!=o.options.timeline&&0!=o.options.timeline&&(o.timeline=new CloudCameraTimelineView(o.options.timeline,o.options,o.player),o.timeline.setPlayer(o.player),o.player.player.classList.add("with-timeline"),o.player.calendar=o.timeline.calendar,console.log(o.player)),o.setSource=function(e){if(!e||""===e)return o.player._showerror(CloudReturnCode.ERROR_ACCESS_TOKEN_REQUIRED),CloudReturnCode.ERROR_ACCESS_TOKEN_REQUIRED;try{var t=atob(e);t=JSON.parse(t),console.log("[CloudPlayerSDK] access_token: ",t),t.token&&t.camid&&t.access&&""!==t.token&&""!==t.camid&&""!==t.access&&(o.sharedKey=t.token,o.mCameraID=t.camid),t.svcp&&""!=t.svcp&&(o.svcp_url=t.svcp),t.api&&""!=t.api&&(o.svcp_url=("file:"==location.protocol?"http:":location.protocol)+"//"+t.api,"http:"==location.protocol||"file:"==location.protocol?o.svcp_url+=t.api_p?":"+t.api_p:"":"https:"==location.protocol&&(o.svcp_url+=t.api_sp?":"+t.api_sp:""),o.svcp_url+="/",t.path&&""!=t.path&&(o.svcp_url+=t.path,o.svcp_url+="/"))}catch(e){return o.player._showerror(CloudReturnCode.ERROR_INVALID_ACCESS_TOKEN_FORMAT),CloudReturnCode.ERROR_INVALID_ACCESS_TOKEN_FORMAT}o.player.stop("by_plrsdk_3"),null!=o.svcp_url&&(o.conn.ServiceProviderUrl=o.svcp_url.replace("file://","https://")),o.conn.open(o.sharedKey).done(function(e){o.conn&&(o.cm=new CloudCameraList(o.conn),o.cm.getCamera(o.mCameraID).done(function(e){o.camera=e,o.player.setSource(o.camera),console.log(o.camera),console.log(o.camera._origJson()),o.player.setPosition(r),o.timeline&&-1!=r&&o.timeline.moveToPosition(r),o.player.play()}).fail(function(e){console.log(e),o.player._showerror(CloudReturnCode.ERROR_CHANNEL_NOT_FOUND)}))}).fail(function(e){o.player._showerror(CloudReturnCode.ERROR_NETWORK_ERROR)})},o.getSource=function(){return o.sharedKey?o.sharedKey:CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.play=function(){if(!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;o.player.play()},o.stop=function(){if(!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;o.player.stop("by_plrsdk_1")},o.pause=function(){if(!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.close=function(){o.player.stop("by_plrsdk_2"),o.player.close(),o.player.player.innerHTML="",o.conn.close(),window._CloudPlayerSDK[e]&&delete window._CloudPlayerSDK[e]},o.destroy=function(){o.player.stop("by_plrsdk_2"),o.player.player.innerHTML="",o.player.destroy(),o.conn.close(),o.timeline&&o.timeline.destroy(),window._CloudPlayerSDK[o.playerElementID]&&delete window._CloudPlayerSDK[o.playerElementID]},o.isPlaying=function(){return o.camera?o.player.isPlaying():CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.setPosition=function(e){if(r=e,!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;o.player.stop("by_plrsdk_2"),o.player.setPosition(e),o.player.play()},o.getPosition=function(){return o.camera?o.player.getPosition():CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.showTimeline=function(e){return o.camera?o.timeline?(document.getElementById(o.options.timeline).style.display=e?"block":"hide",!0):(console.error(CloudReturnCode.ERROR_NOT_CONFIGURED.text),null):(console.error(CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED.text),null)},o.getChannelName=function(){return o.camera?o.camera.getName():CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.setRange=function(e,t){o.player.setRange(e,t),o.timeline&&o.timeline.setRange(e,t)},o.resetRange=function(){o.player.resetRange(),o.timeline&&o.timeline.resetRange()},o.mOnError_callback=null,o.onError=function(e){e?(o.mOnError_callback=e,o.player.onError(function(e,t){o.mOnError_callback(o,t)})):o.player.onError(null)},o.mOnChannelStatus_callback=null,o.onChannelStatus=function(e){if(!e)return o.mOnChannelStatus_callback=null,void o.player.onChannelStatus(null);o.mOnChannelStatus_callback=e,o.player.onChannelStatus(function(e,t){o.mOnChannelStatus_callback(o,t)})},o.addCallback=function(e,t){o.player.addCallback(e,t),o.timeline&&o.timeline.addCallback(e,t)},o.removeCallback=function(e){o.player.removeCallback(e),o.timeline&&o.timeline.removeCallback(e,func)}},window.StreamerSWF=window.StreamerSWF||{},StreamerSWF.elemId="streamer_swf",StreamerSWF.obj=void 0,StreamerSWF.log=function(e){console.log("[StreamerSWF] "+e)},StreamerSWF.warn=function(e){console.warn("[StreamerSWF] "+e)},StreamerSWF.error=function(e){console.error("[StreamerSWF] "+e)},StreamerSWF.startedPublish=function(){},StreamerSWF.stoppedPublish=function(){},StreamerSWF.showSecuritySettings=function(){},StreamerSWF.hideSecuritySettings=function(){},StreamerSWF.activityLevel=function(e){console.log("audio lvl "+e)},StreamerSWF.flash=function(){return StreamerSWF.obj?StreamerSWF.obj.vjs_activate||(StreamerSWF.obj=document.getElementById(StreamerSWF.elemId),StreamerSWF.obj||StreamerSWF.error("Element '"+StreamerSWF.elemId+"' not found"),StreamerSWF.log("reinit")):(StreamerSWF.obj=document.getElementById(StreamerSWF.elemId),StreamerSWF.obj||StreamerSWF.error("Element '"+StreamerSWF.elemId+"' not found"),StreamerSWF.log("Init")),StreamerSWF.obj},StreamerSWF.activate=function(e,t){var o=StreamerSWF.flash();if(o)if(o.vjs_activate){var r=StreamerSWF.private.is()||!1;o.vjs_activate(e,r,t)}else StreamerSWF.error("Function vjs_activate not found"),StreamerSWF.obj=void 0},StreamerSWF.support=function(){var e=StreamerSWF.flash();if(e)return e.vjs_support?e.vjs_support():(StreamerSWF.error("Function vjs_support not found"),void(StreamerSWF.obj=void 0))},StreamerSWF.status=function(){var e=StreamerSWF.flash();if(e)return e.vjs_status?e.vjs_status():(StreamerSWF.error("Function vjs_status not found"),void(StreamerSWF.obj=void 0))},StreamerSWF.deactivate=function(){var e=StreamerSWF.flash();e&&(e.vjs_deactivate?e.vjs_deactivate():(console.error("Function vjs_deactivate not found"),StreamerSWF.obj=void 0))},StreamerSWF.isActivated=function(){return"activated"==StreamerSWF.status()},StreamerSWF.isDeactivated=function(){return"deactivated"==StreamerSWF.status()},StreamerSWF.isTransitive=function(){return"transitive"==StreamerSWF.status()},StreamerSWF.private={},StreamerSWF.private.retry=function(e,t){var o=0,r=!1,n=window.setInterval(function(){e()&&(window.clearInterval(n),t(r)),50<o++&&(window.clearInterval(n),t(r=!0))},10)},StreamerSWF.private.isIE10OrLater=function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var o=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);if(o&&10<=parseInt(o[1],10))return!0;var r=/edge/.exec(t);return!(!r||"edge"!=r[0])},StreamerSWF.private.detectPrivateMode=function(t){var o;if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){o=!1},function(e){console.log(e),o=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{r=window.indexedDB.open("test")}catch(e){o=!0}void 0===o&&StreamerSWF.private.retry(function(){return"done"===r.readyState},function(e){e||(o=!r.result)})}else if(StreamerSWF.private.isIE10OrLater(window.navigator.userAgent)){o=!1;try{window.indexedDB||(o=!0)}catch(e){o=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){o=!0}void 0===o&&(o=!1,window.localStorage.removeItem("test"))}StreamerSWF.private.retry(function(){return void 0!==o},function(e){t(o)})},StreamerSWF.private.is=function(){return void 0===StreamerSWF.private.is_&&console.error("[StreamerSWF.private] cannot detect"),StreamerSWF.private.is_},StreamerSWF.private.detectPrivateMode(function(e){void 0===(StreamerSWF.private.is_=e)?console.error("[StreamerSWF.private] cannot detect"):(StreamerSWF.private.is_=e,console.log(e?"[StreamerSWF.private] private":"[StreamerSWF.private] not private"))});var ptzconfig={xRot:-48.6,zRot:145,xScale:1,yScale:1,xShift:0,yShift:0,zCamShift:.2,zZoom:-.6,xLens:1,zLens:1,divider:4,src:document.currentScript.src.replace(/(\/[^\/]+)$/,"/")};function changepztconfig(e,t){ptzconfig[t]=e}function testplay(){$("#player1_vjs_html5_api").attr("src","/video.mp4"),player1_vjs_html5_api.play()}function testplay2(){$("#player1_vjs_html5_api").attr("src","/fisheye.mp4"),player1_vjs_html5_api.play()}window.CloudPano=function(n,e){var u=this;u.container=n,u.player=e,u.beMouseDown=!1,u.bezRot=u.bexRot=0,u.beX=u.beY=0,u.model={vertex:[],indices:[],texture:[]},u.load_model=function(){if(!u.textureBuffer){var t;try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{t=new XMLHttpRequest}catch(e){t=!1}}}t.onreadystatechange=function(){if(!u.textureBuffer&&4==t.readyState&&200==t.status){for(u.model=JSON.parse(t.response),u.model.indices=[],c=0,i=0;i<u.model.vertex.length;i+=3)u.model.indices.push(c++);u.vertexBuffer=u.gl.createBuffer(),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.vertexBuffer),u.gl.bufferData(u.gl.ARRAY_BUFFER,new Float32Array(u.model.vertex),u.gl.STATIC_DRAW),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,null),u.indexBuffer=u.gl.createBuffer(),u.gl.bindBuffer(u.gl.ELEMENT_ARRAY_BUFFER,u.indexBuffer),u.gl.bufferData(u.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(u.model.indices),u.gl.STATIC_DRAW),u.gl.bindBuffer(u.gl.ELEMENT_ARRAY_BUFFER,null),u.textureBuffer=u.gl.createBuffer(),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.textureBuffer),u.gl.bufferData(u.gl.ARRAY_BUFFER,new Float32Array(u.model.texture),u.gl.STATIC_DRAW),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,null),console.log("[CloudPlayer] vehicles count is "+u.model.vertex.length/3)}},t.open("GET",ptzconfig.src+"model.json",!0),t.send(null)}},u.mouseMoveHandler=function(e){var t=e.clientX,o=e.clientY;u.beMouseDown||1!=e.buttons||(u.bezRot=ptzconfig.zRot,u.bexRot=ptzconfig.xRot,u.beMouseDown=!0,u.beX=t,u.beY=o),0==e.buttons&&(u.beMouseDown=!1),u.beMouseDown&&(ptzconfig.zRot=u.bezRot+(u.beX-t)/5,ptzconfig.xRot=u.bexRot+(u.beY-o)/5,0<ptzconfig.xRot&&(ptzconfig.xRot=0),ptzconfig.xRot<-65.2&&(ptzconfig.xRot=-65.2))},u.mouseWheelHandler=function(e){var t=(e=e||window.event).deltaY||e.detail||e.wheelDelta;ptzconfig.zZoom-=t/1e3,.6<ptzconfig.zZoom&&(ptzconfig.zZoom=.6),ptzconfig.zZoom<-.6&&(ptzconfig.zZoom=-.6),e.preventDefault()},u.createGLContext=function(){var e=document.createElement("div");e.style.top="90px",e.style.position="absolute",e.style.color="black",e.style.fontSize="12px",e.innerHTML='            <span style="background:rgba(255,255,255,.7);padding:0 5px">Смещение камеры по вертикали</span><br/>               <input style="width:250px" id="zCamShift" type="range" min="-1" max="2" step=".01" value="'+ptzconfig.zCamShift+'" onchange="changepztconfig(this.value,\'zCamShift\')"><br/>            <span for="zZoom" style="background:rgba(255,255,255,.7);padding:0 5px">Приближение</span><br/>                    <input style="width:250px" id="zZoom" type="range" min="-5" max="2" step=".1" value="'+ptzconfig.zZoom+'" onchange="changepztconfig(this.value,\'zZoom\')"><br/>            <span for="xRot" style="background:rgba(255,255,255,.7);padding:0 5px">Наклон камеры вниз</span><br/>              <input style="width:250px" id="xRot" type="range" min="-120" max="0" step="5" value="'+ptzconfig.xRot+'" onchange="changepztconfig(this.value,\'xRot\')"><br/>            <span for="xScale" style="background:rgba(255,255,255,.7);padding:0 5px">Масштабирование текстуры по X</span><br/> <input style="width:250px" id="xScale" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.xScale+'" onchange="changepztconfig(this.value,\'xScale\')"><br/>            <span for="yScale" style="background:rgba(255,255,255,.7);padding:0 5px">Масштабирование текстуры по Y</span><br/> <input style="width:250px" id="yScale" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.yScale+'" onchange="changepztconfig(this.value,\'yScale\')"><br/>            <span for="xShift" style="background:rgba(255,255,255,.7);padding:0 5px">Смещение текстуры по X</span><br/>        <input style="width:250px" id="xShift" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.xShift+'" onchange="changepztconfig(this.value,\'xShift\')"><br/>            <span for="yShift" style="background:rgba(255,255,255,.7);padding:0 5px">Смещение текстуры по Y</span><br/>        <input style="width:250px" id="yShift" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.yShift+'" onchange="changepztconfig(this.value,\'yShift\')"><br/>            <span for="zLens" style="background:rgba(255,255,255,.7);padding:0 5px">Коррекция выпуклости линзы</span><br/>     <input style="width:250px" id="yShift" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.zLens+'" onchange="changepztconfig(this.value,\'zLens\')"><br/>            <span for="xLens" style="background:rgba(255,255,255,.7);padding:0 5px">Коррекция масштаба линзы по X</span><br/>     <input style="width:250px" id="xLens" type="range" min=".5" max="2" step=".01" value="'+ptzconfig.xLens+'" onchange="changepztconfig(this.value,\'xLens\')"><br/>            <button onclick="testplay()">Проиграть тестовый пример</button>&nbsp;<button onclick="testplay2()">Проиграть второй пример</button>        ',u.canvas=document.createElement("canvas"),u.canvas.style.width="100%",u.canvas.style.height="100%",u.canvas.style.display="none",n.parentElement.insertBefore(canvas,n),u.canvas.setAttribute("width",n.parentElement.offsetWidth),u.canvas.setAttribute("height",n.parentElement.offsetHeight),u.canvas.addEventListener("mousemove",u.mouseMoveHandler),u.canvas.addEventListener("wheel",u.mouseWheelHandler);for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o=0;o<t.length;++o){var r;try{r=u.canvas.getContext(t[o])}catch(e){continue}if(r)return r}throw new Error("WebGL is not supported!")},u.compileShader=function(t,e,o){var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e),t.compileShader(r),i(r);var n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(n,o),t.compileShader(n),i(n);var a=t.createProgram();return t.attachShader(a,r),t.attachShader(a,n),t.linkProgram(a),a;function i(e){if(!t.getShaderParameter(e,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(e))}},u.run=function(r){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(!n)throw new Error("do not support 'requestAnimationFram'");n(function e(t){a||(a=t);var o=t-a;a=t;r(o);n(e)});var a=null},u.ptz_enabled=!1,u.start=function(){u.load_model(),u.ptz_enabled=!0,u.canvas.style.display="block",u.container.style.visibility="hidden",u.container.style.position="fixed",u.container.style.top="0",u.container.style.height="1px",u.container.style.width="1px",u.container.style.zIndex="-1"},u.stop=function(){u.ptz_enabled=!1,u.canvas.style.display="none",u.container.style.visibility="",u.container.style.position="",u.container.style.top="",u.container.style.height="",u.container.style.width="",u.container.style.zIndex=""},u.model,u.gl=createGLContext();var t=u.compileShader(u.gl,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform float fCamShift;\n        uniform float zLens;\n        varying vec2 vTextureCoord;\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition.x, aVertexPosition.y, aVertexPosition.z*zLens+fCamShift, 1.0);\n            vTextureCoord = aTextureCoord;\n        }","        precision mediump float;\n        varying vec2 vTextureCoord;\n        uniform sampler2D uSampler;\n        uniform vec4 uScale;\n        void main(void) {\n            gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x / uScale.x + uScale.z, vTextureCoord.y / uScale.y + uScale.w));\n        }");function d(e){return e*Math.PI/180}return u.gl.useProgram(t),u.aVertexPosition=u.gl.getAttribLocation(t,"aVertexPosition"),u.aTextureCoord=u.gl.getAttribLocation(t,"aTextureCoord"),u.uSampler=u.gl.getUniformLocation(t,"uSampler"),u.uScale=u.gl.getUniformLocation(t,"uScale"),u.pMatrixUniform=u.gl.getUniformLocation(t,"uPMatrix"),u.mvMatrixUniform=u.gl.getUniformLocation(t,"uMVMatrix"),u.fCamShift=u.gl.getUniformLocation(t,"fCamShift"),u.zLens=u.gl.getUniformLocation(t,"zLens"),u.texture=function(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);var o=e.RGBA,r=e.RGBA,n=e.UNSIGNED_BYTE,a=new Uint8Array([0,0,0,255]);return e.texImage2D(e.TEXTURE_2D,0,o,1,1,0,r,n,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameterf(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameterf(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t}(gl),u.mvMatrix=mat4.create(),u.pMatrix=mat4.create(),u.run(function(e){if(u.ptz_enabled&&u.textureBuffer&&u.indexBuffer){for(var t,o,r,n,a,i,s,l=u.container.querySelectorAll("video"),c=0;c<l.length;++c)if("none"!=getComputedStyle(l[c],null).display&&"none"!=getComputedStyle(l[c].parentElement,null).display){t=l[c];break}o=u.gl,r=u.texture,n=t,a=o.RGBA,i=o.RGBA,s=o.UNSIGNED_BYTE,o.bindTexture(o.TEXTURE_2D,r),o.texImage2D(o.TEXTURE_2D,0,a,i,s,n),u.gl.clearColor(0,0,0,1),u.gl.enable(gl.DEPTH_TEST),u.gl.clear(u.gl.COLOR_BUFFER_BIT|u.gl.DEPTH_BUFFER_BIT),player.isPlaying()&&(u.gl.viewport(0,0,u.canvas.width,u.canvas.height),mat4.perspective(45,u.canvas.width/u.canvas.height,.1,100,u.pMatrix),mat4.identity(u.mvMatrix),mat4.translate(u.mvMatrix,[0,0,ptzconfig.zZoom]),mat4.rotate(u.mvMatrix,d(ptzconfig.xRot),[1,0,0]),mat4.rotate(u.mvMatrix,d(ptzconfig.zRot),[0,0,1]),u.gl.enableVertexAttribArray(u.aVertexPosition),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.vertexBuffer),u.gl.vertexAttribPointer(aVertexPosition,3,u.gl.FLOAT,!1,0,0),u.gl.enableVertexAttribArray(u.aTextureCoord),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.textureBuffer),u.gl.vertexAttribPointer(u.aTextureCoord,2,u.gl.FLOAT,!1,0,0),u.gl.activeTexture(u.gl.TEXTURE0),u.gl.bindTexture(u.gl.TEXTURE_2D,u.texture),u.gl.pixelStorei(u.gl.UNPACK_FLIP_Y_WEBGL,!0),u.gl.uniform1i(u.uSampler,0),u.gl.uniform4f(u.uScale,ptzconfig.xScale,ptzconfig.yScale,ptzconfig.xShift,ptzconfig.yShift),u.gl.bindBuffer(u.gl.ELEMENT_ARRAY_BUFFER,u.indexBuffer),u.gl.uniformMatrix4fv(u.pMatrixUniform,!1,u.pMatrix),u.gl.uniformMatrix4fv(u.mvMatrixUniform,!1,u.mvMatrix),u.gl.uniform1f(u.fCamShift,ptzconfig.zCamShift),u.gl.uniform1f(u.zLens,ptzconfig.zLens),u.gl.drawElements(u.gl.TRIANGLES,u.model.vertex.length/3,u.gl.UNSIGNED_SHORT,model.indices))}}),this},glMatrixArrayType="undefined"!=typeof Float32Array?Float32Array:"undefined"!=typeof WebGLFloatArray?WebGLFloatArray:Array;var vec3={create:function(e){var t=new glMatrixArrayType(3);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2]),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},add:function(e,t,o){return o&&e!=o?(o[0]=e[0]+t[0],o[1]=e[1]+t[1],o[2]=e[2]+t[2],o):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e)},subtract:function(e,t,o){return o&&e!=o?(o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2],o):(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e)},negate:function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},scale:function(e,t,o){return o&&e!=o?(o[0]=e[0]*t,o[1]=e[1]*t,o[2]=e[2]*t,o):(e[0]*=t,e[1]*=t,e[2]*=t,e)},normalize:function(e,t){t||(t=e);var o=e[0],r=e[1],n=e[2],a=Math.sqrt(o*o+r*r+n*n);return t[2]=a?1==a?(t[0]=o,t[1]=r,n):(a=1/a,t[0]=o*a,t[1]=r*a,n*a):(t[0]=0,t[1]=0,0),t},cross:function(e,t,o){o||(o=e);var r=e[0],n=e[1];e=e[2];var a=t[0],i=t[1];return t=t[2],o[0]=n*t-e*i,o[1]=e*a-r*t,o[2]=r*i-n*a,o},length:function(e){var t=e[0],o=e[1];return e=e[2],Math.sqrt(t*t+o*o+e*e)},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},direction:function(e,t,o){o||(o=e);var r=e[0]-t[0],n=e[1]-t[1];return e=e[2]-t[2],(t=Math.sqrt(r*r+n*n+e*e))?(t=1/t,o[0]=r*t,o[1]=n*t,o[2]=e*t):(o[0]=0,o[1]=0,o[2]=0),o},lerp:function(e,t,o,r){return r||(r=e),r[0]=e[0]+o*(t[0]-e[0]),r[1]=e[1]+o*(t[1]-e[1]),r[2]=e[2]+o*(t[2]-e[2]),r},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"}},mat3={create:function(e){var t=new glMatrixArrayType(9);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9]),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(t&&e!=t)return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t;var o=e[1],r=e[2],n=e[5];return e[1]=e[3],e[2]=e[6],e[3]=o,e[5]=e[7],e[6]=r,e[7]=n,e},toMat4:function(e,t){return t||(t=mat4.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"}},mat4={create:function(e){var t=new glMatrixArrayType(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transpose:function(e,t){if(t&&e!=t)return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t;var o=e[1],r=e[2],n=e[3],a=e[6],i=e[7],s=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=o,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=a,e[11]=e[14],e[12]=n,e[13]=i,e[14]=s,e},determinant:function(e){var t=e[0],o=e[1],r=e[2],n=e[3],a=e[4],i=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],m=e[11],f=e[12],p=e[13],h=e[14];return f*u*s*n-c*p*s*n-f*i*d*n+a*p*d*n+c*i*h*n-a*u*h*n-f*u*r*l+c*p*r*l+f*o*d*l-t*p*d*l-c*o*h*l+t*u*h*l+f*i*r*m-a*p*r*m-f*o*s*m+t*p*s*m+a*o*h*m-t*i*h*m-c*i*r*(e=e[15])+a*u*r*e+c*o*s*e-t*u*s*e-a*o*d*e+t*i*d*e},inverse:function(e,t){t||(t=e);var o=e[0],r=e[1],n=e[2],a=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=e[9],m=e[10],f=e[11],p=e[12],h=e[13],g=e[14],v=e[15],C=o*s-r*i,y=o*l-n*i,_=o*c-a*i,A=r*l-n*s,P=r*c-a*s,E=n*c-a*l,T=u*h-d*p,S=u*g-m*p,w=u*v-f*p,b=d*g-m*h,I=d*v-f*h,R=m*v-f*g,k=1/(C*R-y*I+_*b+A*w-P*S+E*T);return t[0]=(s*R-l*I+c*b)*k,t[1]=(-r*R+n*I-a*b)*k,t[2]=(h*E-g*P+v*A)*k,t[3]=(-d*E+m*P-f*A)*k,t[4]=(-i*R+l*w-c*S)*k,t[5]=(o*R-n*w+a*S)*k,t[6]=(-p*E+g*_-v*y)*k,t[7]=(u*E-m*_+f*y)*k,t[8]=(i*I-s*w+c*T)*k,t[9]=(-o*I+r*w-a*T)*k,t[10]=(p*P-h*_+v*C)*k,t[11]=(-u*P+d*_-f*C)*k,t[12]=(-i*b+s*S-l*T)*k,t[13]=(o*b-r*S+n*T)*k,t[14]=(-p*A+h*y-g*C)*k,t[15]=(u*A-d*y+m*C)*k,t},toRotationMat:function(e,t){return t||(t=mat4.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},toMat3:function(e,t){return t||(t=mat3.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},toInverseMat3:function(e,t){var o=e[0],r=e[1],n=e[2],a=e[4],i=e[5],s=e[6],l=e[8],c=e[9],u=e[10],d=u*i-s*c,m=-u*a+s*l,f=c*a-i*l,p=o*d+r*m+n*f;return p?(p=1/p,t||(t=mat3.create()),t[0]=d*p,t[1]=(-u*r+n*c)*p,t[2]=(s*r-n*i)*p,t[3]=m*p,t[4]=(u*o-n*l)*p,t[5]=(-s*o+n*a)*p,t[6]=f*p,t[7]=(-c*o+r*l)*p,t[8]=(i*o-r*a)*p,t):null},multiply:function(e,t,o){o||(o=e);var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],l=e[5],c=e[6],u=e[7],d=e[8],m=e[9],f=e[10],p=e[11],h=e[12],g=e[13],v=e[14];e=e[15];var C=t[0],y=t[1],_=t[2],A=t[3],P=t[4],E=t[5],T=t[6],S=t[7],w=t[8],b=t[9],I=t[10],R=t[11],k=t[12],O=t[13],M=t[14];return t=t[15],o[0]=C*r+y*s+_*d+A*h,o[1]=C*n+y*l+_*m+A*g,o[2]=C*a+y*c+_*f+A*v,o[3]=C*i+y*u+_*p+A*e,o[4]=P*r+E*s+T*d+S*h,o[5]=P*n+E*l+T*m+S*g,o[6]=P*a+E*c+T*f+S*v,o[7]=P*i+E*u+T*p+S*e,o[8]=w*r+b*s+I*d+R*h,o[9]=w*n+b*l+I*m+R*g,o[10]=w*a+b*c+I*f+R*v,o[11]=w*i+b*u+I*p+R*e,o[12]=k*r+O*s+M*d+t*h,o[13]=k*n+O*l+M*m+t*g,o[14]=k*a+O*c+M*f+t*v,o[15]=k*i+O*u+M*p+t*e,o},multiplyVec3:function(e,t,o){o||(o=t);var r=t[0],n=t[1];return t=t[2],o[0]=e[0]*r+e[4]*n+e[8]*t+e[12],o[1]=e[1]*r+e[5]*n+e[9]*t+e[13],o[2]=e[2]*r+e[6]*n+e[10]*t+e[14],o},multiplyVec4:function(e,t,o){o||(o=t);var r=t[0],n=t[1],a=t[2];return t=t[3],o[0]=e[0]*r+e[4]*n+e[8]*a+e[12]*t,o[1]=e[1]*r+e[5]*n+e[9]*a+e[13]*t,o[2]=e[2]*r+e[6]*n+e[10]*a+e[14]*t,o[3]=e[3]*r+e[7]*n+e[11]*a+e[15]*t,o},translate:function(e,t,o){var r=t[0],n=t[1];if(t=t[2],!o||e==o)return e[12]=e[0]*r+e[4]*n+e[8]*t+e[12],e[13]=e[1]*r+e[5]*n+e[9]*t+e[13],e[14]=e[2]*r+e[6]*n+e[10]*t+e[14],e[15]=e[3]*r+e[7]*n+e[11]*t+e[15],e;var a=e[0],i=e[1],s=e[2],l=e[3],c=e[4],u=e[5],d=e[6],m=e[7],f=e[8],p=e[9],h=e[10],g=e[11];return o[0]=a,o[1]=i,o[2]=s,o[3]=l,o[4]=c,o[5]=u,o[6]=d,o[7]=m,o[8]=f,o[9]=p,o[10]=h,o[11]=g,o[12]=a*r+c*n+f*t+e[12],o[13]=i*r+u*n+p*t+e[13],o[14]=s*r+d*n+h*t+e[14],o[15]=l*r+m*n+g*t+e[15],o},scale:function(e,t,o){var r=t[0],n=t[1];return t=t[2],o&&e!=o?(o[0]=e[0]*r,o[1]=e[1]*r,o[2]=e[2]*r,o[3]=e[3]*r,o[4]=e[4]*n,o[5]=e[5]*n,o[6]=e[6]*n,o[7]=e[7]*n,o[8]=e[8]*t,o[9]=e[9]*t,o[10]=e[10]*t,o[11]=e[11]*t,o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],o):(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=n,e[5]*=n,e[6]*=n,e[7]*=n,e[8]*=t,e[9]*=t,e[10]*=t,e[11]*=t,e)},rotate:function(e,t,o,r){var n=o[0],a=o[1];o=o[2];var i=Math.sqrt(n*n+a*a+o*o);if(!i)return null;1!=i&&(n*=i=1/i,a*=i,o*=i);var s=Math.sin(t),l=Math.cos(t),c=1-l;t=e[0],i=e[1];var u=e[2],d=e[3],m=e[4],f=e[5],p=e[6],h=e[7],g=e[8],v=e[9],C=e[10],y=e[11],_=n*n*c+l,A=a*n*c+o*s,P=o*n*c-a*s,E=n*a*c-o*s,T=a*a*c+l,S=o*a*c+n*s,w=n*o*c+a*s;return n=a*o*c-n*s,a=o*o*c+l,r?e!=r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=t*_+m*A+g*P,r[1]=i*_+f*A+v*P,r[2]=u*_+p*A+C*P,r[3]=d*_+h*A+y*P,r[4]=t*E+m*T+g*S,r[5]=i*E+f*T+v*S,r[6]=u*E+p*T+C*S,r[7]=d*E+h*T+y*S,r[8]=t*w+m*n+g*a,r[9]=i*w+f*n+v*a,r[10]=u*w+p*n+C*a,r[11]=d*w+h*n+y*a,r},rotateX:function(e,t,o){var r=Math.sin(t);t=Math.cos(t);var n=e[4],a=e[5],i=e[6],s=e[7],l=e[8],c=e[9],u=e[10],d=e[11];return o?e!=o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]):o=e,o[4]=n*t+l*r,o[5]=a*t+c*r,o[6]=i*t+u*r,o[7]=s*t+d*r,o[8]=n*-r+l*t,o[9]=a*-r+c*t,o[10]=i*-r+u*t,o[11]=s*-r+d*t,o},rotateY:function(e,t,o){var r=Math.sin(t);t=Math.cos(t);var n=e[0],a=e[1],i=e[2],s=e[3],l=e[8],c=e[9],u=e[10],d=e[11];return o?e!=o&&(o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]):o=e,o[0]=n*t+l*-r,o[1]=a*t+c*-r,o[2]=i*t+u*-r,o[3]=s*t+d*-r,o[8]=n*r+l*t,o[9]=a*r+c*t,o[10]=i*r+u*t,o[11]=s*r+d*t,o},rotateZ:function(e,t,o){var r=Math.sin(t);t=Math.cos(t);var n=e[0],a=e[1],i=e[2],s=e[3],l=e[4],c=e[5],u=e[6],d=e[7];return o?e!=o&&(o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]):o=e,o[0]=n*t+l*r,o[1]=a*t+c*r,o[2]=i*t+u*r,o[3]=s*t+d*r,o[4]=n*-r+l*t,o[5]=a*-r+c*t,o[6]=i*-r+u*t,o[7]=s*-r+d*t,o},frustum:function(e,t,o,r,n,a,i){i||(i=mat4.create());var s=t-e,l=r-o,c=a-n;return i[0]=2*n/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*n/l,i[6]=0,i[7]=0,i[8]=(t+e)/s,i[9]=(r+o)/l,i[10]=-(a+n)/c,i[11]=-1,i[12]=0,i[13]=0,i[14]=-a*n*2/c,i[15]=0,i},perspective:function(e,t,o,r,n){return t*=e=o*Math.tan(e*Math.PI/360),mat4.frustum(-t,t,-e,e,o,r,n)},ortho:function(e,t,o,r,n,a,i){i||(i=mat4.create());var s=t-e,l=r-o,c=a-n;return i[0]=2/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2/c,i[11]=0,i[12]=-(e+t)/s,i[13]=-(r+o)/l,i[14]=-(a+n)/c,i[15]=1,i},lookAt:function(e,t,o,r){r||(r=mat4.create());var n=e[0],a=e[1];e=e[2];var i=o[0],s=o[1],l=o[2];o=t[1];var c,u,d,m,f=t[2];return n==t[0]&&a==o&&e==f?mat4.identity(r):(o=n-t[0],f=a-t[1],t=e-t[2],c=s*(t*=m=1/Math.sqrt(o*o+f*f+t*t))-l*(f*=m),l=l*(o*=m)-i*t,i=i*f-s*o,(m=Math.sqrt(c*c+l*l+i*i))?(c*=m=1/m,l*=m,i*=m):i=l=c=0,s=f*i-t*l,u=t*c-o*i,d=o*l-f*c,(m=Math.sqrt(s*s+u*u+d*d))?(s*=m=1/m,u*=m,d*=m):d=u=s=0,r[0]=c,r[1]=s,r[2]=o,r[3]=0,r[4]=l,r[5]=u,r[6]=f,r[7]=0,r[8]=i,r[9]=d,r[10]=t,r[11]=0,r[12]=-(c*n+l*a+i*e),r[13]=-(s*n+u*a+d*e),r[14]=-(o*n+f*a+t*e),r[15]=1,r)},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"}};quat4={create:function(e){var t=new glMatrixArrayType(4);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},calculateW:function(e,t){var o=e[0],r=e[1],n=e[2];return t&&e!=t?(t[0]=o,t[1]=r,t[2]=n,t[3]=-Math.sqrt(Math.abs(1-o*o-r*r-n*n)),t):(e[3]=-Math.sqrt(Math.abs(1-o*o-r*r-n*n)),e)},inverse:function(e,t){return t&&e!=t?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t):(e[0]*=1,e[1]*=1,e[2]*=1,e)},length:function(e){var t=e[0],o=e[1],r=e[2];return e=e[3],Math.sqrt(t*t+o*o+r*r+e*e)},normalize:function(e,t){t||(t=e);var o=e[0],r=e[1],n=e[2],a=e[3],i=Math.sqrt(o*o+r*r+n*n+a*a);return t[3]=0==i?(t[0]=0,t[1]=0,t[2]=0,0):(i=1/i,t[0]=o*i,t[1]=r*i,t[2]=n*i,a*i),t},multiply:function(e,t,o){o||(o=e);var r=e[0],n=e[1],a=e[2];e=e[3];var i=t[0],s=t[1],l=t[2];return t=t[3],o[0]=r*t+e*i+n*l-a*s,o[1]=n*t+e*s+a*i-r*l,o[2]=a*t+e*l+r*s-n*i,o[3]=e*t-r*i-n*s-a*l,o},multiplyVec3:function(e,t,o){o||(o=t);var r=t[0],n=t[1],a=t[2];t=e[0];var i=e[1],s=e[2],l=(e=e[3])*r+i*a-s*n,c=e*n+s*r-t*a,u=e*a+t*n-i*r;return r=-t*r-i*n-s*a,o[0]=l*e+r*-t+c*-s-u*-i,o[1]=c*e+r*-i+u*-t-l*-s,o[2]=u*e+r*-s+l*-i-c*-t,o},toMat3:function(e,t){t||(t=mat3.create());var o=e[0],r=e[1],n=e[2],a=e[3],i=o+o,s=r+r,l=n+n,c=o*i,u=o*s;o*=l;var d=r*s;return r*=l,n*=l,i*=a,s*=a,a*=l,t[0]=1-(d+n),t[1]=u-a,t[2]=o+s,t[3]=u+a,t[4]=1-(c+n),t[5]=r-i,t[6]=o-s,t[7]=r+i,t[8]=1-(c+d),t},toMat4:function(e,t){t||(t=mat4.create());var o=e[0],r=e[1],n=e[2],a=e[3],i=o+o,s=r+r,l=n+n,c=o*i,u=o*s;o*=l;var d=r*s;return r*=l,n*=l,i*=a,s*=a,a*=l,t[0]=1-(d+n),t[1]=u-a,t[2]=o+s,t[3]=0,t[4]=u+a,t[5]=1-(c+n),t[6]=r-i,t[7]=0,t[8]=o-s,t[9]=r+i,t[10]=1-(c+d),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},slerp:function(e,t,o,r){r||(r=e);var n=o;return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]<0&&(n=-1*o),r[0]=1-o*e[0]+n*t[0],r[1]=1-o*e[1]+n*t[1],r[2]=1-o*e[2]+n*t[2],r[3]=1-o*e[3]+n*t[3],r},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"}},function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("rangeSlider",[],t):"object"==typeof exports?exports.rangeSlider=t():e.rangeSlider=t()}(window,function(){return function(o){var r={};function n(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return o[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}return n.m=o,n.c=r,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},t.delay=function(e,t){for(var o=arguments.length,r=Array(2<o?o-2:0),n=2;n<o;n++)r[n-2]=arguments[n];return setTimeout(function(){return e.apply(null,r)},t)},t.debounce=function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100;return function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.debouncing||(r.lastReturnVal=r.apply(window,t),r.debouncing=!0),clearTimeout(r.debounceTimeout),r.debounceTimeout=setTimeout(function(){r.debouncing=!1},n),r.lastReturnVal}};var r=t.isString=function(e){return e===""+e},a=(t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isNumberLike=function(e){return null!=e&&(r(e)&&isFinite(parseFloat(e))||isFinite(e))});t.getFirsNumberLike=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(!t.length)return null;for(var r=0,n=t.length;r<n;r++)if(a(t[r]))return t[r];return null},t.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.simpleExtend=function(e,t){var o={};for(var r in e)o[r]=e[r];for(var n in t)o[n]=t[n];return o},t.between=function(e,t,o){return e<t?t:o<e?o:e}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}}(),l=n(o(2)),c=n(o(0));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}o(3);var i=new RegExp("/[\\n\\t]/","g"),u="rangeSlider",d=l.supportsRange(),m={polyfill:!0,root:document,rangeClass:"rangeSlider",disabledClass:"rangeSlider--disabled",fillClass:"rangeSlider__fill",bufferClass:"rangeSlider__buffer",handleClass:"rangeSlider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"],min:null,max:null,step:null,value:null,buffer:null,stick:null,borderRadius:10,vertical:!1},a=function(){function s(e,t){!function(e,t){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this);var o=void 0,r=void 0,n=void 0;if(this.element=e,this.options=c.simpleExtend(m,t),this.polyfill=this.options.polyfill,this.vertical=this.options.vertical,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideStart=this.options.onSlideStart,this.onSlideEnd=this.options.onSlideEnd,this.onSlideEventsCount=-1,this.isInteractsNow=!1,this.needTriggerEvents=!1,this.polyfill||!d){this.options.buffer=this.options.buffer||parseFloat(this.element.getAttribute("data-buffer")),this.identifier="js-"+u+"-"+c.uuid(),this.min=c.getFirsNumberLike(this.options.min,parseFloat(this.element.getAttribute("min")),0),this.max=c.getFirsNumberLike(this.options.max,parseFloat(this.element.getAttribute("max")),100),this.value=c.getFirsNumberLike(this.options.value,this.element.value,parseFloat(this.element.value||this.min+(this.max-this.min)/2)),this.step=c.getFirsNumberLike(this.options.step,parseFloat(this.element.getAttribute("step"))||(o=1)),this.percent=null,c.isArray(this.options.stick)&&1<=this.options.stick.length?this.stick=this.options.stick:(r=this.element.getAttribute("stick"))&&1<=(n=r.split(" ")).length&&(this.stick=n.map(parseFloat)),this.stick&&1===this.stick.length&&this.stick.push(1.5*this.step),this._updatePercentFromValue(),this.toFixed=this._toFixed(this.step);var a=void 0;this.container=document.createElement("div"),l.addClass(this.container,this.options.fillClass),a=this.vertical?this.options.fillClass+"__vertical":this.options.fillClass+"__horizontal",l.addClass(this.container,a),this.handle=document.createElement("div"),l.addClass(this.handle,this.options.handleClass),a=this.vertical?this.options.handleClass+"__vertical":this.options.handleClass+"__horizontal",l.addClass(this.handle,a),this.range=document.createElement("div"),l.addClass(this.range,this.options.rangeClass),this.range.id=this.identifier;var i=e.getAttribute("title");i&&0<i.length&&this.range.setAttribute("title",i),this.options.bufferClass&&(this.buffer=document.createElement("div"),l.addClass(this.buffer,this.options.bufferClass),this.range.appendChild(this.buffer),a=this.vertical?this.options.bufferClass+"__vertical":this.options.bufferClass+"__horizontal",l.addClass(this.buffer,a)),this.range.appendChild(this.container),this.range.appendChild(this.handle),a=this.vertical?this.options.rangeClass+"__vertical":this.options.rangeClass+"__horizontal",l.addClass(this.range,a),c.isNumberLike(this.options.value)&&(this._setValue(this.options.value,!0),this.element.value=this.options.value),c.isNumberLike(this.options.buffer)&&this.element.setAttribute("data-buffer",this.options.buffer),c.isNumberLike(this.options.min)&&this.element.setAttribute("min",""+this.min),c.isNumberLike(this.options.max),this.element.setAttribute("max",""+this.max),(c.isNumberLike(this.options.step)||o)&&this.element.setAttribute("step",""+this.step),l.insertAfter(this.element,this.range),l.setCss(this.element,{position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this._handleDown=this._handleDown.bind(this),this._handleMove=this._handleMove.bind(this),this._handleEnd=this._handleEnd.bind(this),this._startEventListener=this._startEventListener.bind(this),this._changeEventListener=this._changeEventListener.bind(this),this._handleResize=this._handleResize.bind(this),this._init(),window.addEventListener("resize",this._handleResize,!1),l.addEventListeners(this.options.root,this.options.startEvent,this._startEventListener),this.element.addEventListener("change",this._changeEventListener,!1)}}return r(s,[{key:"update",value:function(e,t){return t&&(this.needTriggerEvents=!0),c.isObject(e)&&(c.isNumberLike(e.min)&&(this.element.setAttribute("min",""+e.min),this.min=e.min),c.isNumberLike(e.max)&&(this.element.setAttribute("max",""+e.max),this.max=e.max),c.isNumberLike(e.step)&&(this.element.setAttribute("step",""+e.step),this.step=e.step,this.toFixed=this._toFixed(e.step)),c.isNumberLike(e.buffer)&&this._setBufferPosition(e.buffer),c.isNumberLike(e.value)&&this._setValue(e.value)),this._update(),this.onSlideEventsCount=0,this.needTriggerEvents=!1,this}},{key:"destroy",value:function(){l.removeAllListenersFromEl(this,this.options.root),window.removeEventListener("resize",this._handleResize,!1),this.element.removeEventListener("change",this._changeEventListener,!1),this.element.style.cssText="",delete this.element[u],this.range&&this.range.parentNode.removeChild(this.range)}},{key:"_toFixed",value:function(e){return(e+"").replace(".","").length-1}},{key:"_init",value:function(){this.onInit&&"function"==typeof this.onInit&&this.onInit(),this._update(!1)}},{key:"_updatePercentFromValue",value:function(){this.percent=(this.value-this.min)/(this.max-this.min)}},{key:"_startEventListener",value:function(e,t){var o=this,r=e.target,n=!1;(1===e.which||"touches"in e)&&(l.forEachAncestors(r,function(e){return n=e.id===o.identifier&&!l.hasClass(e,o.options.disabledClass)},!0),n&&this._handleDown(e,t))}},{key:"_changeEventListener",value:function(e,t){if(!t||t.origin!==this.identifier){var o=e.target.value,r=this._getPositionFromValue(o);this._setPosition(r)}}},{key:"_update",value:function(e){var t=this.vertical?"offsetHeight":"offsetWidth";this.handleSize=l.getDimension(this.handle,t),this.rangeSize=l.getDimension(this.range,t),this.maxHandleX=this.rangeSize-this.handleSize,this.grabX=this.handleSize/2,this.position=this._getPositionFromValue(this.value),this.element.disabled?l.addClass(this.range,this.options.disabledClass):l.removeClass(this.range,this.options.disabledClass),this._setPosition(this.position),this.options.bufferClass&&this.options.buffer&&this._setBufferPosition(this.options.buffer),this._updatePercentFromValue(),!1!==e&&l.triggerEvent(this.element,"change",{origin:this.identifier})}},{key:"_handleResize",value:function(){var e=this;return c.debounce(function(){c.delay(function(){e._update()},300)},50)()}},{key:"_handleDown",value:function(e){if(this.isInteractsNow=!0,e.preventDefault(),l.addEventListeners(this.options.root,this.options.moveEvent,this._handleMove),l.addEventListeners(this.options.root,this.options.endEvent,this._handleEnd),!(-1<(" "+e.target.className+" ").replace(i," ").indexOf(this.options.handleClass))){var t=this.range.getBoundingClientRect(),o=this._getRelativePosition(e),r=this.vertical?t.bottom:t.left,n=this._getPositionFromNode(this.handle)-r,a=o-this.grabX;this._setPosition(a),n<=o&&o<n+2*this.options.borderRadius&&(this.grabX=o-n),this._updatePercentFromValue()}}},{key:"_handleMove",value:function(e){var t=this._getRelativePosition(e);this.isInteractsNow=!0,e.preventDefault(),this._setPosition(t-this.grabX)}},{key:"_handleEnd",value:function(e){e.preventDefault(),l.removeEventListeners(this.options.root,this.options.moveEvent,this._handleMove),l.removeEventListeners(this.options.root,this.options.endEvent,this._handleEnd),l.triggerEvent(this.element,"change",{origin:this.identifier}),(this.isInteractsNow||this.needTriggerEvents)&&this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.value,this.percent,this.position),this.onSlideEventsCount=0,this.isInteractsNow=!1}},{key:"_setPosition",value:function(e){var t,o=void 0,r=void 0,n=void 0,a=this._getValueFromPosition(c.between(e,0,this.maxHandleX));this.stick&&((r=a%(n=this.stick[0]))<(o=this.stick[1]||.1)?a-=r:Math.abs(n-r)<o&&(a=a-r+n)),t=this._getPositionFromValue(a),this.vertical?(this.container.style.height=t+this.grabX+"px",this.handle.style.webkitTransform="translateY(-"+t+"px)",this.handle.style.msTransform="translateY(-"+t+"px)",this.handle.style.transform="translateY(-"+t+"px)"):(this.container.style.width=t+this.grabX+"px",this.handle.style.webkitTransform="translateX("+t+"px)",this.handle.style.msTransform="translateX("+t+"px)",this.handle.style.transform="translateX("+t+"px)"),this._setValue(a),this.position=t,this.value=a,this._updatePercentFromValue(),(this.isInteractsNow||this.needTriggerEvents)&&(this.onSlideStart&&"function"==typeof this.onSlideStart&&0===this.onSlideEventsCount&&this.onSlideStart(this.value,this.percent,this.position),this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(this.value,this.percent,this.position)),this.onSlideEventsCount++}},{key:"_setBufferPosition",value:function(e){var t=!0;if(isFinite(e))e=parseFloat(e);else{if(!c.isString(e))return void console.warn("New position must be XXpx or XX%");0<e.indexOf("px")&&(t=!1),e=parseFloat(e)}if(isNaN(e))console.warn("New position is NaN");else if(this.options.bufferClass){var o=t?e:e/this.rangeSize*100;o<0&&(o=0),100<o&&(o=100),this.options.buffer=o;var r=this.options.borderRadius/this.rangeSize*100,n=o-r;n<0&&(n=0),this.vertical?(this.buffer.style.height=n+"%",this.buffer.style.bottom=.5*r+"%"):(this.buffer.style.width=n+"%",this.buffer.style.left=.5*r+"%"),this.element.setAttribute("data-buffer",o)}else console.warn("You disabled buffer, it's className is empty")}},{key:"_getPositionFromNode",value:function(e){for(var t=this.vertical?this.maxHandleX:0;null!==e;)t+=this.vertical?e.offsetTop:e.offsetLeft,e=e.offsetParent;return t}},{key:"_getRelativePosition",value:function(e){var t=this.range.getBoundingClientRect(),o=this.vertical?t.bottom:t.left,r=0,n=this.vertical?"pageY":"pageX";return void 0!==e[n]?r=e.touches&&e.touches.length?e.touches[0][n]:e[n]:void 0!==e.originalEvent?void 0!==e.originalEvent[n]?r=e.originalEvent[n]:e.originalEvent.touches&&e.originalEvent.touches[0]&&void 0!==e.originalEvent.touches[0][n]&&(r=e.originalEvent.touches[0][n]):e.touches&&e.touches[0]&&void 0!==e.touches[0][n]?r=e.touches[0][n]:!e.currentPoint||void 0===e.currentPoint.x&&void 0===e.currentPoint.y||(r=this.vertical?e.currentPoint.y:e.currentPoint.x),this.vertical&&(r-=window.pageYOffset),this.vertical?o-r:r-o}},{key:"_getPositionFromValue",value:function(e){var t=(e-this.min)/(this.max-this.min)*this.maxHandleX;return isNaN(t)?0:t}},{key:"_getValueFromPosition",value:function(e){var t=e/(this.maxHandleX||1),o=this.step*Math.round(t*(this.max-this.min)/this.step)+this.min;return Number(o.toFixed(this.toFixed))}},{key:"_setValue",value:function(e,t){(e!==this.value||t)&&(this.element.value=e,this.value=e,l.triggerEvent(this.element,"input",{origin:this.identifier}))}}],[{key:"create",value:function(e,o){var t=function(e){var t=e[u];t||(t=new s(e,o),e[u]=t)};e.length?Array.prototype.slice.call(e).forEach(function(e){t(e)}):t(e)}}]),s}();(t.default=a).version="0.4.10",a.dom=l,a.functions=c,e.exports=t.default},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportsRange=t.removeAllListenersFromEl=t.removeEventListeners=t.addEventListeners=t.insertAfter=t.triggerEvent=t.forEachAncestors=t.removeClass=t.addClass=t.hasClass=t.setCss=t.getDimension=t.getHiddenParentNodes=t.isHidden=t.detectIE=void 0;var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(o(0)),a="eventListenerList",r=(t.detectIE=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(0<t)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(0<e.indexOf("Trident/")){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var r=e.indexOf("Edge/");return 0<r&&parseInt(e.substring(r+5,e.indexOf(".",r)),10)})(),i=!(!window.PointerEvent||r)&&{passive:!1},s=t.isHidden=function(e){return 0===e.offsetWidth||0===e.offsetHeight||!1===e.open},c=t.getHiddenParentNodes=function(e){for(var t=[],o=e.parentNode;o&&s(o);)t.push(o),o=o.parentNode;return t},l=(t.getDimension=function(e,t){var o=c(e),r=o.length,n=[],a=e[t],i=function(e){void 0!==e.open&&(e.open=!e.open)};if(r){for(var s=0;s<r;s++)n.push({display:o[s].style.display,height:o[s].style.height,overflow:o[s].style.overflow,visibility:o[s].style.visibility}),o[s].style.display="block",o[s].style.height="0",o[s].style.overflow="hidden",o[s].style.visibility="hidden",i(o[s]);a=e[t];for(var l=0;l<r;l++)i(o[l]),o[l].style.display=n[l].display,o[l].style.height=n[l].height,o[l].style.overflow=n[l].overflow,o[l].style.visibility=n[l].visibility}return a},t.setCss=function(e,t){for(var o in t)e.style[o]=t[o];return e.style},t.hasClass=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")});t.addClass=function(e,t){l(e,t)||(e.className+=" "+t)},t.removeClass=function(e,t){var o=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(l(e,t)){for(;0<=o.indexOf(" "+t+" ");)o=o.replace(" "+t+" "," ");e.className=o.replace(/^\s+|\s+$/g,"")}},t.forEachAncestors=function(e,t,o){for(o&&t(e);e.parentNode&&!t(e);)e=e.parentNode;return e},t.triggerEvent=function(e,t,o){if(!n.isString(t))throw new TypeError("event name must be String");if(!(e instanceof HTMLElement))throw new TypeError("element must be HTMLElement");t=t.trim();var r=document.createEvent("CustomEvent");r.initCustomEvent(t,!1,!1,o),e.dispatchEvent(r)},t.insertAfter=function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},t.addEventListeners=function(t,e,o){e.forEach(function(e){t[a]||(t[a]={}),t[a][e]||(t[a][e]=[]),t.addEventListener(e,o,i),t[a][e].indexOf(o)<0&&t[a][e].push(o)})},t.removeEventListeners=function(o,e,r){e.forEach(function(e){var t=void 0;o.removeEventListener(e,r,!1),o[a]&&o[a][e]&&-1<(t=o[a][e].indexOf(r))&&o[a][e].splice(t,1)})},t.removeAllListenersFromEl=function(t,e){if(e[a]){for(var o in e[a])e[a][o].forEach(r,{eventName:o,el:e});e[a]={}}function r(e){e===t._startEventListener&&this.el.removeEventListener(this.eventName,e,!1)}},t.supportsRange=function(){var e=document.createElement("input");return e.setAttribute("type","range"),"text"!==e.type}},function(e,t,o){}])}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";function g(){return $e.apply(null,arguments)}function s(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function l(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function c(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function m(e,t){var o,r=[];for(o=0;o<e.length;++o)r.push(t(e[o],o));return r}function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){for(var o in t)v(t,o)&&(e[o]=t[o]);return v(t,"toString")&&(e.toString=t.toString),v(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,o,r){return he(e,t,o,r,!0).utc()}function C(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function h(e){if(null==e._isValid){var t=C(e),o=Ke.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&o);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function y(e){var t=p(NaN);return null!=e?f(C(t),e):C(t).userInvalidated=!0,t}function _(e,t){var o,r,n;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=C(t)),c(t._locale)||(e._locale=t._locale),0<Xe.length)for(o=0;o<Xe.length;o++)c(n=t[r=Xe[o]])||(e[r]=n);return e}function A(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Ze&&(Ze=!0,g.updateOffset(this),Ze=!1)}function P(e){return e instanceof A||null!=e&&null!=e._isAMomentObject}function E(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function T(e){var t=+e,o=0;return 0!==t&&isFinite(t)&&(o=E(t)),o}function i(e,t,o){var r,n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),i=0;for(r=0;r<n;r++)(o&&e[r]!==t[r]||!o&&T(e[r])!==T(t[r]))&&i++;return i+a}function S(e){!1===g.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function e(n,a){var i=!0;return f(function(){if(null!=g.deprecationHandler&&g.deprecationHandler(null,n),i){for(var e,t=[],o=0;o<arguments.length;o++){if(e="","object"==typeof arguments[o]){for(var r in e+="\n["+o+"] ",arguments[0])e+=r+": "+arguments[0][r]+", ";e=e.slice(0,-2)}else e=arguments[o];t.push(e)}S(n+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),i=!1}return a.apply(this,arguments)},a)}function a(e,t){null!=g.deprecationHandler&&g.deprecationHandler(e,t),Qe[e]||(S(t),Qe[e]=!0)}function w(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function n(e,t){var o,r=f({},e);for(o in t)v(t,o)&&(l(e[o])&&l(t[o])?(r[o]={},f(r[o],e[o]),f(r[o],t[o])):null!=t[o]?r[o]=t[o]:delete r[o]);for(o in e)v(e,o)&&!v(t,o)&&l(e[o])&&(r[o]=f({},r[o]));return r}function b(e){null!=e&&this.set(e)}function t(e,t){var o=e.toLowerCase();et[o]=et[o+"s"]=et[t]=e}function I(e){return"string"==typeof e?et[e]||et[e.toLowerCase()]:void 0}function R(e){var t,o,r={};for(o in e)v(e,o)&&(t=I(o))&&(r[t]=e[o]);return r}function o(e,t){tt[e]=t}function k(e,t,o){var r=""+Math.abs(e),n=t-r.length;return(0<=e?o?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+r}function r(e,t,o,r){var n=r;"string"==typeof r&&(n=function(){return this[r]()}),e&&(at[e]=n),t&&(at[t[0]]=function(){return k(n.apply(this,arguments),t[1],t[2])}),o&&(at[o]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function O(e,t){return e.isValid()?(t=M(t,e.localeData()),nt[t]=nt[t]||function(r){var e,n,t,a=r.match(ot);for(e=0,n=a.length;e<n;e++)at[a[e]]?a[e]=at[a[e]]:a[e]=(t=a[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,o="";for(t=0;t<n;t++)o+=w(a[t])?a[t].call(e,r):a[t];return o}}(t),nt[t](e)):e.localeData().invalidDate()}function M(e,t){var o=5;for(rt.lastIndex=0;0<=o&&rt.test(e);)e=e.replace(rt,function(e){return t.longDateFormat(e)||e}),rt.lastIndex=0,o-=1;return e}function D(e,o,r){Pt[e]=w(o)?o:function(e,t){return e&&r?r:o}}function N(e,t){return v(Pt,e)?Pt[e](t._strict,t._locale):new RegExp(L(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,o,r,n){return t||o||r||n})))}function L(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function x(e,o){var t,r=o;for("string"==typeof e&&(e=[e]),u(o)&&(r=function(e,t){t[o]=T(e)}),t=0;t<e.length;t++)Et[e[t]]=r}function U(e,n){x(e,function(e,t,o,r){o._w=o._w||{},n(e,o._w,o,r)})}function H(e){return j(e)?366:365}function j(e){return e%4==0&&e%100!=0||e%400==0}function z(t,o){return function(e){return null!=e?(B(this,t,e),g.updateOffset(this,o),this):F(this,t)}}function F(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function B(e,t,o){e.isValid()&&!isNaN(o)&&("FullYear"===t&&j(e.year())?e._d["set"+(e._isUTC?"UTC":"")+t](o,e.month(),W(o,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](o))}function W(e,t){if(isNaN(e)||isNaN(t))return NaN;var o,r=(t%(o=12)+o)%o;return e+=(t-r)/12,1===r?j(e)?29:28:31-r%7%2}function G(e,t){var o;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=T(t);else if(!u(t=e.localeData().monthsParse(t)))return e;return o=Math.min(e.date(),W(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,o),e}function Y(e){return null!=e?(G(this,e),g.updateOffset(this,!0),this):F(this,"Month")}function q(){function e(e,t){return t.length-e.length}var t,o,r=[],n=[],a=[];for(t=0;t<12;t++)o=p([2e3,t]),r.push(this.monthsShort(o,"")),n.push(this.months(o,"")),a.push(this.months(o,"")),a.push(this.monthsShort(o,""));for(r.sort(e),n.sort(e),a.sort(e),t=0;t<12;t++)r[t]=L(r[t]),n[t]=L(n[t]);for(t=0;t<24;t++)a[t]=L(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function V(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function $(e,t,o){var r=7+t-o;return-(7+V(e,0,r).getUTCDay()-t)%7+r-1}function K(e,t,o,r,n){var a,i,s=1+7*(t-1)+(7+o-r)%7+$(e,r,n);return i=s<=0?H(a=e-1)+s:s>H(e)?(a=e+1,s-H(e)):(a=e,s),{year:a,dayOfYear:i}}function J(e,t,o){var r,n,a=$(e.year(),t,o),i=Math.floor((e.dayOfYear()-a-1)/7)+1;return i<1?r=i+X(n=e.year()-1,t,o):i>X(e.year(),t,o)?(r=i-X(e.year(),t,o),n=e.year()+1):(n=e.year(),r=i),{week:r,year:n}}function X(e,t,o){var r=$(e,t,o),n=$(e+1,t,o);return(H(e)-r+n)/7}function Z(){function e(e,t){return t.length-e.length}var t,o,r,n,a,i=[],s=[],l=[],c=[];for(t=0;t<7;t++)o=p([2e3,1]).day(t),r=this.weekdaysMin(o,""),n=this.weekdaysShort(o,""),a=this.weekdays(o,""),i.push(r),s.push(n),l.push(a),c.push(r),c.push(n),c.push(a);for(i.sort(e),s.sort(e),l.sort(e),c.sort(e),t=0;t<7;t++)s[t]=L(s[t]),l[t]=L(l[t]),c[t]=L(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Q(){return this.hours()%12||12}function ee(e,t){r(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function te(e,t){return t._meridiemParse}function oe(e){return e?e.toLowerCase().replace("_","-"):e}function re(e){var t=null;if(!Kt[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=qt._abbr,require("./locale/"+e),ne(t)}catch(e){}return Kt[e]}function ne(e,t){var o;return e&&(o=c(t)?ie(e):ae(e,t))&&(qt=o),qt._abbr}function ae(e,t){if(null===t)return delete Kt[e],null;var o=$t;if(t.abbr=e,null!=Kt[e])a("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=Kt[e]._config;else if(null!=t.parentLocale){if(null==Kt[t.parentLocale])return Jt[t.parentLocale]||(Jt[t.parentLocale]=[]),Jt[t.parentLocale].push({name:e,config:t}),null;o=Kt[t.parentLocale]._config}return Kt[e]=new b(n(o,t)),Jt[e]&&Jt[e].forEach(function(e){ae(e.name,e.config)}),ne(e),Kt[e]}function ie(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return qt;if(!s(e)){if(t=re(e))return t;e=[e]}return function(e){for(var t,o,r,n,a=0;a<e.length;){for(t=(n=oe(e[a]).split("-")).length,o=(o=oe(e[a+1]))?o.split("-"):null;0<t;){if(r=re(n.slice(0,t).join("-")))return r;if(o&&o.length>=t&&i(n,o,!0)>=t-1)break;t--}a++}return null}(e)}function se(e){var t,o=e._a;return o&&-2===C(e).overflow&&(t=o[St]<0||11<o[St]?St:o[wt]<1||o[wt]>W(o[Tt],o[St])?wt:o[bt]<0||24<o[bt]||24===o[bt]&&(0!==o[It]||0!==o[Rt]||0!==o[kt])?bt:o[It]<0||59<o[It]?It:o[Rt]<0||59<o[Rt]?Rt:o[kt]<0||999<o[kt]?kt:-1,C(e)._overflowDayOfYear&&(t<Tt||wt<t)&&(t=wt),C(e)._overflowWeeks&&-1===t&&(t=Ot),C(e)._overflowWeekday&&-1===t&&(t=Mt),C(e).overflow=t),e}function le(e,t,o){return null!=e?e:null!=t?t:o}function ce(e){var t,o,r,n,a,i,s=[];if(!e._d){for(a=e,i=void 0,i=new Date(g.now()),r=a._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()],e._w&&null==e._a[wt]&&null==e._a[St]&&function(e){var t,o,r,n,a,i,s,l;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)a=1,i=4,o=le(t.GG,e._a[Tt],J(ge(),1,4).year),r=le(t.W,1),((n=le(t.E,1))<1||7<n)&&(l=!0);else{a=e._locale._week.dow,i=e._locale._week.doy;var c=J(ge(),a,i);o=le(t.gg,e._a[Tt],c.year),r=le(t.w,c.week),null!=t.d?((n=t.d)<0||6<n)&&(l=!0):null!=t.e?(n=t.e+a,(t.e<0||6<t.e)&&(l=!0)):n=a}r<1||r>X(o,a,i)?C(e)._overflowWeeks=!0:null!=l?C(e)._overflowWeekday=!0:(s=K(o,r,n,a,i),e._a[Tt]=s.year,e._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(n=le(e._a[Tt],r[Tt]),(e._dayOfYear>H(n)||0===e._dayOfYear)&&(C(e)._overflowDayOfYear=!0),o=V(n,0,e._dayOfYear),e._a[St]=o.getUTCMonth(),e._a[wt]=o.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[bt]&&0===e._a[It]&&0===e._a[Rt]&&0===e._a[kt]&&(e._nextDay=!0,e._a[bt]=0),e._d=(e._useUTC?V:function(e,t,o,r,n,a,i){var s=new Date(e,t,o,r,n,a,i);return e<100&&0<=e&&isFinite(s.getFullYear())&&s.setFullYear(e),s}).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[bt]=24),e._w&&void 0!==e._w.d&&e._w.d!==e._d.getDay()&&(C(e).weekdayMismatch=!0)}}function ue(e){var t,o,r,n,a,i,s=e._i,l=Xt.exec(s)||Zt.exec(s);if(l){for(C(e).iso=!0,t=0,o=eo.length;t<o;t++)if(eo[t][1].exec(l[1])){n=eo[t][0],r=!1!==eo[t][2];break}if(null==n)return void(e._isValid=!1);if(l[3]){for(t=0,o=to.length;t<o;t++)if(to[t][1].exec(l[3])){a=(l[2]||" ")+to[t][0];break}if(null==a)return void(e._isValid=!1)}if(!r&&null!=a)return void(e._isValid=!1);if(l[4]){if(!Qt.exec(l[4]))return void(e._isValid=!1);i="Z"}e._f=n+(a||"")+(i||""),fe(e)}else e._isValid=!1}function de(e,t,o,r,n,a){var i,s,l=[(i=e,s=parseInt(i,10),s<=49?2e3+s:s<=999?1900+s:s),Ut.indexOf(t),parseInt(o,10),parseInt(r,10),parseInt(n,10)];return a&&l.push(parseInt(a,10)),l}function me(e){var t,o,r,n=ro.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(n){var a=de(n[4],n[3],n[2],n[5],n[6],n[7]);if(t=n[1],o=a,r=e,t&&Ft.indexOf(t)!==new Date(o[0],o[1],o[2]).getDay()&&(C(r).weekdayMismatch=!0,!(r._isValid=!1)))return;e._a=a,e._tzm=function(e,t,o){if(e)return no[e];if(t)return 0;var r=parseInt(o,10),n=r%100;return(r-n)/100*60+n}(n[8],n[9],n[10]),e._d=V.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),C(e).rfc2822=!0}else e._isValid=!1}function fe(e){if(e._f!==g.ISO_8601)if(e._f!==g.RFC_2822){e._a=[],C(e).empty=!0;var t,o,r,n,a,i=""+e._i,s=i.length,l=0;for(r=M(e._f,e._locale).match(ot)||[],t=0;t<r.length;t++)n=r[t],(o=(i.match(N(n,e))||[])[0])&&(0<(a=i.substr(0,i.indexOf(o))).length&&C(e).unusedInput.push(a),i=i.slice(i.indexOf(o)+o.length),l+=o.length),at[n]?(o?C(e).empty=!1:C(e).unusedTokens.push(n),f=n,h=e,null!=(p=o)&&v(Et,f)&&Et[f](p,h._a,h,f)):e._strict&&!o&&C(e).unusedTokens.push(n);C(e).charsLeftOver=s-l,0<i.length&&C(e).unusedInput.push(i),e._a[bt]<=12&&!0===C(e).bigHour&&0<e._a[bt]&&(C(e).bigHour=void 0),C(e).parsedDateParts=e._a.slice(0),C(e).meridiem=e._meridiem,e._a[bt]=(c=e._locale,u=e._a[bt],null==(d=e._meridiem)?u:null!=c.meridiemHour?c.meridiemHour(u,d):(null!=c.isPM&&((m=c.isPM(d))&&u<12&&(u+=12),m||12!==u||(u=0)),u)),ce(e),se(e)}else me(e);else ue(e);var c,u,d,m,f,p,h}function pe(e){var t,o,r,n,a=e._i,i=e._f;return e._locale=e._locale||ie(e._l),null===a||void 0===i&&""===a?y({nullInput:!0}):("string"==typeof a&&(e._i=a=e._locale.preparse(a)),P(a)?new A(se(a)):(d(a)?e._d=a:s(i)?function(e){var t,o,r,n,a;if(0===e._f.length)return C(e).invalidFormat=!0,e._d=new Date(NaN);for(n=0;n<e._f.length;n++)a=0,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[n],fe(t),h(t)&&(a+=C(t).charsLeftOver,a+=10*C(t).unusedTokens.length,C(t).score=a,(null==r||a<r)&&(r=a,o=t));f(e,o||t)}(e):i?fe(e):c(o=(t=e)._i)?t._d=new Date(g.now()):d(o)?t._d=new Date(o.valueOf()):"string"==typeof o?(r=t,null===(n=oo.exec(r._i))?(ue(r),!1===r._isValid&&(delete r._isValid,me(r),!1===r._isValid&&(delete r._isValid,g.createFromInputFallback(r)))):r._d=new Date(+n[1])):s(o)?(t._a=m(o.slice(0),function(e){return parseInt(e,10)}),ce(t)):l(o)?function(e){if(!e._d){var t=R(e._i);e._a=m([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ce(e)}}(t):u(o)?t._d=new Date(o):g.createFromInputFallback(t),h(e)||(e._d=null),e))}function he(e,t,o,r,n){var a,i={};return!0!==o&&!1!==o||(r=o,o=void 0),(l(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||s(e)&&0===e.length)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=n,i._l=o,i._i=e,i._f=t,i._strict=r,(a=new A(se(pe(i))))._nextDay&&(a.add(1,"d"),a._nextDay=void 0),a}function ge(e,t,o,r){return he(e,t,o,r,!1)}function ve(e,t){var o,r;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return ge();for(o=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](o)||(o=t[r]);return o}function Ce(e){var t=R(e),o=t.year||0,r=t.quarter||0,n=t.month||0,a=t.week||0,i=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Dt.call(so,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var o=!1,r=0;r<so.length;++r)if(e[so[r]]){if(o)return!1;parseFloat(e[so[r]])!==T(e[so[r]])&&(o=!0)}return!0}(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+i+7*a,this._months=+n+3*r+12*o,this._data={},this._locale=ie(),this._bubble()}function ye(e){return e instanceof Ce}function _e(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ae(e,o){r(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+k(~~(e/60),2)+o+k(~~e%60,2)})}function Pe(e,t){var o=(t||"").match(e);if(null===o)return null;var r=((o[o.length-1]||[])+"").match(lo)||["-",0,0],n=60*r[1]+T(r[2]);return 0===n?0:"+"===r[0]?n:-n}function Ee(e,t){var o,r;return t._isUTC?(o=t.clone(),r=(P(e)||d(e)?e.valueOf():ge(e).valueOf())-o.valueOf(),o._d.setTime(o._d.valueOf()+r),g.updateOffset(o,!1),o):ge(e).local()}function Te(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Se(){return!!this.isValid()&&this._isUTC&&0===this._offset}function we(e,t){var o,r,n,a,i,s,l=e,c=null;return ye(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:u(e)?(l={},t?l[t]=e:l.milliseconds=e):(c=co.exec(e))?(o="-"===c[1]?-1:1,l={y:0,d:T(c[wt])*o,h:T(c[bt])*o,m:T(c[It])*o,s:T(c[Rt])*o,ms:T(_e(1e3*c[kt]))*o}):(c=uo.exec(e))?(o="-"===c[1]?-1:(c[1],1),l={y:be(c[2],o),M:be(c[3],o),w:be(c[4],o),d:be(c[5],o),h:be(c[6],o),m:be(c[7],o),s:be(c[8],o)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(a=ge(l.from),i=ge(l.to),n=a.isValid()&&i.isValid()?(i=Ee(i,a),a.isBefore(i)?s=Ie(a,i):((s=Ie(i,a)).milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0},(l={}).ms=n.milliseconds,l.M=n.months),r=new Ce(l),ye(e)&&v(e,"_locale")&&(r._locale=e._locale),r}function be(e,t){var o=e&&parseFloat(e.replace(",","."));return(isNaN(o)?0:o)*t}function Ie(e,t){var o={milliseconds:0,months:0};return o.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(o.months,"M").isAfter(t)&&--o.months,o.milliseconds=+t-+e.clone().add(o.months,"M"),o}function Re(r,n){return function(e,t){var o;return null===t||isNaN(+t)||(a(n,"moment()."+n+"(period, number) is deprecated. Please use moment()."+n+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=e,e=t,t=o),ke(this,we(e="string"==typeof e?+e:e,t),r),this}}function ke(e,t,o,r){var n=t._milliseconds,a=_e(t._days),i=_e(t._months);e.isValid()&&(r=null==r||r,i&&G(e,F(e,"Month")+i*o),a&&B(e,"Date",F(e,"Date")+a*o),n&&e._d.setTime(e._d.valueOf()+n*o),r&&g.updateOffset(e,a||i))}function Oe(e,t){var o=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(o,"months");return-(o+(t-r<0?(t-r)/(r-e.clone().add(o-1,"months")):(t-r)/(e.clone().add(o+1,"months")-r)))||0}function Me(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ie(e))&&(this._locale=t),this)}function De(){return this._locale}function Ne(e,t){r(0,[e,e.length],0,t)}function Le(e,t,o,r,n){var a;return null==e?J(this,r,n).year:((a=X(e,r,n))<t&&(t=a),function(e,t,o,r,n){var a=K(e,t,o,r,n),i=V(a.year,0,a.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}.call(this,e,t,o,r,n))}function xe(e){return e}function Ue(e,t,o,r){var n=ie(),a=p().set(r,t);return n[o](a,e)}function He(e,t,o){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return Ue(e,t,o,"month");var r,n=[];for(r=0;r<12;r++)n[r]=Ue(e,r,o,"month");return n}function je(e,t,o,r){t=("boolean"==typeof e||(o=t=e,e=!1),u(t)&&(o=t,t=void 0),t||"");var n=ie(),a=e?n._week.dow:0;if(null!=o)return Ue(t,(o+a)%7,r,"day");var i,s=[];for(i=0;i<7;i++)s[i]=Ue(t,(i+a)%7,r,"day");return s}function ze(e,t,o,r){var n=we(t,o);return e._milliseconds+=r*n._milliseconds,e._days+=r*n._days,e._months+=r*n._months,e._bubble()}function Fe(e){return e<0?Math.floor(e):Math.ceil(e)}function Be(e){return 4800*e/146097}function We(e){return 146097*e/4800}function Ge(e){return function(){return this.as(e)}}function Ye(e){return function(){return this.isValid()?this._data[e]:NaN}}function qe(e){return(0<e)-(e<0)||+e}function Ve(){if(!this.isValid())return this.localeData().invalidDate();var e,t,o=zo(this._milliseconds)/1e3,r=zo(this._days),n=zo(this._months);t=E((e=E(o/60))/60),o%=60,e%=60;var a=E(n/12),i=n%=12,s=r,l=t,c=e,u=o?o.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var m=d<0?"-":"",f=qe(this._months)!==qe(d)?"-":"",p=qe(this._days)!==qe(d)?"-":"",h=qe(this._milliseconds)!==qe(d)?"-":"";return m+"P"+(a?f+a+"Y":"")+(i?f+i+"M":"")+(s?p+s+"D":"")+(l||c||u?"T":"")+(l?h+l+"H":"")+(c?h+c+"M":"")+(u?h+u+"S":"")}var $e,Ke;Ke=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),o=t.length>>>0,r=0;r<o;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var Je,Xe=g.momentProperties=[],Ze=!1,Qe={};g.suppressDeprecationWarnings=!1,g.deprecationHandler=null,Je=Object.keys?Object.keys:function(e){var t,o=[];for(t in e)v(e,t)&&o.push(t);return o};var et={},tt={},ot=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,rt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,nt={},at={},it=/\d/,st=/\d\d/,lt=/\d{3}/,ct=/\d{4}/,ut=/[+-]?\d{6}/,dt=/\d\d?/,mt=/\d\d\d\d?/,ft=/\d\d\d\d\d\d?/,pt=/\d{1,3}/,ht=/\d{1,4}/,gt=/[+-]?\d{1,6}/,vt=/\d+/,Ct=/[+-]?\d+/,yt=/Z|[+-]\d\d:?\d\d/gi,_t=/Z|[+-]\d\d(?::?\d\d)?/gi,At=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Pt={},Et={},Tt=0,St=1,wt=2,bt=3,It=4,Rt=5,kt=6,Ot=7,Mt=8;r("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),r(0,["YY",2],0,function(){return this.year()%100}),r(0,["YYYY",4],0,"year"),r(0,["YYYYY",5],0,"year"),r(0,["YYYYYY",6,!0],0,"year"),t("year","y"),o("year",1),D("Y",Ct),D("YY",dt,st),D("YYYY",ht,ct),D("YYYYY",gt,ut),D("YYYYYY",gt,ut),x(["YYYYY","YYYYYY"],Tt),x("YYYY",function(e,t){t[Tt]=2===e.length?g.parseTwoDigitYear(e):T(e)}),x("YY",function(e,t){t[Tt]=g.parseTwoDigitYear(e)}),x("Y",function(e,t){t[Tt]=parseInt(e,10)}),g.parseTwoDigitYear=function(e){return T(e)+(68<T(e)?1900:2e3)};var Dt,Nt=z("FullYear",!0);Dt=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},r("M",["MM",2],"Mo",function(){return this.month()+1}),r("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),r("MMMM",0,0,function(e){return this.localeData().months(this,e)}),t("month","M"),o("month",8),D("M",dt),D("MM",dt,st),D("MMM",function(e,t){return t.monthsShortRegex(e)}),D("MMMM",function(e,t){return t.monthsRegex(e)}),x(["M","MM"],function(e,t){t[St]=T(e)-1}),x(["MMM","MMMM"],function(e,t,o,r){var n=o._locale.monthsParse(e,r,o._strict);null!=n?t[St]=n:C(o).invalidMonth=e});var Lt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,xt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ut="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ht=At,jt=At;r("w",["ww",2],"wo","week"),r("W",["WW",2],"Wo","isoWeek"),t("week","w"),t("isoWeek","W"),o("week",5),o("isoWeek",5),D("w",dt),D("ww",dt,st),D("W",dt),D("WW",dt,st),U(["w","ww","W","WW"],function(e,t,o,r){t[r.substr(0,1)]=T(e)});r("d",0,"do","day"),r("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),r("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),r("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),r("e",0,0,"weekday"),r("E",0,0,"isoWeekday"),t("day","d"),t("weekday","e"),t("isoWeekday","E"),o("day",11),o("weekday",11),o("isoWeekday",11),D("d",dt),D("e",dt),D("E",dt),D("dd",function(e,t){return t.weekdaysMinRegex(e)}),D("ddd",function(e,t){return t.weekdaysShortRegex(e)}),D("dddd",function(e,t){return t.weekdaysRegex(e)}),U(["dd","ddd","dddd"],function(e,t,o,r){var n=o._locale.weekdaysParse(e,r,o._strict);null!=n?t.d=n:C(o).invalidWeekday=e}),U(["d","e","E"],function(e,t,o,r){t[r]=T(e)});var zt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ft="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Bt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Wt=At,Gt=At,Yt=At;r("H",["HH",2],0,"hour"),r("h",["hh",2],0,Q),r("k",["kk",2],0,function(){return this.hours()||24}),r("hmm",0,0,function(){return""+Q.apply(this)+k(this.minutes(),2)}),r("hmmss",0,0,function(){return""+Q.apply(this)+k(this.minutes(),2)+k(this.seconds(),2)}),r("Hmm",0,0,function(){return""+this.hours()+k(this.minutes(),2)}),r("Hmmss",0,0,function(){return""+this.hours()+k(this.minutes(),2)+k(this.seconds(),2)}),ee("a",!0),ee("A",!1),t("hour","h"),o("hour",13),D("a",te),D("A",te),D("H",dt),D("h",dt),D("k",dt),D("HH",dt,st),D("hh",dt,st),D("kk",dt,st),D("hmm",mt),D("hmmss",ft),D("Hmm",mt),D("Hmmss",ft),x(["H","HH"],bt),x(["k","kk"],function(e,t,o){var r=T(e);t[bt]=24===r?0:r}),x(["a","A"],function(e,t,o){o._isPm=o._locale.isPM(e),o._meridiem=e}),x(["h","hh"],function(e,t,o){t[bt]=T(e),C(o).bigHour=!0}),x("hmm",function(e,t,o){var r=e.length-2;t[bt]=T(e.substr(0,r)),t[It]=T(e.substr(r)),C(o).bigHour=!0}),x("hmmss",function(e,t,o){var r=e.length-4,n=e.length-2;t[bt]=T(e.substr(0,r)),t[It]=T(e.substr(r,2)),t[Rt]=T(e.substr(n)),C(o).bigHour=!0}),x("Hmm",function(e,t,o){var r=e.length-2;t[bt]=T(e.substr(0,r)),t[It]=T(e.substr(r))}),x("Hmmss",function(e,t,o){var r=e.length-4,n=e.length-2;t[bt]=T(e.substr(0,r)),t[It]=T(e.substr(r,2)),t[Rt]=T(e.substr(n))});var qt,Vt=z("Hours",!0),$t={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:xt,monthsShort:Ut,week:{dow:0,doy:6},weekdays:zt,weekdaysMin:Bt,weekdaysShort:Ft,meridiemParse:/[ap]\.?m?\.?/i},Kt={},Jt={},Xt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Zt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Qt=/Z|[+-]\d\d(?::?\d\d)?/,eo=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],to=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],oo=/^\/?Date\((\-?\d+)/i,ro=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,no={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};g.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),g.ISO_8601=function(){},g.RFC_2822=function(){};var ao=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ge.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()}),io=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ge.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:y()}),so=["year","quarter","month","week","day","hour","minute","second","millisecond"];Ae("Z",":"),Ae("ZZ",""),D("Z",_t),D("ZZ",_t),x(["Z","ZZ"],function(e,t,o){o._useUTC=!0,o._tzm=Pe(_t,e)});var lo=/([\+\-]|\d\d)/gi;g.updateOffset=function(){};var co=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,uo=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;we.fn=Ce.prototype,we.invalid=function(){return we(NaN)};var mo=Re(1,"add"),fo=Re(-1,"subtract");g.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",g.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var po=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});r(0,["gg",2],0,function(){return this.weekYear()%100}),r(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ne("gggg","weekYear"),Ne("ggggg","weekYear"),Ne("GGGG","isoWeekYear"),Ne("GGGGG","isoWeekYear"),t("weekYear","gg"),t("isoWeekYear","GG"),o("weekYear",1),o("isoWeekYear",1),D("G",Ct),D("g",Ct),D("GG",dt,st),D("gg",dt,st),D("GGGG",ht,ct),D("gggg",ht,ct),D("GGGGG",gt,ut),D("ggggg",gt,ut),U(["gggg","ggggg","GGGG","GGGGG"],function(e,t,o,r){t[r.substr(0,2)]=T(e)}),U(["gg","GG"],function(e,t,o,r){t[r]=g.parseTwoDigitYear(e)}),r("Q",0,"Qo","quarter"),t("quarter","Q"),o("quarter",7),D("Q",it),x("Q",function(e,t){t[St]=3*(T(e)-1)}),r("D",["DD",2],"Do","date"),t("date","D"),o("date",9),D("D",dt),D("DD",dt,st),D("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),x(["D","DD"],wt),x("Do",function(e,t){t[wt]=T(e.match(dt)[0])});var ho=z("Date",!0);r("DDD",["DDDD",3],"DDDo","dayOfYear"),t("dayOfYear","DDD"),o("dayOfYear",4),D("DDD",pt),D("DDDD",lt),x(["DDD","DDDD"],function(e,t,o){o._dayOfYear=T(e)}),r("m",["mm",2],0,"minute"),t("minute","m"),o("minute",14),D("m",dt),D("mm",dt,st),x(["m","mm"],It);var go=z("Minutes",!1);r("s",["ss",2],0,"second"),t("second","s"),o("second",15),D("s",dt),D("ss",dt,st),x(["s","ss"],Rt);var vo,Co=z("Seconds",!1);for(r("S",0,0,function(){return~~(this.millisecond()/100)}),r(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),r(0,["SSS",3],0,"millisecond"),r(0,["SSSS",4],0,function(){return 10*this.millisecond()}),r(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),r(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),r(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),r(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),r(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),t("millisecond","ms"),o("millisecond",16),D("S",pt,it),D("SS",pt,st),D("SSS",pt,lt),vo="SSSS";vo.length<=9;vo+="S")D(vo,vt);for(vo="S";vo.length<=9;vo+="S")x(vo,function(e,t){t[kt]=T(1e3*("0."+e))});var yo=z("Milliseconds",!1);r("z",0,0,"zoneAbbr"),r("zz",0,0,"zoneName");var _o=A.prototype;_o.add=mo,_o.calendar=function(e,t){var o=e||ge(),r=Ee(o,this).startOf("day"),n=g.calendarFormat(this,r)||"sameElse",a=t&&(w(t[n])?t[n].call(this,o):t[n]);return this.format(a||this.localeData().calendar(n,this,ge(o)))},_o.clone=function(){return new A(this)},_o.diff=function(e,t,o){var r,n,a;if(!this.isValid())return NaN;if(!(r=Ee(e,this)).isValid())return NaN;switch(n=6e4*(r.utcOffset()-this.utcOffset()),t=I(t)){case"year":a=Oe(this,r)/12;break;case"month":a=Oe(this,r);break;case"quarter":a=Oe(this,r)/3;break;case"second":a=(this-r)/1e3;break;case"minute":a=(this-r)/6e4;break;case"hour":a=(this-r)/36e5;break;case"day":a=(this-r-n)/864e5;break;case"week":a=(this-r-n)/6048e5;break;default:a=this-r}return o?a:E(a)},_o.endOf=function(e){return void 0===(e=I(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},_o.format=function(e){e||(e=this.isUtc()?g.defaultFormatUtc:g.defaultFormat);var t=O(this,e);return this.localeData().postformat(t)},_o.from=function(e,t){return this.isValid()&&(P(e)&&e.isValid()||ge(e).isValid())?we({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},_o.fromNow=function(e){return this.from(ge(),e)},_o.to=function(e,t){return this.isValid()&&(P(e)&&e.isValid()||ge(e).isValid())?we({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},_o.toNow=function(e){return this.to(ge(),e)},_o.get=function(e){return w(this[e=I(e)])?this[e]():this},_o.invalidAt=function(){return C(this).overflow},_o.isAfter=function(e,t){var o=P(e)?e:ge(e);return!(!this.isValid()||!o.isValid())&&("millisecond"===(t=I(c(t)?"millisecond":t))?this.valueOf()>o.valueOf():o.valueOf()<this.clone().startOf(t).valueOf())},_o.isBefore=function(e,t){var o=P(e)?e:ge(e);return!(!this.isValid()||!o.isValid())&&("millisecond"===(t=I(c(t)?"millisecond":t))?this.valueOf()<o.valueOf():this.clone().endOf(t).valueOf()<o.valueOf())},_o.isBetween=function(e,t,o,r){return("("===(r=r||"()")[0]?this.isAfter(e,o):!this.isBefore(e,o))&&(")"===r[1]?this.isBefore(t,o):!this.isAfter(t,o))},_o.isSame=function(e,t){var o,r=P(e)?e:ge(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=I(t||"millisecond"))?this.valueOf()===r.valueOf():(o=r.valueOf(),this.clone().startOf(t).valueOf()<=o&&o<=this.clone().endOf(t).valueOf()))},_o.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},_o.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},_o.isValid=function(){return h(this)},_o.lang=po,_o.locale=Me,_o.localeData=De,_o.max=io,_o.min=ao,_o.parsingFlags=function(){return f({},C(this))},_o.set=function(e,t){if("object"==typeof e)for(var o=function(e){var t=[];for(var o in e)t.push({unit:o,priority:tt[o]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=R(e)),r=0;r<o.length;r++)this[o[r].unit](e[o[r].unit]);else if(w(this[e=I(e)]))return this[e](t);return this},_o.startOf=function(e){switch(e=I(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},_o.subtract=fo,_o.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},_o.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},_o.toDate=function(){return new Date(this.valueOf())},_o.toISOString=function(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||9999<e.year()?O(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):w(Date.prototype.toISOString)?this.toDate().toISOString():O(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},_o.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var o="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=t+'[")]';return this.format(o+r+"-MM-DD[T]HH:mm:ss.SSS"+n)},_o.toJSON=function(){return this.isValid()?this.toISOString():null},_o.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},_o.unix=function(){return Math.floor(this.valueOf()/1e3)},_o.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},_o.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},_o.year=Nt,_o.isLeapYear=function(){return j(this.year())},_o.weekYear=function(e){return Le.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},_o.isoWeekYear=function(e){return Le.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},_o.quarter=_o.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},_o.month=Y,_o.daysInMonth=function(){return W(this.year(),this.month())},_o.week=_o.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},_o.isoWeek=_o.isoWeeks=function(e){var t=J(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},_o.weeksInYear=function(){var e=this.localeData()._week;return X(this.year(),e.dow,e.doy)},_o.isoWeeksInYear=function(){return X(this.year(),1,4)},_o.date=ho,_o.day=_o.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,o,r=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,o=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=o.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-r,"d")):r},_o.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},_o.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var t,o,r=(t=e,o=this.localeData(),"string"==typeof t?o.weekdaysParse(t)%7||7:isNaN(t)?null:t);return this.day(this.day()%7?r:r-7)},_o.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},_o.hour=_o.hours=Vt,_o.minute=_o.minutes=go,_o.second=_o.seconds=Co,_o.millisecond=_o.milliseconds=yo,_o.utcOffset=function(e,t,o){var r,n=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?n:Te(this);if("string"==typeof e){if(null===(e=Pe(_t,e)))return this}else Math.abs(e)<16&&!o&&(e*=60);return!this._isUTC&&t&&(r=Te(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),n!==e&&(!t||this._changeInProgress?ke(this,we(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,g.updateOffset(this,!0),this._changeInProgress=null)),this},_o.utc=function(e){return this.utcOffset(0,e)},_o.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Te(this),"m")),this},_o.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Pe(yt,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},_o.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?ge(e).utcOffset():0,(this.utcOffset()-e)%60==0)},_o.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},_o.isLocal=function(){return!!this.isValid()&&!this._isUTC},_o.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},_o.isUtc=Se,_o.isUTC=Se,_o.zoneAbbr=function(){return this._isUTC?"UTC":""},_o.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},_o.dates=e("dates accessor is deprecated. Use date instead.",ho),_o.months=e("months accessor is deprecated. Use month instead",Y),_o.years=e("years accessor is deprecated. Use year instead",Nt),_o.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),_o.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e={};if(_(e,this),(e=pe(e))._a){var t=e._isUTC?p(e._a):ge(e._a);this._isDSTShifted=this.isValid()&&0<i(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Ao=b.prototype;Ao.calendar=function(e,t,o){var r=this._calendar[e]||this._calendar.sameElse;return w(r)?r.call(t,o):r},Ao.longDateFormat=function(e){var t=this._longDateFormat[e],o=this._longDateFormat[e.toUpperCase()];return t||!o?t:(this._longDateFormat[e]=o.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},Ao.invalidDate=function(){return this._invalidDate},Ao.ordinal=function(e){return this._ordinal.replace("%d",e)},Ao.preparse=xe,Ao.postformat=xe,Ao.relativeTime=function(e,t,o,r){var n=this._relativeTime[o];return w(n)?n(e,t,o,r):n.replace(/%d/i,e)},Ao.pastFuture=function(e,t){var o=this._relativeTime[0<e?"future":"past"];return w(o)?o(t):o.replace(/%s/i,t)},Ao.set=function(e){var t,o;for(o in e)w(t=e[o])?this[o]=t:this["_"+o]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Ao.months=function(e,t){return e?s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Lt).test(t)?"format":"standalone"][e.month()]:s(this._months)?this._months:this._months.standalone},Ao.monthsShort=function(e,t){return e?s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Lt.test(t)?"format":"standalone"][e.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Ao.monthsParse=function(e,t,o){var r,n,a;if(this._monthsParseExact)return function(e,t,o){var r,n,a,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)a=p([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(a,"").toLocaleLowerCase();return o?"MMM"===t?-1!==(n=Dt.call(this._shortMonthsParse,i))?n:null:-1!==(n=Dt.call(this._longMonthsParse,i))?n:null:"MMM"===t?-1!==(n=Dt.call(this._shortMonthsParse,i))?n:-1!==(n=Dt.call(this._longMonthsParse,i))?n:null:-1!==(n=Dt.call(this._longMonthsParse,i))?n:-1!==(n=Dt.call(this._shortMonthsParse,i))?n:null}.call(this,e,t,o);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(n=p([2e3,r]),o&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),o||this._monthsParse[r]||(a="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[r]=new RegExp(a.replace(".",""),"i")),o&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(o&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!o&&this._monthsParse[r].test(e))return r}},Ao.monthsRegex=function(e){return this._monthsParseExact?(v(this,"_monthsRegex")||q.call(this),e?this._monthsStrictRegex:this._monthsRegex):(v(this,"_monthsRegex")||(this._monthsRegex=jt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Ao.monthsShortRegex=function(e){return this._monthsParseExact?(v(this,"_monthsRegex")||q.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(v(this,"_monthsShortRegex")||(this._monthsShortRegex=Ht),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Ao.week=function(e){return J(e,this._week.dow,this._week.doy).week},Ao.firstDayOfYear=function(){return this._week.doy},Ao.firstDayOfWeek=function(){return this._week.dow},Ao.weekdays=function(e,t){return e?s(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:s(this._weekdays)?this._weekdays:this._weekdays.standalone},Ao.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},Ao.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},Ao.weekdaysParse=function(e,t,o){var r,n,a;if(this._weekdaysParseExact)return function(e,t,o){var r,n,a,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)a=p([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(a,"").toLocaleLowerCase();return o?"dddd"===t?-1!==(n=Dt.call(this._weekdaysParse,i))?n:null:"ddd"===t?-1!==(n=Dt.call(this._shortWeekdaysParse,i))?n:null:-1!==(n=Dt.call(this._minWeekdaysParse,i))?n:null:"dddd"===t?-1!==(n=Dt.call(this._weekdaysParse,i))?n:-1!==(n=Dt.call(this._shortWeekdaysParse,i))?n:-1!==(n=Dt.call(this._minWeekdaysParse,i))?n:null:"ddd"===t?-1!==(n=Dt.call(this._shortWeekdaysParse,i))?n:-1!==(n=Dt.call(this._weekdaysParse,i))?n:-1!==(n=Dt.call(this._minWeekdaysParse,i))?n:null:-1!==(n=Dt.call(this._minWeekdaysParse,i))?n:-1!==(n=Dt.call(this._weekdaysParse,i))?n:-1!==(n=Dt.call(this._shortWeekdaysParse,i))?n:null}.call(this,e,t,o);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(n=p([2e3,1]).day(r),o&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(n,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(n,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(n,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(a="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[r]=new RegExp(a.replace(".",""),"i")),o&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(o&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(o&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!o&&this._weekdaysParse[r].test(e))return r}},Ao.weekdaysRegex=function(e){return this._weekdaysParseExact?(v(this,"_weekdaysRegex")||Z.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(v(this,"_weekdaysRegex")||(this._weekdaysRegex=Wt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Ao.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(v(this,"_weekdaysRegex")||Z.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(v(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Gt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Ao.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(v(this,"_weekdaysRegex")||Z.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(v(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Yt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Ao.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Ao.meridiem=function(e,t,o){return 11<e?o?"pm":"PM":o?"am":"AM"},ne("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===T(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),g.lang=e("moment.lang is deprecated. Use moment.locale instead.",ne),g.langData=e("moment.langData is deprecated. Use moment.localeData instead.",ie);var Po=Math.abs,Eo=Ge("ms"),To=Ge("s"),So=Ge("m"),wo=Ge("h"),bo=Ge("d"),Io=Ge("w"),Ro=Ge("M"),ko=Ge("y"),Oo=Ye("milliseconds"),Mo=Ye("seconds"),Do=Ye("minutes"),No=Ye("hours"),Lo=Ye("days"),xo=Ye("months"),Uo=Ye("years"),Ho=Math.round,jo={ss:44,s:45,m:45,h:22,d:26,M:11},zo=Math.abs,Fo=Ce.prototype;return Fo.isValid=function(){return this._isValid},Fo.abs=function(){var e=this._data;return this._milliseconds=Po(this._milliseconds),this._days=Po(this._days),this._months=Po(this._months),e.milliseconds=Po(e.milliseconds),e.seconds=Po(e.seconds),e.minutes=Po(e.minutes),e.hours=Po(e.hours),e.months=Po(e.months),e.years=Po(e.years),this},Fo.add=function(e,t){return ze(this,e,t,1)},Fo.subtract=function(e,t){return ze(this,e,t,-1)},Fo.as=function(e){if(!this.isValid())return NaN;var t,o,r=this._milliseconds;if("month"===(e=I(e))||"year"===e)return t=this._days+r/864e5,o=this._months+Be(t),"month"===e?o:o/12;switch(t=this._days+Math.round(We(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},Fo.asMilliseconds=Eo,Fo.asSeconds=To,Fo.asMinutes=So,Fo.asHours=wo,Fo.asDays=bo,Fo.asWeeks=Io,Fo.asMonths=Ro,Fo.asYears=ko,Fo.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*T(this._months/12):NaN},Fo._bubble=function(){var e,t,o,r,n,a=this._milliseconds,i=this._days,s=this._months,l=this._data;return 0<=a&&0<=i&&0<=s||a<=0&&i<=0&&s<=0||(a+=864e5*Fe(We(s)+i),s=i=0),l.milliseconds=a%1e3,e=E(a/1e3),l.seconds=e%60,t=E(e/60),l.minutes=t%60,o=E(t/60),l.hours=o%24,s+=n=E(Be(i+=E(o/24))),i-=Fe(We(n)),r=E(s/12),s%=12,l.days=i,l.months=s,l.years=r,this},Fo.clone=function(){return we(this)},Fo.get=function(e){return e=I(e),this.isValid()?this[e+"s"]():NaN},Fo.milliseconds=Oo,Fo.seconds=Mo,Fo.minutes=Do,Fo.hours=No,Fo.days=Lo,Fo.weeks=function(){return E(this.days()/7)},Fo.months=xo,Fo.years=Uo,Fo.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t,o,r,n,a,i,s,l,c,u,d,m=this.localeData(),f=(o=!e,r=m,n=we(t=this).abs(),a=Ho(n.as("s")),i=Ho(n.as("m")),s=Ho(n.as("h")),l=Ho(n.as("d")),c=Ho(n.as("M")),u=Ho(n.as("y")),(d=a<=jo.ss&&["s",a]||a<jo.s&&["ss",a]||i<=1&&["m"]||i<jo.m&&["mm",i]||s<=1&&["h"]||s<jo.h&&["hh",s]||l<=1&&["d"]||l<jo.d&&["dd",l]||c<=1&&["M"]||c<jo.M&&["MM",c]||u<=1&&["y"]||["yy",u])[2]=o,d[3]=0<+t,d[4]=r,function(e,t,o,r,n){return n.relativeTime(t||1,!!o,e,r)}.apply(null,d));return e&&(f=m.pastFuture(+this,f)),m.postformat(f)},Fo.toISOString=Ve,Fo.toString=Ve,Fo.toJSON=Ve,Fo.locale=Me,Fo.localeData=De,Fo.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ve),Fo.lang=po,r("X",0,0,"unix"),r("x",0,0,"valueOf"),D("x",Ct),D("X",/[+-]?\d+(\.\d{1,3})?/),x("X",function(e,t,o){o._d=new Date(1e3*parseFloat(e,10))}),x("x",function(e,t,o){o._d=new Date(T(e))}),g.version="2.19.1",$e=ge,g.fn=_o,g.min=function(){return ve("isBefore",[].slice.call(arguments,0))},g.max=function(){return ve("isAfter",[].slice.call(arguments,0))},g.now=function(){return Date.now?Date.now():+new Date},g.utc=p,g.unix=function(e){return ge(1e3*e)},g.months=function(e,t){return He(e,t,"months")},g.isDate=d,g.locale=ne,g.invalid=y,g.duration=we,g.isMoment=P,g.weekdays=function(e,t,o){return je(e,t,o,"weekdays")},g.parseZone=function(){return ge.apply(null,arguments).parseZone()},g.localeData=ie,g.isDuration=ye,g.monthsShort=function(e,t){return He(e,t,"monthsShort")},g.weekdaysMin=function(e,t,o){return je(e,t,o,"weekdaysMin")},g.defineLocale=ae,g.updateLocale=function(e,t){if(null!=t){var o,r=$t;null!=Kt[e]&&(r=Kt[e]._config),(o=new b(t=n(r,t))).parentLocale=Kt[e],Kt[e]=o,ne(e)}else null!=Kt[e]&&(null!=Kt[e].parentLocale?Kt[e]=Kt[e].parentLocale:null!=Kt[e]&&delete Kt[e]);return Kt[e]},g.locales=function(){return Je(Kt)},g.weekdaysShort=function(e,t,o){return je(e,t,o,"weekdaysShort")},g.normalizeUnits=I,g.relativeTimeRounding=function(e){return void 0===e?Ho:"function"==typeof e&&(Ho=e,!0)},g.relativeTimeThreshold=function(e,t){return void 0!==jo[e]&&(void 0===t?jo[e]:(jo[e]=t,"s"===e&&(jo.ss=t-1),!0))},g.calendarFormat=function(e,t){var o=e.diff(t,"days",!0);return o<-6?"sameElse":o<-1?"lastWeek":o<0?"lastDay":o<1?"sameDay":o<2?"nextDay":o<7?"nextWeek":"sameElse"},g.prototype=_o,g}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["moment"],t):"object"==typeof module&&module.exports?module.exports=t(require("moment")):t(e.moment)}(this,function(a){"use strict";function l(e){return 96<e?e-87:64<e?e-29:e-48}function o(e){var t=0,o=e.split("."),r=o[0],n=o[1]||"",a=1,i=0,s=1;for(45===e.charCodeAt(0)&&(s=-(t=1));t<r.length;t++)i=60*i+l(r.charCodeAt(t));for(t=0;t<n.length;t++)a/=60,i+=l(n.charCodeAt(t))*a;return i*s}function i(e){for(var t=0;t<e.length;t++)e[t]=o(e[t])}function s(e,t){var o,r=[];for(o=0;o<t.length;o++)r[o]=e[t[o]];return r}function t(e){var t=e.split("|"),o=t[2].split(" "),r=t[3].split(""),n=t[4].split(" ");return i(o),i(r),i(n),function(e,t){for(var o=0;o<t;o++)e[o]=Math.round((e[o-1]||0)+6e4*e[o]);e[t-1]=1/0}(n,r.length),{name:t[0],abbrs:s(t[1].split(" "),r),offsets:s(o,r),untils:n,population:0|t[5]}}function n(e){e&&this._set(t(e))}function c(e){var t=e.toTimeString(),o=t.match(/\([a-z ]+\)/i);"GMT"===(o=o&&o[0]?(o=o[0].match(/[A-Z]/g))?o.join(""):void 0:(o=t.match(/[A-Z]{3,5}/g))?o[0]:void 0)&&(o=void 0),this.at=+e,this.abbr=o,this.offset=e.getTimezoneOffset()}function u(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function d(e,t){for(var o,r;r=6e4*((t.at-e.at)/12e4|0);)(o=new c(new Date(e.at+r))).offset===e.offset?e=o:t=o;return e}function m(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function f(e,t){var o,r;for(i(t),o=0;o<t.length;o++)r=t[o],w[r]=w[r]||{},w[r][e]=!0}function r(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e){var t=S[p(e)];if(t)return t;y("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var o,r,n,a=function(){var e,t,o,r=(new Date).getFullYear()-2,n=new c(new Date(r,0,1)),a=[n];for(o=1;o<48;o++)(t=new c(new Date(r,o,1))).offset!==n.offset&&(e=d(n,t),a.push(e),a.push(new c(new Date(e.at+6e4)))),n=t;for(o=0;o<4;o++)a.push(new c(new Date(r+o,0,1))),a.push(new c(new Date(r+o,6,1)));return a}(),i=a.length,s=function(e){var t,o,r,n=e.length,a={},i=[];for(t=0;t<n;t++)for(o in r=w[e[t].offset]||{})r.hasOwnProperty(o)&&(a[o]=!0);for(t in a)a.hasOwnProperty(t)&&i.push(S[t]);return i}(a),l=[];for(r=0;r<s.length;r++){for(o=new u(g(s[r]),i),n=0;n<i;n++)o.scoreOffsetAt(a[n]);l.push(o)}return l.sort(m),0<l.length?l[0].zone.name:void 0}function p(e){return(e||"").toLowerCase().replace(/\//g,"_")}function h(e){var t,o,r,n;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=p(o=(r=e[t].split("|"))[0]),E[n]=e[t],S[n]=o,r[5]&&f(n,r[2].split(" "))}function g(e,t){e=p(e);var o,r=E[e];return r instanceof n?r:"string"==typeof r?(r=new n(r),E[e]=r):T[e]&&t!==g&&(o=g(T[e],g))?((r=E[e]=new n)._set(o),r.name=S[e],r):null}function v(e){var t,o,r,n;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)r=p((o=e[t].split("|"))[0]),n=p(o[1]),T[r]=n,S[r]=o[0],T[n]=r,S[n]=o[1]}function e(e){h(e.zones),v(e.links),_.dataVersion=e.version}function C(e){return!(!e._a||void 0!==e._tzm)}function y(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function _(e){var t=Array.prototype.slice.call(arguments,0,-1),o=arguments[arguments.length-1],r=g(o),n=a.utc.apply(null,t);return r&&!a.isMoment(e)&&C(n)&&n.add(r.parse(n),"minutes"),n.tz(o),n}function A(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}var P,E={},T={},S={},w={},b=a.version.split("."),I=+b[0],R=+b[1];(I<2||2===I&&R<6)&&y("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+a.version+". See momentjs.com"),n.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,o=+e,r=this.untils;for(t=0;t<r.length;t++)if(o<r[t])return t},parse:function(e){var t,o,r,n,a=+e,i=this.offsets,s=this.untils,l=s.length-1;for(n=0;n<l;n++)if(t=i[n],o=i[n+1],r=i[n?n-1:n],t<o&&_.moveAmbiguousForward?t=o:r<t&&_.moveInvalidForward&&(t=r),a<s[n]-6e4*t)return i[n];return i[l]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return this.offsets[this._index(e)]}},u.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.offset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},_.version="0.5.13",_.dataVersion="",_._zones=E,_._links=T,_._names=S,_.add=h,_.link=v,_.load=e,_.zone=g,_.zoneExists=function e(t){return e.didShowError||(e.didShowError=!0,y("moment.tz.zoneExists('"+t+"') has been deprecated in favor of !moment.tz.zone('"+t+"')")),!!g(t)},_.guess=function(e){return P&&!e||(P=r()),P},_.names=function(){var e,t=[];for(e in S)S.hasOwnProperty(e)&&(E[e]||E[T[e]])&&S[e]&&t.push(S[e]);return t.sort()},_.Zone=n,_.unpack=t,_.unpackBase60=o,_.needsOffset=C,_.moveInvalidForward=!0,_.moveAmbiguousForward=!1;var k,O=a.fn;a.tz=_,a.defaultZone=null,a.updateOffset=function(e,t){var o,r=a.defaultZone;void 0===e._z&&(r&&C(e)&&!e._isUTC&&(e._d=a.utc(e._a)._d,e.utc().add(r.parse(e),"minutes")),e._z=r),e._z&&(o=e._z.offset(e),Math.abs(o)<16&&(o/=60),void 0!==e.utcOffset?e.utcOffset(-o,t):e.zone(o,t))},O.tz=function(e){return e?(this._z=g(e),this._z?a.updateOffset(this):y("Moment Timezone has no data for "+e+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},O.zoneName=A(O.zoneName),O.zoneAbbr=A(O.zoneAbbr),O.utc=(k=O.utc,function(){return this._z=null,k.apply(this,arguments)}),a.tz.setDefault=function(e){return(I<2||2===I&&R<9)&&y("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+a.version+"."),a.defaultZone=e?g(e):null,a};var M=a.momentProperties;return"[object Array]"===Object.prototype.toString.call(M)?(M.push("_z"),M.push("_a")):M&&(M._z=null),e({version:"2017b",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Khartoum|EAT|-30|0||51e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|01010|1M2m0 gL0 e10 mn0|15e6","Africa/Casablanca|WET WEST|0 -10|0101010101010101010101010101010101010101010|1H3C0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00|11e5","Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1GQo0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1GIc0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1GIb0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Araguaina|-03 -02|30 20|010|1IdD0 Lz0|14e4","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1GTf0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0|28e5","America/Panama|EST|50|0||15e5","America/Bahia|-02 -03|20 30|01|1GCq0|27e5","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1GQw0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|20e6","America/Managua|CST|60|0||22e5","America/La_Paz|-04|40|0||19e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1GI90 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|01010101010101010101010|1GCr0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0|77e4","America/Cancun|CST CDT EST|60 50 50|01010102|1GQw0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|-0430 -04|4u 40|01|1QMT0|29e5","America/Chicago|CST CDT|60 50|01010101010101010101010|1GI80 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1GQx0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|81e4","America/Phoenix|MST|70|0||42e5","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1GIa0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|15e6","America/New_York|EST EDT|50 40|01010101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|21e6","America/Rio_Branco|-04 -05|40 50|01|1KLE0|31e4","America/Fort_Nelson|PST PDT MST|80 70 70|01010102|1GIa0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1GI60 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02|30 20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|17e3","America/Grand_Turk|EST EDT AST|50 40 40|010101012|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Havana|CST CDT|50 40|01010101010101010101010|1GQt0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0|21e5","America/Metlakatla|PST AKST AKDT|80 90 80|0121212121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1GI50 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|61e2","America/Montevideo|-02 -03|20 30|01010101|1GI40 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Noronha|-02|20|0||30e2","America/Port-au-Prince|EST EDT|50 40|010101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|23e5","Antarctica/Palmer|-03 -04|30 40|010101010|1H3D0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0|40","America/Santiago|-03 -04|30 40|010101010101010101010|1H3D0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0|62e5","America/Sao_Paulo|-02 -03|20 30|01010101010101010101010|1GCq0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0|20e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e4","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1GI5u 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+11 +08|-b0 -80|010|1GAF0 blz0|10","Antarctica/Davis|+05 +07|-50 -70|01|1GAI0|70","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Guadalcanal|+11|-b0|0||11e4","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1GQe0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00|14e5","Asia/Baghdad|+03|-30|0||66e5","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|40","Asia/Dhaka|+06|-60|0||16e6","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1GPy0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Baku|+04 +05|-40 -50|010101010|1GNA0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|+07|-70|0||15e6","Asia/Barnaul|+07 +06|-70 -60|010|1N7v0 3rd0","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1GNy0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|22e5","Asia/Manila|+08|-80|0||24e6","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+10 +08 +09|-a0 -80 -90|012|1N7s0 3re0|33e4","Asia/Ulaanbaatar|+08 +09|-80 -90|01010|1O8G0 1cJ0 1cP0 1cJ0|12e5","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1GPy0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0|26e5","Asia/Dili|+09|-90|0||19e4","Asia/Dubai|+04|-40|0||39e5","Asia/Famagusta|EET EEST +03|-20 -30 -30|01010101012|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 15U0","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1GPy0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|+07 +08|-70 -80|01010|1O8H0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|+09 +08|-90 -80|01|1N7t0|60e4","Europe/Istanbul|EET EEST +03|-20 -30 -30|01010101012|1GNB0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1GPA0 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Yakutsk|+10 +09|-a0 -90|01|1N7s0|28e4","Asia/Krasnoyarsk|+08 +07|-80 -70|01|1N7u0|10e5","Asia/Magadan|+12 +10 +11|-c0 -a0 -b0|012|1N7q0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|35e5","Asia/Novosibirsk|+07 +06|-70 -60|010|1N7v0 4eN0|15e5","Asia/Omsk|+07 +06|-70 -60|01|1N7v0|12e5","Asia/Pyongyang|KST KST|-90 -8u|01|1P4D0|29e5","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Sakhalin|+11 +10|-b0 -a0|010|1N7r0 3rd0|58e4","Asia/Seoul|KST|-90|0||23e6","Asia/Srednekolymsk|+12 +11|-c0 -b0|01|1N7q0|35e2","Asia/Tehran|+0330 +0430|-3u -4u|01010101010101010101010|1GLUu 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+07 +06|-70 -60|010|1N7v0 3Qp0|10e5","Asia/Vladivostok|+11 +10|-b0 -a0|01|1N7r0|60e4","Asia/Yekaterinburg|+06 +05|-60 -50|01|1N7w0|14e5","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1GQg0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1GQgu 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1GQf0 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|010101010101010101010|1H3D0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|12e5","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0|","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0|","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/GMT-1|+01|-10|0|","Pacific/Fakaofo|+13|-d0|0||483","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Astrakhan|+04 +03|-40 -30|010|1N7y0 3rd0","Europe/London|GMT BST|0 -10|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1GNA0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|67e4","Europe/Kaliningrad|+03 EET|-30 -20|01|1N7z0|44e4","Europe/Volgograd|+04 +03|-40 -30|01|1N7y0|10e5","Europe/Moscow|MSK MSK|-40 -30|01|1N7y0|16e6","Europe/Saratov|+04 +03|-40 -30|010|1N7y0 5810","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|0101023|1GNB0 1qM0 11A0 1o00 11z0 1nW0|33e4","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1GQe0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|+14 +13|-e0 -d0|01010101010101010101010|1GQe0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|+10 +11|-a0 -b0|01|1NwE0|18e4","Pacific/Fiji|+13 +12|-d0 -c0|01010101010101010101010|1Goe0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+1130 +11|-bu -b0|01|1PoCu|25e4","Pacific/Tongatapu|+13 +14|-d0 -e0|01010101010101|1S4d0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0|75e3"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Khartoum|Africa/Addis_Ababa","Africa/Khartoum|Africa/Asmara","Africa/Khartoum|Africa/Asmera","Africa/Khartoum|Africa/Dar_es_Salaam","Africa/Khartoum|Africa/Djibouti","Africa/Khartoum|Africa/Juba","Africa/Khartoum|Africa/Kampala","Africa/Khartoum|Africa/Mogadishu","Africa/Khartoum|Africa/Nairobi","Africa/Khartoum|Indian/Antananarivo","Africa/Khartoum|Indian/Comoro","Africa/Khartoum|Indian/Mayotte","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/La_Paz|America/Boa_Vista","America/La_Paz|America/Guyana","America/La_Paz|America/Manaus","America/La_Paz|America/Porto_Velho","America/La_Paz|Brazil/West","America/La_Paz|Etc/GMT+4","America/Lima|America/Bogota","America/Lima|America/Guayaquil","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Dawson","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|America/Whitehorse","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Canada/Yukon","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/East-Saskatchewan","America/Managua|Canada/Saskatchewan","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Rio_Branco|America/Eirunepe","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/Palmer|America/Punta_Arenas","Asia/Baghdad|Antarctica/Syowa","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Baghdad|Etc/GMT-3","Asia/Baghdad|Europe/Minsk","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Dhaka|Antarctica/Vostok","Asia/Dhaka|Asia/Almaty","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Qyzylorda","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dili|Etc/GMT-9","Asia/Dili|Pacific/Palau","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Samara","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Makassar|Asia/Ujung_Pandang","Asia/Manila|Asia/Brunei","Asia/Manila|Asia/Kuala_Lumpur","Asia/Manila|Asia/Kuching","Asia/Manila|Asia/Singapore","Asia/Manila|Etc/GMT-8","Asia/Manila|Singapore","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Choibalsan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Vladivostok|Asia/Ust-Nera","Asia/Yakutsk|Asia/Khandyga","Atlantic/Azores|America/Scoresbysund","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Astrakhan|Europe/Ulyanovsk","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Europe/Volgograd|Europe/Kirov","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Fakaofo|Etc/GMT-13","Pacific/Fakaofo|Pacific/Enderbury","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guadalcanal|Antarctica/Macquarie","Pacific/Guadalcanal|Etc/GMT-11","Pacific/Guadalcanal|Pacific/Efate","Pacific/Guadalcanal|Pacific/Kosrae","Pacific/Guadalcanal|Pacific/Noumea","Pacific/Guadalcanal|Pacific/Pohnpei","Pacific/Guadalcanal|Pacific/Ponape","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Port_Moresby|Antarctica/DumontDUrville","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga"]}),a}),window.CloudStreamerSDK=function(e,t){console.log(t);var n=this;n.options=t||{},n.conn=null,n.cm=null,n.mCameraID=null,n.camera=null,n.sharedKey=null,n.mAccessToken=null,n.streamer=document.getElementById(e),n.m={},n.conn=new CloudShareConnection(n.options),n.config={},n.config.ws_port=8888,n.config.wss_port=8883,n.config.host="cam.skyvr.videoexpertsgroup.com",n.api_host=n.options.cloud_domain?n.options.cloud_domain:"web.skyvr.videoexpertsgroup.com",n.api_port=null;var o=n.api_security_port=null;n.streamer.classList.add("cloudstreamer"),n.streamer.classList.add("green"),n.streamer.classList.add("black"),n.streamer.innerHTML='<div class="cloudstreamer-loader" style="display: none"></div><div class="cloudstreamer-error" style="display: none">\t<div class="cloudstreamer-error-text" style="display: none"></div></div><div class="cloudstreamer-watermark"></div><div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div><div class="cloudstreamer-black-screen" style="display: none">\t\t<div class="cloudstreamer-watermark"></div>\t\t<div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div></div><div class="cloudplayer-controls">\t<div class="cloudplayer-stop" style="display: none"></div>\t<div class="cloudplayer-play" style="display: none"></div>\t<div class="cloudplayer-time"></div>\t<div class="cloudplayer-fullscreen"></div></div><video class="cloudstreamer-webcam-video" autoplay="true"></video>';var r=n.streamer.getElementsByClassName("cloudstreamer-loader")[0],a=n.streamer.getElementsByClassName("cloudstreamer-error")[0],i=n.streamer.getElementsByClassName("cloudstreamer-error-text")[0],s=n.streamer.getElementsByClassName("cloudstreamer-webcam-video")[0],l=n.streamer.getElementsByClassName("cloudplayer-stop")[0],c=n.streamer.getElementsByClassName("cloudplayer-play")[0],u=!1;function d(){u&&(r.style.display="none",u=!1)}n._setError=function(e){setTimeout(n.stop,10),n.mLastError=e,n.mCallback_onError&&n.mCallback_onError(n,e)},n.showErrorText=function(e){d(),a.style.display="inline-block",i.style.display="inline-block",i.innerHTML=e,l.style.display="none",c.style.display="none",s.srcObject=null},n.setSource=function(e){if(a.style.display="none",i.style.display="none",c.style.display="none",!e||""===e){var t="Access token is required";return console.error(t),n.showErrorText(t),CloudReturnCode.ERROR_INVALID_SOURCE}if("https:"==location.protocol){try{var o=atob(e);o=JSON.parse(o),console.log(o),o.token&&o.camid&&o.access&&""!==o.token&&""!==o.camid&&""!==o.access&&(n.sharedKey=o.token,n.mCameraID=o.camid),o.api&&(n.api_host=o.api,console.log("self.api_host: ",n.api_host)),o.api_p&&(n.api_port=o.api_p,console.log("self.api_port: ",n.api_port)),o.api_security_port&&(n.api_security_port=o.api_security_port,console.log("self.api_security_port: ",n.api_security_port))}catch(e){t="Invalid access token format";return console.error(t),CloudReturnCode.ERROR_INVALID_SOURCE}var r=n.api_host;n.api_host==(n.options.cloud_domain?n.options.cloud_domain:"web.skyvr.videoexpertsgroup.com")?r="https://"+n.api_host:"https:"===location.protocol?(r="https://"+n.api_host,null!=n.api_secutiry_port&&(r+=":"+n.api_secutiry_port)):"http:"!==location.protocol&&"file:"!==location.protocol||(r="http://"+n.api_host,null!=n.api_secutiry_port&&(r+=":"+n.api_secutiry_port)),n.conn.ServiceProviderUrl=r+"/",n.conn.open(n.sharedKey),n.mAccessToken=e,c.style.display=""}else n.showErrorText("Streamer is only available with HTTPS connection")},n.getSource=function(){return n.mAccessToken?n.mAccessToken:CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},n.start=function(){if(!n.sharedKey)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;console.warn("[CloudStreamerSDK] Start"),n.stop("by_strm_sdk_1"),navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){s.srcObject=e,n.conn&&n.conn._getAPI().cameraStreamUrls_webrtc(n.mCameraID).done(function(e){if(console.log("stream_urls: ",e),e.webrtc){var t=CloudHelpers.promise();0<CloudHelpers.compareVersions(CloudPlayerWebRTC2.version,e.webrtc.version)?(console.warn("Expected version webrtc.version (v"+e.webrtc.version+")  mismatch with included CloudPlayerWebRTC (v"+CloudPlayerWebRTC2.version+")"),t=CloudHelpers.requestJS(e.webrtc.scripts.player,function(e){for(e=e.replace("CloudPlayerWebRTC =","CloudPlayerWebRTC2 =");-1!==e.indexOf("CloudPlayerWebRTC.");)e=e.replace("CloudPlayerWebRTC.","CloudPlayerWebRTC2.");return e})):t.resolve(),t.done(function(){(o=new CloudPlayerWebRTC2(null,e.webrtc.connection_url,e.webrtc.ice_servers,{send_video:!0,send_audio:!0})).startWS(),l.style.display="",c.style.display="none"}).fail(function(e){console.error("err: ",e),n.showErrorText("Problem with streaming protocol")})}else n.showErrorText("Channel does not support WebRTC streamer")}).fail(function(e){console.error("err: ",e),n.showErrorText("Channel for streaming is not found")})}).catch(function(e){n.sharedKey=null,console.error(e),console.error("Something went wrong! ",e),-1!=(""+e).indexOf("Requested device is not found")&&n.showErrorText("Camera is not found")})},c.onclick=n.start,n.stop=function(){if(l.style.display="none",c.style.display=n.mAccessToken?"":"none",s.srcObject=null,!n.sharedKey)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;try{o&&o.stopWS()}catch(e){console.error(e)}},l.onclick=n.stop,n.initFullscreenControls=function(){var e,t,o=n.streamer.getElementsByClassName("cloudplayer-fullscreen")[0];n.changedFullscreen=function(){console.log("changedFullscreen"),document.webkitIsFullScreen?(e=n.player.style.height,t=n.player.style.width,n.streamer.style.height="100%",n.streamer.style.width="100%",console.log("changedFullscreen -> fullscreen")):(n.streamer.style.height=e,n.streamer.style.width=t,console.log("changedFullscreen -> NOT fullscreen"))},document.addEventListener&&(document.addEventListener("webkitfullscreenchange",n.changedFullscreen,!1),document.addEventListener("mozfullscreenchange",n.changedFullscreen,!1),document.addEventListener("fullscreenchange",n.changedFullscreen,!1),document.addEventListener("MSFullscreenChange",n.changedFullscreen,!1)),n.fullscreen=function(){console.log("fullscreen: clicked"),1==document.webkitIsFullScreen?document.webkitCancelFullScreen():document.mozFullScreen?document.mozCancelFullScreen():document.msFullscreenElement&&null!=document.msFullscreenElement?document.msExitFullscreen():n.streamer.mozRequestFullScreen?n.streamer.mozRequestFullScreen():n.streamer.requestFullscreen?n.streamer.requestFullscreen():n.streamer.webkitRequestFullscreen?n.streamer.webkitRequestFullscreen():n.streamer.msRequestFullscreen&&n.streamer.msRequestFullscreen()},o.onclick=n.fullscreen},n.initFullscreenControls()},window.CloudStreamerFlash=function(e,t){console.log(t);var n=this;n.options=t||{},n.conn=null,n.cm=null,n.mCameraID=null,n.camera=null,n.sharedKey=null,n.mAccessToken="",n.streamer=document.getElementById(e),n.m={},n.conn=new CloudShareConnection(n.options),n.config={},n.config.ws_port=8888,n.config.wss_port=8883,n.config.host="cam.skyvr.videoexpertsgroup.com",n.streamer.classList.add("cloudstreamer"),n.streamer.classList.add("green"),n.streamer.classList.add("black"),StreamerSWF.log=function(e){console.log("[CloudStreamerFlash]",e)},StreamerSWF.error=function(e){console.error("[CloudStreamerFlash]",e)},StreamerSWF.warn=function(e){console.warn("[CloudStreamerFlash]",e)},StreamerSWF.startedPublish=function(){console.log("[CloudStreamerFlash] publishing started")},StreamerSWF.stoppedPublish=function(){console.log("[CloudStreamerFlash] publishing stopped")},StreamerSWF.activityLevel=function(e){},n.streamer.innerHTML='<div class="cloudstreamer-loader" style="display: none"></div><div class="cloudstreamer-error" style="display: none">\t<div class="cloudstreamer-error-text" style="display: none"></div></div><div class="cloudstreamer-watermark"></div><div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div><div class="cloudstreamer-black-screen" style="display: none">\t\t<div class="cloudstreamer-watermark"></div>\t\t<div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div></div><object class="streamer-swf" id="streamer_swf" type="application/x-shockwave-flash" data="'+CloudSDK.streamer_swf+'" width="100%" height="100%" ><param name="movie" value="'+CloudSDK.streamer_swf+'" /><embed src="'+CloudSDK.streamer_swf+'"><param name="allowScriptAccess" value="always"/><param value="allowNetworking" value="all"/><param name="wmode" value="transparent"/><param name="menu" value="false" /></object>';var o=n.streamer.getElementsByClassName("cloudstreamer-loader")[0],a=n.streamer.getElementsByClassName("cloudstreamer-error")[0],i=n.streamer.getElementsByClassName("cloudstreamer-error-text")[0];n.streamer.getElementsByClassName("streamer-swf")[0];console.log(StreamerSWF.flash()),n.onStarted=function(e){console.log("[CloudStreamerFlash] activate streaming to rtmp_url: ",e),StreamerSWF.activate(e,"PCMU")};var r=!(n.onStopped=function(){console.log("[CloudStreamerFlash] deactivate"),StreamerSWF.deactivate()});function s(){r&&(o.style.display="none",r=!1)}n._setError=function(e){setTimeout(n.stop,10),n.mLastError=e,n.mCallback_onError&&n.mCallback_onError(n,e)},n.showErrorText=function(e){s(),a.style.display="inline-block",i.style.display="inline-block",i.innerHTML=e},n.setSource=function(e){if(a.style.display="none",i.style.display="none",!e||""===e){var t="Access token required";return console.error(t),n.showErrorText(t),CloudReturnCode.ERROR_INVALID_SOURCE}if(CloudHelpers.isMobile())n.showErrorText("Mobile streamer is not available yet");else if(CloudHelpers.isChrome())n.showErrorText("Streamer is not available yet for Chrome. But you can open this page in Edge or Firefox to start streaming from your web camera.");else if(CloudHelpers.supportFlash()||!CloudHelpers.isFireFox()){if("https:"!=window.location.protocol){try{var o=atob(e);o=JSON.parse(o),console.log(o),o.token&&o.camid&&o.access&&""!==o.token&&""!==o.camid&&""!==o.access&&(n.sharedKey=o.token,n.mCameraID=o.camid),o.svcp&&""!=o.svcp&&(n.svcp_url=o.svcp,console.log("self.svcp_url: ",n.svcp_url))}catch(e){t="Invalid access token format";return console.error(t),CloudReturnCode.ERROR_INVALID_SOURCE}if(n.mAccessToken=e,null!=n.svcp_url){n.conn.ServiceProviderUrl=n.svcp_url;var r=CloudHelpers.parseUri(n.svcp_url);n.config.host=r.host}return n.conn.open(n.sharedKey),n.conn?(n.cm=new CloudCameraList(n.conn),n.cm.getCamera(n.mCameraID).done(function(e){n.mCamera=e,console.log("camera: ",n.mCamera._origJson()),n.start()}).fail(function(e){n.showErrorText("Channel for streaming not found")}),CloudReturnCode.OK):CloudReturnCode.ERROR_NO_CLOUD_CONNECTION}n.showErrorText("Streamer are not available yet with https")}else n.showErrorText("In Firefox Streamer available using by flash now.<br>Please install flash <a href='https://get.adobe.com/flashplayer' target='_blank'>https://get.adobe.com/flashplayer</a><br> or maybe enable Plugin 'Shockwave Flash' in your browser <a href='about:addons' target='_blank'>about:addons</a>.")},n.getSource=function(){return n.sharedKey?n.mAccessToken:CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED};var l=null;function c(){clearInterval(l)}n.start=function(){if(!n.mCamera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;if(!StreamerSWF.flash().vjs_activate)return c(),void(l=setInterval(function(){StreamerSWF.flash().vjs_activate&&(n.start(),c())},1e3));console.warn("[CloudStreamerFlash] Start"),n.stop("by_strm_sdk_1");var e=n.mCamera.getCameraManagerID();n.mCamera._getConn()._getAPI().resetCameraManager(e,{}).done(function(e){console.log(e),n.config.token=e.token,n.config.camid=n.mCamera.getID(),n.initWebSocket()}).fail(function(e){console.error(e)})},n.stop=function(){if(c(),!n.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;if(console.warn("Stop"),n.ws&&n.ws.socket)try{n.ws.socket.close()}catch(e){console.error(e)}try{StreamerSWF.deactivate()}catch(e){console.error(e)}},n.initWebSocket=function(){var e=n.config.srv||n.config.host;if(n.ws={},console.log("self.config.host: "+n.config.host),console.log("self.config.srv: "+n.config.srv),"http:"!=window.location.protocol&&"file:"!=window.location.protocol)return"https:"==window.location.protocol?void console.error("Not supported https yet"):void console.error("Expected protocol http or https");e="ws://"+e+":"+n.config.ws_port,e+="/ctl/NEW/"+n.config.token+"/",n.ws.socket=new WebSocket(e),n.ws.socket.onopen=function(){console.log("WS Opened"),n._register()},n.ws.socket.onclose=function(e){console.log("Closed")},n.ws.socket.onmessage=function(e){console.log("Received: "+e.data);try{var t=JSON.parse(e.data),o=t.cmd;n.handlers[o]?n.handlers[o](t):console.warn("Not found handler "+o)}catch(e){console.error(e)}},n.ws.socket.onerror=function(e){console.error("Error: "+e.message)}},n.m_nMessageID=0,n.makeCommand=function(e){return n.m_nMessageID++,{cmd:e,msgid:n.m_nMessageID}},n.makeCommandDone=function(e,t,o){var r=n.makeCommand("done");return r.orig_cmd=e,r.refid=t,r.status=o,r},n._register=function(){var e=n.makeCommand("register");e.pwd="",e.reg_token=n.config.token,e.ver="0.1",e.tz="UTC",e.vendor="web",n.sendMessage(e)},n.sendMessage=function(e){n.ws.socket.send(JSON.stringify(e))},n.handlers={},n.handlers.configure=function(e){e.server&&(n.config.srv=e.server),e.uuid&&(n.config.uuid=e.uuid)},n.handlers.bye=function(e){e.reason&&"RECONNECT"==e.reason&&setTimeout(function(){n.initWebSocket()},1200)},n.handlers.hello=function(e){e.media_server&&(n.config.media_server=e.media_server),e.sid&&(n.config.sid=e.sid),e.upload_url&&(n.config.upload_url=e.upload_url),n.sendMessage(n.makeCommandDone("hello",e.msgid,"OK"));var t=n.makeCommand("cam_register");t.ip="127.0.0.1",t.uuid=n.config.uuid,t.brand="None",t.model="Unknown",t.sn="nope",t.type="cm",t.version="0",t.initial_mode="cloud",n.sendMessage(t)},n.handlers.cam_hello=function(e){n.sendMessage(n.makeCommandDone("cam_hello",e.msgid,"OK")),n.config.camid=e.cam_id,e.media_url&&(n.config.media_url=e.media_url),e.media_uri&&(n.config.media_server=e.media_uri),e.path&&(n.config.media_url=e.path)},n.handlers.get_cam_status=function(e){var t=n.makeCommand("cam_status");t.cam_id=n.config.camid,t.ip="127.0.0.1",t.activity=!0,t.streaming=!0,t.status_led=!1,n.sendMessage(t)},n.handlers.get_supported_streams=function(e){var t=n.makeCommand("supported_streams");t.cam_id=n.config.camid,t.audio_es=["Aud"],t.video_es=["Vid"],t.streams=[{id:"Main",video:"Vid",audio:"Aud"}],n.sendMessage(t)},n.stream_start_counter=0,n.handlers.stream_start=function(e){var t="rtmp://"+n.config.media_server+"/"+n.config.media_url+"Main";t+="?sid="+n.config.sid,console.log(t),0==n.stream_start_counter&&(n.stream_start_counter++,n.options.onStarted?n.options.onStarted(t):n.options.onStarted||n.onStarted(t)),n.sendMessage(n.makeCommandDone("stream_start",e.msgid,"OK"))},n.handlers.stream_stop=function(e){n.stream_start_counter--,n.sendMessage(n.makeCommandDone("stream_start",e.msgid,"OK")),0==n.stream_start_counter&&(n.options.onStopped?n.options.onStarted(stream_url):n.options.onStarted||n.onStopped())}};